(sansa) âžœ  recsys-paper (dev) python experiments/shorter_training/msd/run_experiment.py 
d=0.0005, ns=0, nf=0


2023-05-07 19:28:15,778 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:28:15,779 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:28:17,895 : [1/3] DATASET : Execution of _load_dataset_from_config took at 2.117 seconds.
2023-05-07 19:28:18,272 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:28:27,224 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:28:27,233 : [1/3] DATASET : Execution of _create_dataset_splits took at 11.455 seconds.
2023-05-07 19:28:27,238 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:28:27,238 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:28:27,238 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:28:27,238 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:28:29,261 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:28:29,261 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:30:16,612 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:30:16,612 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:30:24,895 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:30:24,895 : [2/3] TRAINING : Execution of ldlt took at 115.634 seconds.
2023-05-07 19:30:24,895 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:30:24,895 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:30:24,895 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:30:24,910 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:30:25,003 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:30:25,017 : [2/3] TRAINING : Execution of ainv_L took at 0.122 seconds.
2023-05-07 19:30:25,017 : [2/3] TRAINING : nnz of L_inv: 846250, size: 10.320 MB
2023-05-07 19:30:25,017 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:30:25,032 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:30:25,039 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:30:25,449 : [2/3] TRAINING : Execution of _construct_weights took at 116.187 seconds.
2023-05-07 19:30:25,450 : [2/3] TRAINING : Model: SANSA, number of weights: 1692500, weights size: 19.683 MB
2023-05-07 19:30:25,450 : [2/3] TRAINING : Execution of _get_model took at 118.217 seconds.
2023-05-07 19:30:25,450 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:30:25,524 : [3/3] EVALUATION : Execution of _matmat took at 0.006 seconds.
2023-05-07 19:30:25,673 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:30:26,192 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:30:27,021 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:30:27,079 : [3/3] EVALUATION : Execution of _matmat took at 0.005 seconds.
2023-05-07 19:30:27,225 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:30:27,727 : [3/3] EVALUATION : Execution of _predict took at 0.652 seconds.
2023-05-07 19:30:28,533 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:30:28,591 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:30:28,738 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:30:29,280 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:30:30,096 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:30:30,154 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:30:30,300 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:30:30,833 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 19:30:31,650 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:30:31,707 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:31,853 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:30:32,383 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 19:30:33,193 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:30:33,249 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:33,396 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:30:33,923 : [3/3] EVALUATION : Execution of _predict took at 0.676 seconds.
2023-05-07 19:30:34,744 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:30:34,800 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:34,946 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:30:35,464 : [3/3] EVALUATION : Execution of _predict took at 0.667 seconds.
2023-05-07 19:30:36,276 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:30:36,332 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:36,476 : [3/3] EVALUATION : Execution of _matmat took at 0.144 seconds.
2023-05-07 19:30:36,983 : [3/3] EVALUATION : Execution of _predict took at 0.655 seconds.
2023-05-07 19:30:37,787 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:30:37,844 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:37,992 : [3/3] EVALUATION : Execution of _matmat took at 0.148 seconds.
2023-05-07 19:30:38,522 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:30:39,336 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:30:39,391 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:39,536 : [3/3] EVALUATION : Execution of _matmat took at 0.145 seconds.
2023-05-07 19:30:40,038 : [3/3] EVALUATION : Execution of _predict took at 0.650 seconds.
2023-05-07 19:30:40,844 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:30:40,901 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:41,046 : [3/3] EVALUATION : Execution of _matmat took at 0.145 seconds.
2023-05-07 19:30:41,554 : [3/3] EVALUATION : Execution of _predict took at 0.656 seconds.
2023-05-07 19:30:42,356 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:30:42,412 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:42,560 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:30:43,112 : [3/3] EVALUATION : Execution of _predict took at 0.702 seconds.
2023-05-07 19:30:43,926 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:30:43,983 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:44,129 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:30:44,667 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 19:30:45,485 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:30:45,540 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:45,686 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:30:46,202 : [3/3] EVALUATION : Execution of _predict took at 0.665 seconds.
2023-05-07 19:30:47,017 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:30:47,073 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:47,220 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:30:47,728 : [3/3] EVALUATION : Execution of _predict took at 0.657 seconds.
2023-05-07 19:30:48,539 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:30:48,594 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:48,741 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:30:49,265 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:30:50,078 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:30:50,174 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:30:50,323 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:30:50,870 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:30:51,694 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:30:51,750 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:51,898 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:30:52,432 : [3/3] EVALUATION : Execution of _predict took at 0.685 seconds.
2023-05-07 19:30:53,243 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:30:53,300 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:53,445 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:30:53,963 : [3/3] EVALUATION : Execution of _predict took at 0.666 seconds.
2023-05-07 19:30:54,777 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:30:54,832 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:54,977 : [3/3] EVALUATION : Execution of _matmat took at 0.145 seconds.
2023-05-07 19:30:55,489 : [3/3] EVALUATION : Execution of _predict took at 0.660 seconds.
2023-05-07 19:30:56,300 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:30:56,357 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:56,504 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:30:57,041 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 19:30:57,859 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:30:57,916 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:30:58,064 : [3/3] EVALUATION : Execution of _matmat took at 0.148 seconds.
2023-05-07 19:30:58,587 : [3/3] EVALUATION : Execution of _predict took at 0.675 seconds.
2023-05-07 19:30:59,407 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:30:59,464 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:30:59,612 : [3/3] EVALUATION : Execution of _matmat took at 0.148 seconds.
2023-05-07 19:31:00,125 : [3/3] EVALUATION : Execution of _predict took at 0.664 seconds.
2023-05-07 19:31:00,942 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:31:00,998 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:31:01,145 : [3/3] EVALUATION : Execution of _matmat took at 0.146 seconds.
2023-05-07 19:31:01,657 : [3/3] EVALUATION : Execution of _predict took at 0.662 seconds.
2023-05-07 19:31:02,473 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:31:02,531 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:31:02,678 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:31:03,219 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:31:04,238 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.788 seconds.
2023-05-07 19:31:04,240 : PIPELINE END : Execution of run took at 168.463 seconds.
d=0.0005, ns=0, nf=5


2023-05-07 19:31:04,273 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:31:04,273 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:31:05,453 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.180 seconds.
2023-05-07 19:31:05,808 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:31:06,311 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:31:06,325 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.053 seconds.
2023-05-07 19:31:06,327 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:31:06,327 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:31:06,327 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:31:06,327 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:31:08,342 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:31:08,342 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:32:55,414 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:32:55,414 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:33:03,690 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:33:03,690 : [2/3] TRAINING : Execution of ldlt took at 115.348 seconds.
2023-05-07 19:33:03,690 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:33:03,690 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:33:03,690 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:33:03,701 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:33:03,774 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:33:03,775 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:33:03,799 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.024 seconds.
2023-05-07 19:33:03,868 : [2/3] TRAINING : Current maximum residual: 3.65272191, relative Frobenius norm squared: 0.08665586
2023-05-07 19:33:03,868 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:33:03,888 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 19:33:03,954 : [2/3] TRAINING : Current maximum residual: 2.96663246, relative Frobenius norm squared: 0.08114821
2023-05-07 19:33:03,954 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:33:03,973 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:33:04,035 : [2/3] TRAINING : Current maximum residual: 2.63367246, relative Frobenius norm squared: 0.07722411
2023-05-07 19:33:04,036 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:33:04,055 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:33:04,118 : [2/3] TRAINING : Current maximum residual: 2.39314804, relative Frobenius norm squared: 0.07408552
2023-05-07 19:33:04,118 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:33:04,135 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:33:04,218 : [2/3] TRAINING : Current maximum residual: 2.27260269, relative Frobenius norm squared: 0.07141662
2023-05-07 19:33:04,231 : [2/3] TRAINING : Execution of ainv_L took at 0.541 seconds.
2023-05-07 19:33:04,232 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:33:04,232 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:33:04,239 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:33:04,244 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:33:04,657 : [2/3] TRAINING : Execution of _construct_weights took at 116.315 seconds.
2023-05-07 19:33:04,658 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:33:04,658 : [2/3] TRAINING : Execution of _get_model took at 118.333 seconds.
2023-05-07 19:33:04,658 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:33:04,724 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:33:04,877 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:33:05,399 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:33:06,218 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:33:06,276 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:06,429 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:33:06,934 : [3/3] EVALUATION : Execution of _predict took at 0.661 seconds.
2023-05-07 19:33:07,738 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:33:07,797 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:07,950 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:33:08,495 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 19:33:09,305 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:33:09,362 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:09,514 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:33:10,051 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:33:10,861 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:33:10,919 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:11,070 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:11,602 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 19:33:12,410 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:33:12,467 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:12,619 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:33:13,148 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 19:33:13,960 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:33:14,017 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:14,168 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:14,689 : [3/3] EVALUATION : Execution of _predict took at 0.675 seconds.
2023-05-07 19:33:15,493 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:33:15,549 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:15,699 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:33:16,209 : [3/3] EVALUATION : Execution of _predict took at 0.662 seconds.
2023-05-07 19:33:17,010 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:33:17,068 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:17,222 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:33:17,754 : [3/3] EVALUATION : Execution of _predict took at 0.689 seconds.
2023-05-07 19:33:18,566 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:33:18,622 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:18,774 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:33:19,279 : [3/3] EVALUATION : Execution of _predict took at 0.659 seconds.
2023-05-07 19:33:20,082 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:33:20,139 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:20,289 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:33:20,800 : [3/3] EVALUATION : Execution of _predict took at 0.664 seconds.
2023-05-07 19:33:21,602 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:33:21,659 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:21,810 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:22,364 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 19:33:23,173 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:33:23,230 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:23,381 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:23,921 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:33:24,734 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:33:24,792 : [3/3] EVALUATION : Execution of _matmat took at 0.005 seconds.
2023-05-07 19:33:24,943 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:25,462 : [3/3] EVALUATION : Execution of _predict took at 0.675 seconds.
2023-05-07 19:33:26,271 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:33:26,328 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:26,481 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:33:26,990 : [3/3] EVALUATION : Execution of _predict took at 0.665 seconds.
2023-05-07 19:33:27,798 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:33:27,854 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:28,006 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:33:28,533 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:33:29,344 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:33:29,438 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:29,592 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:33:30,140 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 19:33:30,960 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:33:31,016 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:31,168 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:31,706 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:33:32,511 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:33:32,569 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:32,720 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:33,241 : [3/3] EVALUATION : Execution of _predict took at 0.675 seconds.
2023-05-07 19:33:34,048 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:33:34,104 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:34,254 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:33:34,768 : [3/3] EVALUATION : Execution of _predict took at 0.667 seconds.
2023-05-07 19:33:35,570 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:33:35,628 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:35,781 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:33:36,320 : [3/3] EVALUATION : Execution of _predict took at 0.695 seconds.
2023-05-07 19:33:37,135 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:33:37,191 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:33:37,344 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:33:37,870 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:33:38,681 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:33:38,738 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:38,891 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:33:39,408 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:33:40,214 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:33:40,270 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:40,421 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:33:40,936 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 19:33:41,744 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:33:41,801 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:33:41,955 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:33:42,498 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:33:43,527 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.869 seconds.
2023-05-07 19:33:43,528 : PIPELINE END : Execution of run took at 159.255 seconds.
d=0.0005, ns=0, nf=10


2023-05-07 19:33:43,561 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:33:43,561 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:33:44,737 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.176 seconds.
2023-05-07 19:33:45,067 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:33:45,525 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:33:45,537 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.976 seconds.
2023-05-07 19:33:45,538 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:33:45,538 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:33:45,538 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:33:45,538 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:33:47,566 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:33:47,566 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:35:34,903 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:35:34,903 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:35:43,173 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:35:43,174 : [2/3] TRAINING : Execution of ldlt took at 115.608 seconds.
2023-05-07 19:35:43,174 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:35:43,174 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:35:43,174 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:35:43,179 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:35:43,248 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:35:43,248 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:35:43,268 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 19:35:43,336 : [2/3] TRAINING : Current maximum residual: 3.65272191, relative Frobenius norm squared: 0.08665586
2023-05-07 19:35:43,336 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:35:43,356 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 19:35:43,415 : [2/3] TRAINING : Current maximum residual: 2.96663246, relative Frobenius norm squared: 0.08114821
2023-05-07 19:35:43,415 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:35:43,432 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:35:43,494 : [2/3] TRAINING : Current maximum residual: 2.63367246, relative Frobenius norm squared: 0.07722411
2023-05-07 19:35:43,494 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:35:43,513 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:35:43,579 : [2/3] TRAINING : Current maximum residual: 2.39314804, relative Frobenius norm squared: 0.07408552
2023-05-07 19:35:43,579 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:35:43,595 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:35:43,653 : [2/3] TRAINING : Current maximum residual: 2.27260269, relative Frobenius norm squared: 0.07141662
2023-05-07 19:35:43,653 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 19:35:43,672 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:35:43,731 : [2/3] TRAINING : Current maximum residual: 2.17230515, relative Frobenius norm squared: 0.06899065
2023-05-07 19:35:43,731 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 19:35:43,749 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:35:43,809 : [2/3] TRAINING : Current maximum residual: 2.06987691, relative Frobenius norm squared: 0.06680064
2023-05-07 19:35:43,810 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 19:35:43,827 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:35:43,888 : [2/3] TRAINING : Current maximum residual: 1.95350463, relative Frobenius norm squared: 0.06480665
2023-05-07 19:35:43,888 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 19:35:43,907 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:35:43,976 : [2/3] TRAINING : Current maximum residual: 1.89319435, relative Frobenius norm squared: 0.06301239
2023-05-07 19:35:43,976 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 19:35:43,993 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:35:44,077 : [2/3] TRAINING : Current maximum residual: 1.84204923, relative Frobenius norm squared: 0.06132599
2023-05-07 19:35:44,090 : [2/3] TRAINING : Execution of ainv_L took at 0.917 seconds.
2023-05-07 19:35:44,091 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:35:44,091 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:35:44,098 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:35:44,103 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:35:44,515 : [2/3] TRAINING : Execution of _construct_weights took at 116.950 seconds.
2023-05-07 19:35:44,516 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:35:44,516 : [2/3] TRAINING : Execution of _get_model took at 118.979 seconds.
2023-05-07 19:35:44,516 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:35:44,580 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:35:44,734 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:35:45,257 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 19:35:46,069 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:35:46,126 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:46,276 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:35:46,781 : [3/3] EVALUATION : Execution of _predict took at 0.658 seconds.
2023-05-07 19:35:47,579 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:35:47,638 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:35:47,789 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:35:48,334 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:35:49,140 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:35:49,197 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:49,348 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:35:49,884 : [3/3] EVALUATION : Execution of _predict took at 0.690 seconds.
2023-05-07 19:35:50,688 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:35:50,746 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:50,896 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:35:51,429 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 19:35:52,233 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:35:52,291 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:52,442 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:35:52,971 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:35:53,777 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:35:53,835 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:53,986 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:35:54,506 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:35:55,306 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:35:55,363 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:55,512 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:35:56,023 : [3/3] EVALUATION : Execution of _predict took at 0.663 seconds.
2023-05-07 19:35:56,817 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:35:56,875 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:57,028 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:35:57,561 : [3/3] EVALUATION : Execution of _predict took at 0.689 seconds.
2023-05-07 19:35:58,363 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:35:58,419 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:35:58,569 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:35:59,073 : [3/3] EVALUATION : Execution of _predict took at 0.657 seconds.
2023-05-07 19:35:59,870 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:35:59,927 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:00,077 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:36:00,588 : [3/3] EVALUATION : Execution of _predict took at 0.663 seconds.
2023-05-07 19:36:01,383 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:36:01,440 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:01,591 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:36:02,146 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 19:36:02,950 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:36:03,007 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:03,159 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:36:03,699 : [3/3] EVALUATION : Execution of _predict took at 0.695 seconds.
2023-05-07 19:36:04,509 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:36:04,565 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:04,716 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:36:05,235 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:36:06,042 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:36:06,099 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:06,250 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:36:06,761 : [3/3] EVALUATION : Execution of _predict took at 0.665 seconds.
2023-05-07 19:36:07,562 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:36:07,618 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:07,769 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:36:08,296 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 19:36:09,101 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:36:09,197 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:09,352 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:36:09,900 : [3/3] EVALUATION : Execution of _predict took at 0.706 seconds.
2023-05-07 19:36:10,711 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:36:10,767 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:10,919 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:36:11,458 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:36:12,263 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:36:12,320 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:12,470 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:36:12,991 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:36:13,797 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:36:13,855 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:14,006 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:36:14,520 : [3/3] EVALUATION : Execution of _predict took at 0.668 seconds.
2023-05-07 19:36:15,321 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:36:15,378 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:15,530 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:36:16,069 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:36:16,878 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:36:16,934 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:17,087 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:36:17,612 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:36:18,418 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:36:18,475 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:18,626 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:36:19,143 : [3/3] EVALUATION : Execution of _predict took at 0.671 seconds.
2023-05-07 19:36:19,948 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:36:20,004 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:20,155 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:36:20,670 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 19:36:21,476 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:36:21,532 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:36:21,685 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:36:22,230 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 19:36:23,257 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.741 seconds.
2023-05-07 19:36:23,258 : PIPELINE END : Execution of run took at 159.697 seconds.
d=0.0005, ns=0, nf=20


2023-05-07 19:36:23,292 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:36:23,293 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:36:24,473 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.181 seconds.
2023-05-07 19:36:24,800 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:36:25,250 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:36:25,263 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.970 seconds.
2023-05-07 19:36:25,264 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:36:25,264 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:36:25,264 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:36:25,264 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:36:27,288 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:36:27,288 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:38:14,567 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:38:14,567 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:38:22,856 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:38:22,856 : [2/3] TRAINING : Execution of ldlt took at 115.567 seconds.
2023-05-07 19:38:22,856 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:38:22,856 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:38:22,856 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:38:22,866 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:38:22,938 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:38:22,938 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:38:22,959 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 19:38:23,025 : [2/3] TRAINING : Current maximum residual: 3.65272191, relative Frobenius norm squared: 0.08665586
2023-05-07 19:38:23,026 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:38:23,046 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 19:38:23,103 : [2/3] TRAINING : Current maximum residual: 2.96663246, relative Frobenius norm squared: 0.08114821
2023-05-07 19:38:23,103 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:38:23,121 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:38:23,177 : [2/3] TRAINING : Current maximum residual: 2.63367246, relative Frobenius norm squared: 0.07722411
2023-05-07 19:38:23,177 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:38:23,196 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:38:23,251 : [2/3] TRAINING : Current maximum residual: 2.39314804, relative Frobenius norm squared: 0.07408552
2023-05-07 19:38:23,251 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:38:23,267 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:38:23,327 : [2/3] TRAINING : Current maximum residual: 2.27260269, relative Frobenius norm squared: 0.07141662
2023-05-07 19:38:23,328 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 19:38:23,346 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:38:23,411 : [2/3] TRAINING : Current maximum residual: 2.17230515, relative Frobenius norm squared: 0.06899065
2023-05-07 19:38:23,411 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 19:38:23,429 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:38:23,485 : [2/3] TRAINING : Current maximum residual: 2.06987691, relative Frobenius norm squared: 0.06680064
2023-05-07 19:38:23,485 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 19:38:23,502 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:38:23,557 : [2/3] TRAINING : Current maximum residual: 1.95350463, relative Frobenius norm squared: 0.06480665
2023-05-07 19:38:23,558 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 19:38:23,576 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:38:23,632 : [2/3] TRAINING : Current maximum residual: 1.89319435, relative Frobenius norm squared: 0.06301239
2023-05-07 19:38:23,632 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 19:38:23,649 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:38:23,704 : [2/3] TRAINING : Current maximum residual: 1.84204923, relative Frobenius norm squared: 0.06132599
2023-05-07 19:38:23,704 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 19:38:23,722 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:38:23,778 : [2/3] TRAINING : Current maximum residual: 1.75903135, relative Frobenius norm squared: 0.05975509
2023-05-07 19:38:23,778 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 19:38:23,797 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:38:23,853 : [2/3] TRAINING : Current maximum residual: 1.70709186, relative Frobenius norm squared: 0.05829001
2023-05-07 19:38:23,853 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 19:38:23,871 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:38:23,930 : [2/3] TRAINING : Current maximum residual: 1.65862830, relative Frobenius norm squared: 0.05694186
2023-05-07 19:38:23,930 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 19:38:23,947 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:38:24,010 : [2/3] TRAINING : Current maximum residual: 1.62818372, relative Frobenius norm squared: 0.05563480
2023-05-07 19:38:24,010 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 19:38:24,026 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:38:24,091 : [2/3] TRAINING : Current maximum residual: 1.60227960, relative Frobenius norm squared: 0.05439056
2023-05-07 19:38:24,091 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 19:38:24,108 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:38:24,171 : [2/3] TRAINING : Current maximum residual: 1.55521702, relative Frobenius norm squared: 0.05319235
2023-05-07 19:38:24,171 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 19:38:24,188 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:38:24,252 : [2/3] TRAINING : Current maximum residual: 1.53520142, relative Frobenius norm squared: 0.05204768
2023-05-07 19:38:24,252 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 19:38:24,266 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.013 seconds.
2023-05-07 19:38:24,331 : [2/3] TRAINING : Current maximum residual: 1.51036504, relative Frobenius norm squared: 0.05093500
2023-05-07 19:38:24,331 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 19:38:24,347 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:38:24,406 : [2/3] TRAINING : Current maximum residual: 1.47621502, relative Frobenius norm squared: 0.04990055
2023-05-07 19:38:24,407 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 19:38:24,421 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:38:24,477 : [2/3] TRAINING : Current maximum residual: 1.43858637, relative Frobenius norm squared: 0.04887682
2023-05-07 19:38:24,489 : [2/3] TRAINING : Execution of ainv_L took at 1.633 seconds.
2023-05-07 19:38:24,489 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:38:24,489 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:38:24,499 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:38:24,504 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:38:24,918 : [2/3] TRAINING : Execution of _construct_weights took at 117.629 seconds.
2023-05-07 19:38:24,919 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:38:24,919 : [2/3] TRAINING : Execution of _get_model took at 119.656 seconds.
2023-05-07 19:38:24,919 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:38:24,984 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:38:25,139 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:38:25,662 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 19:38:26,470 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:38:26,527 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:26,675 : [3/3] EVALUATION : Execution of _matmat took at 0.148 seconds.
2023-05-07 19:38:27,181 : [3/3] EVALUATION : Execution of _predict took at 0.657 seconds.
2023-05-07 19:38:27,970 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:38:28,028 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:28,178 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:38:28,724 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:38:29,519 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:38:29,576 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:29,726 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:38:30,264 : [3/3] EVALUATION : Execution of _predict took at 0.691 seconds.
2023-05-07 19:38:31,062 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:38:31,120 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:31,271 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:38:31,804 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 19:38:32,595 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:38:32,653 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:32,803 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:38:33,332 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:38:34,131 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:38:34,189 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:34,338 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:38:34,859 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:38:35,652 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:38:35,709 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:35,857 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:38:36,369 : [3/3] EVALUATION : Execution of _predict took at 0.663 seconds.
2023-05-07 19:38:37,158 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:38:37,216 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:37,368 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:38:37,896 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:38:38,693 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:38:38,750 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:38,900 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:38:39,407 : [3/3] EVALUATION : Execution of _predict took at 0.660 seconds.
2023-05-07 19:38:40,196 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:38:40,254 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:40,403 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:38:40,915 : [3/3] EVALUATION : Execution of _predict took at 0.664 seconds.
2023-05-07 19:38:41,700 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:38:41,757 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:41,906 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:38:42,463 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 19:38:43,258 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:38:43,315 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:43,465 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:38:44,007 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:38:44,805 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:38:44,862 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:45,011 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:38:45,531 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 19:38:46,328 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:38:46,386 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:46,535 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:38:47,047 : [3/3] EVALUATION : Execution of _predict took at 0.664 seconds.
2023-05-07 19:38:47,841 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:38:47,897 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:48,048 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:38:48,576 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:38:49,373 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:38:49,470 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:49,623 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:38:50,172 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 19:38:50,977 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:38:51,034 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:51,185 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:38:51,724 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:38:52,519 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:38:52,576 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:52,726 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:38:53,248 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:38:54,043 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:38:54,100 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:54,249 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:38:54,764 : [3/3] EVALUATION : Execution of _predict took at 0.667 seconds.
2023-05-07 19:38:55,553 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:38:55,611 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:55,762 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:38:56,302 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:38:57,100 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:38:57,156 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:57,307 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:38:57,834 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 19:38:58,631 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:38:58,689 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:38:58,842 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:38:59,360 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:39:00,162 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:39:00,219 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:39:00,371 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:39:00,886 : [3/3] EVALUATION : Execution of _predict took at 0.670 seconds.
2023-05-07 19:39:01,681 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:39:01,738 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:39:01,889 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:39:02,435 : [3/3] EVALUATION : Execution of _predict took at 0.699 seconds.
2023-05-07 19:39:03,448 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.530 seconds.
2023-05-07 19:39:03,449 : PIPELINE END : Execution of run took at 160.157 seconds.
d=0.0005, ns=1, nf=0


2023-05-07 19:39:03,484 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:39:03,484 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:39:04,661 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.177 seconds.
2023-05-07 19:39:04,988 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:39:05,439 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:39:05,451 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.967 seconds.
2023-05-07 19:39:05,452 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:39:05,452 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:39:05,452 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:39:05,452 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:39:07,481 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:39:07,482 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:40:54,430 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:40:54,430 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:41:02,699 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:41:02,699 : [2/3] TRAINING : Execution of ldlt took at 115.217 seconds.
2023-05-07 19:41:02,699 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:41:02,699 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:41:02,699 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:41:02,709 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:41:02,781 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:41:02,781 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 19:41:03,960 : [2/3] TRAINING : Execution of _umr_scan took at 1.178 seconds.
2023-05-07 19:41:04,035 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 19:41:04,051 : [2/3] TRAINING : Execution of ainv_L took at 1.352 seconds.
2023-05-07 19:41:04,051 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:41:04,051 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:41:04,058 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:41:04,063 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:41:04,478 : [2/3] TRAINING : Execution of _construct_weights took at 116.996 seconds.
2023-05-07 19:41:04,479 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:41:04,479 : [2/3] TRAINING : Execution of _get_model took at 119.027 seconds.
2023-05-07 19:41:04,479 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:41:04,544 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:41:04,696 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:41:05,217 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 19:41:06,036 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:41:06,093 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:06,243 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:41:06,748 : [3/3] EVALUATION : Execution of _predict took at 0.657 seconds.
2023-05-07 19:41:07,548 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:41:07,606 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:07,755 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:08,301 : [3/3] EVALUATION : Execution of _predict took at 0.698 seconds.
2023-05-07 19:41:09,108 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:41:09,165 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:09,314 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:09,851 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 19:41:10,661 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:41:10,719 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:10,868 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:11,401 : [3/3] EVALUATION : Execution of _predict took at 0.685 seconds.
2023-05-07 19:41:12,204 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:41:12,262 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:12,412 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:41:12,940 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:41:13,751 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:41:13,809 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:13,958 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:14,478 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 19:41:15,284 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:41:15,340 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:15,488 : [3/3] EVALUATION : Execution of _matmat took at 0.147 seconds.
2023-05-07 19:41:15,998 : [3/3] EVALUATION : Execution of _predict took at 0.661 seconds.
2023-05-07 19:41:16,798 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:41:16,856 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:17,008 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:41:17,541 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 19:41:18,348 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:41:18,404 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:18,553 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:19,057 : [3/3] EVALUATION : Execution of _predict took at 0.656 seconds.
2023-05-07 19:41:19,862 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:41:19,920 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:20,068 : [3/3] EVALUATION : Execution of _matmat took at 0.148 seconds.
2023-05-07 19:41:20,573 : [3/3] EVALUATION : Execution of _predict took at 0.656 seconds.
2023-05-07 19:41:21,370 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:41:21,427 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:21,577 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:41:22,131 : [3/3] EVALUATION : Execution of _predict took at 0.707 seconds.
2023-05-07 19:41:22,936 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:41:22,994 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:23,145 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:41:23,685 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:41:24,498 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:41:24,554 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:24,704 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:25,222 : [3/3] EVALUATION : Execution of _predict took at 0.671 seconds.
2023-05-07 19:41:26,031 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:41:26,089 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:26,238 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:41:26,748 : [3/3] EVALUATION : Execution of _predict took at 0.663 seconds.
2023-05-07 19:41:27,550 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:41:27,606 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:27,758 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:41:28,285 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:41:29,094 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:41:29,192 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:41:29,344 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:41:29,891 : [3/3] EVALUATION : Execution of _predict took at 0.703 seconds.
2023-05-07 19:41:30,711 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:41:30,768 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:30,918 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:41:31,456 : [3/3] EVALUATION : Execution of _predict took at 0.691 seconds.
2023-05-07 19:41:32,258 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:41:32,315 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:32,464 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:32,984 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:41:33,791 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:41:33,848 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:33,997 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:34,511 : [3/3] EVALUATION : Execution of _predict took at 0.666 seconds.
2023-05-07 19:41:35,311 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:41:35,369 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:35,520 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:41:36,059 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:41:36,870 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:41:36,927 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:37,079 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:41:37,604 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 19:41:38,417 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:41:38,474 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:38,625 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:41:39,142 : [3/3] EVALUATION : Execution of _predict took at 0.671 seconds.
2023-05-07 19:41:39,948 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:41:40,005 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:40,154 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:41:40,668 : [3/3] EVALUATION : Execution of _predict took at 0.666 seconds.
2023-05-07 19:41:41,474 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:41:41,532 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:41:41,684 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:41:42,228 : [3/3] EVALUATION : Execution of _predict took at 0.699 seconds.
2023-05-07 19:41:43,259 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.780 seconds.
2023-05-07 19:41:43,259 : PIPELINE END : Execution of run took at 159.775 seconds.
d=0.0005, ns=1, nf=5


2023-05-07 19:41:43,294 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:41:43,294 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:41:44,474 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.180 seconds.
2023-05-07 19:41:44,800 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:41:45,250 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:41:45,263 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.969 seconds.
2023-05-07 19:41:45,264 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:41:45,264 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:41:45,264 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:41:45,264 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:41:47,283 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:41:47,283 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:43:34,568 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:43:34,568 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:43:42,837 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:43:42,837 : [2/3] TRAINING : Execution of ldlt took at 115.554 seconds.
2023-05-07 19:43:42,837 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:43:42,838 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:43:42,838 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:43:42,849 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:43:42,921 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:43:42,922 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 19:43:44,088 : [2/3] TRAINING : Execution of _umr_scan took at 1.167 seconds.
2023-05-07 19:43:44,158 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 19:43:44,158 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:43:44,176 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:43:44,234 : [2/3] TRAINING : Current maximum residual: 1.94562284, relative Frobenius norm squared: 0.06435574
2023-05-07 19:43:44,234 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:43:44,252 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:43:44,319 : [2/3] TRAINING : Current maximum residual: 1.87030957, relative Frobenius norm squared: 0.06259817
2023-05-07 19:43:44,319 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:43:44,336 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:43:44,392 : [2/3] TRAINING : Current maximum residual: 1.82634152, relative Frobenius norm squared: 0.06093393
2023-05-07 19:43:44,392 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:43:44,411 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:43:44,467 : [2/3] TRAINING : Current maximum residual: 1.73815054, relative Frobenius norm squared: 0.05939080
2023-05-07 19:43:44,467 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:43:44,483 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:43:44,563 : [2/3] TRAINING : Current maximum residual: 1.69797318, relative Frobenius norm squared: 0.05795572
2023-05-07 19:43:44,577 : [2/3] TRAINING : Execution of ainv_L took at 1.739 seconds.
2023-05-07 19:43:44,577 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:43:44,577 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:43:44,584 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:43:44,590 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:43:45,003 : [2/3] TRAINING : Execution of _construct_weights took at 117.720 seconds.
2023-05-07 19:43:45,004 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:43:45,005 : [2/3] TRAINING : Execution of _get_model took at 119.742 seconds.
2023-05-07 19:43:45,005 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:43:45,070 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:43:45,221 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:43:45,743 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:43:46,554 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:43:46,612 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:46,763 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:43:47,268 : [3/3] EVALUATION : Execution of _predict took at 0.659 seconds.
2023-05-07 19:43:48,068 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:43:48,126 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:48,276 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:43:48,823 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:43:49,627 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:43:49,685 : [3/3] EVALUATION : Execution of _matmat took at 0.005 seconds.
2023-05-07 19:43:49,836 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:43:50,373 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:43:51,178 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:43:51,236 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:51,385 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:43:51,918 : [3/3] EVALUATION : Execution of _predict took at 0.685 seconds.
2023-05-07 19:43:52,716 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:43:52,774 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:52,924 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:43:53,453 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:43:54,261 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:43:54,318 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:54,466 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:43:54,987 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 19:43:55,787 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:43:55,844 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:55,991 : [3/3] EVALUATION : Execution of _matmat took at 0.148 seconds.
2023-05-07 19:43:56,502 : [3/3] EVALUATION : Execution of _predict took at 0.662 seconds.
2023-05-07 19:43:57,300 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:43:57,358 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:57,510 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:43:58,044 : [3/3] EVALUATION : Execution of _predict took at 0.689 seconds.
2023-05-07 19:43:58,847 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:43:58,904 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:43:59,053 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:43:59,559 : [3/3] EVALUATION : Execution of _predict took at 0.658 seconds.
2023-05-07 19:44:00,356 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:44:00,414 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:00,565 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:44:01,076 : [3/3] EVALUATION : Execution of _predict took at 0.665 seconds.
2023-05-07 19:44:01,871 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:44:01,929 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:02,079 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:02,635 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 19:44:03,439 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:44:03,496 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:03,646 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:04,187 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:44:04,994 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:44:05,051 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:05,200 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:44:05,720 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 19:44:06,528 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:44:06,585 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:06,736 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:07,247 : [3/3] EVALUATION : Execution of _predict took at 0.665 seconds.
2023-05-07 19:44:08,044 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:44:08,100 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:08,250 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:08,779 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 19:44:09,582 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:44:09,681 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:44:09,834 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:44:10,382 : [3/3] EVALUATION : Execution of _predict took at 0.706 seconds.
2023-05-07 19:44:11,199 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:44:11,256 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:11,405 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:11,945 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:44:12,742 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:44:12,799 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:12,950 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:44:13,472 : [3/3] EVALUATION : Execution of _predict took at 0.676 seconds.
2023-05-07 19:44:14,276 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:44:14,333 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:14,483 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:44:14,998 : [3/3] EVALUATION : Execution of _predict took at 0.667 seconds.
2023-05-07 19:44:15,795 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:44:15,853 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:16,004 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:44:16,544 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:44:17,348 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:44:17,404 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:17,555 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:44:18,083 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:44:18,885 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:44:18,943 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:19,093 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:19,611 : [3/3] EVALUATION : Execution of _predict took at 0.671 seconds.
2023-05-07 19:44:20,412 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:44:20,468 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:20,618 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:21,134 : [3/3] EVALUATION : Execution of _predict took at 0.668 seconds.
2023-05-07 19:44:21,933 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:44:21,990 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:44:22,140 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:44:22,685 : [3/3] EVALUATION : Execution of _predict took at 0.698 seconds.
2023-05-07 19:44:23,704 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.699 seconds.
2023-05-07 19:44:23,704 : PIPELINE END : Execution of run took at 160.411 seconds.
d=0.0005, ns=1, nf=10


2023-05-07 19:44:23,739 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:44:23,739 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:44:24,918 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.178 seconds.
2023-05-07 19:44:25,243 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:44:25,694 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:44:25,707 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.967 seconds.
2023-05-07 19:44:25,707 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:44:25,707 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:44:25,707 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:44:25,707 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:44:27,711 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:44:27,711 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:46:14,874 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:46:14,874 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:46:23,145 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:46:23,145 : [2/3] TRAINING : Execution of ldlt took at 115.434 seconds.
2023-05-07 19:46:23,145 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:46:23,145 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:46:23,145 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:46:23,156 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:46:23,228 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:46:23,228 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 19:46:24,385 : [2/3] TRAINING : Execution of _umr_scan took at 1.157 seconds.
2023-05-07 19:46:24,452 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 19:46:24,452 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:46:24,470 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:46:24,527 : [2/3] TRAINING : Current maximum residual: 1.94562284, relative Frobenius norm squared: 0.06435574
2023-05-07 19:46:24,527 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:46:24,545 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:46:24,603 : [2/3] TRAINING : Current maximum residual: 1.87030957, relative Frobenius norm squared: 0.06259817
2023-05-07 19:46:24,603 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:46:24,621 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:46:24,680 : [2/3] TRAINING : Current maximum residual: 1.82634152, relative Frobenius norm squared: 0.06093393
2023-05-07 19:46:24,680 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:46:24,699 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:46:24,767 : [2/3] TRAINING : Current maximum residual: 1.73815054, relative Frobenius norm squared: 0.05939080
2023-05-07 19:46:24,767 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:46:24,784 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:46:24,841 : [2/3] TRAINING : Current maximum residual: 1.69797318, relative Frobenius norm squared: 0.05795572
2023-05-07 19:46:24,841 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 19:46:24,857 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:46:24,913 : [2/3] TRAINING : Current maximum residual: 1.65534749, relative Frobenius norm squared: 0.05662210
2023-05-07 19:46:24,913 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 19:46:24,931 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:46:24,988 : [2/3] TRAINING : Current maximum residual: 1.60724403, relative Frobenius norm squared: 0.05532331
2023-05-07 19:46:24,988 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 19:46:25,006 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:46:25,062 : [2/3] TRAINING : Current maximum residual: 1.59370552, relative Frobenius norm squared: 0.05411292
2023-05-07 19:46:25,062 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 19:46:25,079 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:46:25,138 : [2/3] TRAINING : Current maximum residual: 1.55521702, relative Frobenius norm squared: 0.05291151
2023-05-07 19:46:25,138 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 19:46:25,152 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:46:25,228 : [2/3] TRAINING : Current maximum residual: 1.52810143, relative Frobenius norm squared: 0.05177398
2023-05-07 19:46:25,243 : [2/3] TRAINING : Execution of ainv_L took at 2.098 seconds.
2023-05-07 19:46:25,243 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:46:25,243 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:46:25,251 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:46:25,256 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:46:25,671 : [2/3] TRAINING : Execution of _construct_weights took at 117.960 seconds.
2023-05-07 19:46:25,672 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:46:25,672 : [2/3] TRAINING : Execution of _get_model took at 119.965 seconds.
2023-05-07 19:46:25,672 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:46:25,738 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:46:25,890 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:46:26,413 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:46:27,222 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:46:27,279 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:27,429 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:46:27,935 : [3/3] EVALUATION : Execution of _predict took at 0.659 seconds.
2023-05-07 19:46:28,725 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:46:28,785 : [3/3] EVALUATION : Execution of _matmat took at 0.005 seconds.
2023-05-07 19:46:28,936 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:46:29,482 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 19:46:30,280 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:46:30,338 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:30,488 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:46:31,027 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:46:31,823 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:46:31,881 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:32,030 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:46:32,564 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 19:46:33,356 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:46:33,413 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:33,563 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:46:34,094 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:46:34,892 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:46:34,949 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:35,098 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:46:35,619 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:46:36,416 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:46:36,473 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:36,621 : [3/3] EVALUATION : Execution of _matmat took at 0.148 seconds.
2023-05-07 19:46:37,132 : [3/3] EVALUATION : Execution of _predict took at 0.662 seconds.
2023-05-07 19:46:37,923 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:46:37,981 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:38,134 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:46:38,668 : [3/3] EVALUATION : Execution of _predict took at 0.691 seconds.
2023-05-07 19:46:39,465 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:46:39,521 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:39,671 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:46:40,177 : [3/3] EVALUATION : Execution of _predict took at 0.658 seconds.
2023-05-07 19:46:40,965 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:46:41,023 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:41,173 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:46:41,683 : [3/3] EVALUATION : Execution of _predict took at 0.663 seconds.
2023-05-07 19:46:42,470 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:46:42,528 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:42,679 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:46:43,234 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 19:46:44,031 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:46:44,090 : [3/3] EVALUATION : Execution of _matmat took at 0.004 seconds.
2023-05-07 19:46:44,241 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:46:44,783 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 19:46:45,581 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:46:45,638 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:45,788 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:46:46,308 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:46:47,105 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:46:47,162 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:47,313 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:46:47,825 : [3/3] EVALUATION : Execution of _predict took at 0.666 seconds.
2023-05-07 19:46:48,617 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:46:48,673 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:48,826 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:46:49,350 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 19:46:50,147 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:46:50,246 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:50,399 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:46:50,948 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 19:46:51,754 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:46:51,811 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:51,962 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:46:52,501 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:46:53,294 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:46:53,351 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:53,500 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:46:54,022 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:46:54,814 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:46:54,871 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:55,021 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:46:55,536 : [3/3] EVALUATION : Execution of _predict took at 0.668 seconds.
2023-05-07 19:46:56,327 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:46:56,385 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:56,535 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:46:57,076 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:46:57,879 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:46:57,936 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:58,088 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:46:58,615 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:46:59,414 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:46:59,471 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:46:59,623 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:47:00,140 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 19:47:00,939 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:47:00,996 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:47:01,148 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:47:01,664 : [3/3] EVALUATION : Execution of _predict took at 0.671 seconds.
2023-05-07 19:47:02,457 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:47:02,514 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:47:02,667 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:47:03,212 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 19:47:04,226 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.554 seconds.
2023-05-07 19:47:04,226 : PIPELINE END : Execution of run took at 160.487 seconds.
d=0.0005, ns=1, nf=20


2023-05-07 19:47:04,261 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:47:04,261 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:47:05,440 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.179 seconds.
2023-05-07 19:47:05,767 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:47:06,219 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:47:06,232 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.970 seconds.
2023-05-07 19:47:06,232 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:47:06,232 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:47:06,232 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:47:06,232 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:47:08,305 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:47:08,305 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:48:55,707 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:48:55,707 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:49:03,979 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:49:03,979 : [2/3] TRAINING : Execution of ldlt took at 115.674 seconds.
2023-05-07 19:49:03,979 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:49:03,979 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:49:03,979 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:49:03,988 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:49:04,060 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:49:04,060 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 19:49:05,218 : [2/3] TRAINING : Execution of _umr_scan took at 1.158 seconds.
2023-05-07 19:49:05,286 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 19:49:05,286 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:49:05,304 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:49:05,363 : [2/3] TRAINING : Current maximum residual: 1.94562284, relative Frobenius norm squared: 0.06435574
2023-05-07 19:49:05,363 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:49:05,381 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:49:05,444 : [2/3] TRAINING : Current maximum residual: 1.87030957, relative Frobenius norm squared: 0.06259817
2023-05-07 19:49:05,444 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:49:05,461 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:49:05,527 : [2/3] TRAINING : Current maximum residual: 1.82634152, relative Frobenius norm squared: 0.06093393
2023-05-07 19:49:05,527 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:49:05,546 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:49:05,602 : [2/3] TRAINING : Current maximum residual: 1.73815054, relative Frobenius norm squared: 0.05939080
2023-05-07 19:49:05,602 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:49:05,619 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:49:05,675 : [2/3] TRAINING : Current maximum residual: 1.69797318, relative Frobenius norm squared: 0.05795572
2023-05-07 19:49:05,675 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 19:49:05,691 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:49:05,751 : [2/3] TRAINING : Current maximum residual: 1.65534749, relative Frobenius norm squared: 0.05662210
2023-05-07 19:49:05,751 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 19:49:05,769 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:49:05,829 : [2/3] TRAINING : Current maximum residual: 1.60724403, relative Frobenius norm squared: 0.05532331
2023-05-07 19:49:05,829 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 19:49:05,847 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:49:05,913 : [2/3] TRAINING : Current maximum residual: 1.59370552, relative Frobenius norm squared: 0.05411292
2023-05-07 19:49:05,913 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 19:49:05,930 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:49:05,985 : [2/3] TRAINING : Current maximum residual: 1.55521702, relative Frobenius norm squared: 0.05291151
2023-05-07 19:49:05,985 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 19:49:06,000 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:49:06,058 : [2/3] TRAINING : Current maximum residual: 1.52810143, relative Frobenius norm squared: 0.05177398
2023-05-07 19:49:06,058 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 19:49:06,074 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:49:06,132 : [2/3] TRAINING : Current maximum residual: 1.48701892, relative Frobenius norm squared: 0.05067473
2023-05-07 19:49:06,132 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 19:49:06,145 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.013 seconds.
2023-05-07 19:49:06,207 : [2/3] TRAINING : Current maximum residual: 1.45594163, relative Frobenius norm squared: 0.04965894
2023-05-07 19:49:06,207 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 19:49:06,222 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:49:06,291 : [2/3] TRAINING : Current maximum residual: 1.43858637, relative Frobenius norm squared: 0.04863821
2023-05-07 19:49:06,291 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 19:49:06,306 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:49:06,369 : [2/3] TRAINING : Current maximum residual: 1.40983943, relative Frobenius norm squared: 0.04765821
2023-05-07 19:49:06,369 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 19:49:06,384 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:49:06,449 : [2/3] TRAINING : Current maximum residual: 1.36798518, relative Frobenius norm squared: 0.04672444
2023-05-07 19:49:06,450 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 19:49:06,465 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:49:06,522 : [2/3] TRAINING : Current maximum residual: 1.33976686, relative Frobenius norm squared: 0.04584532
2023-05-07 19:49:06,522 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 19:49:06,538 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:49:06,595 : [2/3] TRAINING : Current maximum residual: 1.32180135, relative Frobenius norm squared: 0.04501824
2023-05-07 19:49:06,595 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 19:49:06,611 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:49:06,669 : [2/3] TRAINING : Current maximum residual: 1.29431714, relative Frobenius norm squared: 0.04420179
2023-05-07 19:49:06,669 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 19:49:06,685 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:49:06,741 : [2/3] TRAINING : Current maximum residual: 1.26786249, relative Frobenius norm squared: 0.04344643
2023-05-07 19:49:06,741 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 19:49:06,759 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:49:06,844 : [2/3] TRAINING : Current maximum residual: 1.25309071, relative Frobenius norm squared: 0.04270641
2023-05-07 19:49:06,858 : [2/3] TRAINING : Execution of ainv_L took at 2.880 seconds.
2023-05-07 19:49:06,859 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:49:06,859 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:49:06,866 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:49:06,871 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:49:07,286 : [2/3] TRAINING : Execution of _construct_weights took at 118.981 seconds.
2023-05-07 19:49:07,287 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:49:07,287 : [2/3] TRAINING : Execution of _get_model took at 121.055 seconds.
2023-05-07 19:49:07,287 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:49:07,352 : [3/3] EVALUATION : Execution of _matmat took at 0.007 seconds.
2023-05-07 19:49:07,505 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:49:08,028 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:49:08,831 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:49:08,889 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:09,039 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:09,545 : [3/3] EVALUATION : Execution of _predict took at 0.659 seconds.
2023-05-07 19:49:10,332 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:49:10,390 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:10,541 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:11,087 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 19:49:11,883 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:49:11,942 : [3/3] EVALUATION : Execution of _matmat took at 0.006 seconds.
2023-05-07 19:49:12,092 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:49:12,630 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:49:13,423 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:49:13,481 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:13,631 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:49:14,165 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 19:49:14,955 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:49:15,013 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:15,163 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:15,694 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 19:49:16,486 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:49:16,543 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:16,692 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:49:17,213 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:49:18,001 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:49:18,058 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:18,207 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:49:18,720 : [3/3] EVALUATION : Execution of _predict took at 0.665 seconds.
2023-05-07 19:49:19,506 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:49:19,564 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:19,716 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:49:20,250 : [3/3] EVALUATION : Execution of _predict took at 0.690 seconds.
2023-05-07 19:49:21,040 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:49:21,095 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:21,245 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:49:21,752 : [3/3] EVALUATION : Execution of _predict took at 0.659 seconds.
2023-05-07 19:49:22,538 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:49:22,595 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:22,744 : [3/3] EVALUATION : Execution of _matmat took at 0.149 seconds.
2023-05-07 19:49:23,256 : [3/3] EVALUATION : Execution of _predict took at 0.664 seconds.
2023-05-07 19:49:24,038 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:49:24,095 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:24,245 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:24,803 : [3/3] EVALUATION : Execution of _predict took at 0.711 seconds.
2023-05-07 19:49:25,595 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:49:25,653 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:25,804 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:49:26,345 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 19:49:27,138 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:49:27,194 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:27,344 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:27,865 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:49:28,659 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:49:28,716 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:28,868 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:49:29,381 : [3/3] EVALUATION : Execution of _predict took at 0.667 seconds.
2023-05-07 19:49:30,169 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:49:30,225 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:30,375 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:30,904 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:49:31,694 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:49:31,792 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:31,944 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:49:32,493 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 19:49:33,295 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:49:33,352 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:33,503 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:34,043 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:49:34,830 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:49:34,887 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:35,039 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:49:35,561 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 19:49:36,354 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:49:36,410 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:36,561 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:37,077 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 19:49:37,861 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:49:37,919 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:38,072 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:49:38,613 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 19:49:39,409 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:49:39,465 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:39,616 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:49:40,144 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:49:40,936 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:49:40,994 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:41,145 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:49:41,664 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:49:42,460 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:49:42,516 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:42,666 : [3/3] EVALUATION : Execution of _matmat took at 0.150 seconds.
2023-05-07 19:49:43,182 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 19:49:43,971 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:49:44,028 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:49:44,180 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:49:44,726 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 19:49:45,736 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.449 seconds.
2023-05-07 19:49:45,737 : PIPELINE END : Execution of run took at 161.476 seconds.
d=0.0005, ns=2, nf=0


2023-05-07 19:49:45,771 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:49:45,771 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:49:46,947 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.175 seconds.
2023-05-07 19:49:47,274 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:49:47,724 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:49:47,737 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.966 seconds.
2023-05-07 19:49:47,737 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:49:47,737 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:49:47,737 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:49:47,737 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:49:49,757 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:49:49,757 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:51:36,908 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:51:36,908 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:51:45,165 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:51:45,165 : [2/3] TRAINING : Execution of ldlt took at 115.409 seconds.
2023-05-07 19:51:45,165 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:51:45,165 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:51:45,165 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:51:45,175 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:51:45,246 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:51:45,246 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 19:51:46,410 : [2/3] TRAINING : Execution of _umr_scan took at 1.163 seconds.
2023-05-07 19:51:46,478 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 19:51:46,478 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 19:51:58,533 : [2/3] TRAINING : Execution of _umr_scan took at 12.055 seconds.
2023-05-07 19:51:58,619 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 19:51:58,633 : [2/3] TRAINING : Execution of ainv_L took at 13.468 seconds.
2023-05-07 19:51:58,633 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:51:58,633 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:51:58,641 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:51:58,646 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:51:59,073 : [2/3] TRAINING : Execution of _construct_weights took at 129.316 seconds.
2023-05-07 19:51:59,074 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:51:59,074 : [2/3] TRAINING : Execution of _get_model took at 131.337 seconds.
2023-05-07 19:51:59,075 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:51:59,139 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:51:59,295 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:51:59,825 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:52:00,625 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:52:00,682 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:00,835 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:52:01,348 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 19:52:02,133 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:52:02,192 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:02,346 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:52:02,900 : [3/3] EVALUATION : Execution of _predict took at 0.711 seconds.
2023-05-07 19:52:03,692 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:52:03,750 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:03,904 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:52:04,450 : [3/3] EVALUATION : Execution of _predict took at 0.703 seconds.
2023-05-07 19:52:05,242 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:52:05,300 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:05,452 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:52:05,993 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 19:52:06,781 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:52:06,838 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:06,993 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:52:07,530 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:52:08,327 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:52:08,384 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:08,536 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:52:09,065 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 19:52:09,849 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:52:09,905 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:10,058 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:52:10,577 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:52:11,359 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:52:11,417 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:11,573 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:52:12,114 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:52:12,903 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:52:12,959 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:13,113 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:52:13,627 : [3/3] EVALUATION : Execution of _predict took at 0.671 seconds.
2023-05-07 19:52:14,415 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:52:14,472 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:14,624 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:52:15,142 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 19:52:15,926 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:52:15,983 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:16,136 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:52:16,701 : [3/3] EVALUATION : Execution of _predict took at 0.722 seconds.
2023-05-07 19:52:17,495 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:52:17,552 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:17,707 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:52:18,256 : [3/3] EVALUATION : Execution of _predict took at 0.707 seconds.
2023-05-07 19:52:19,051 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:52:19,107 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:19,260 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:52:19,787 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:52:20,580 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:52:20,637 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:20,791 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:52:21,311 : [3/3] EVALUATION : Execution of _predict took at 0.676 seconds.
2023-05-07 19:52:22,100 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:52:22,156 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:22,310 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:52:22,845 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:52:23,639 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:52:23,697 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:23,854 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 19:52:24,411 : [3/3] EVALUATION : Execution of _predict took at 0.717 seconds.
2023-05-07 19:52:25,212 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:52:25,325 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:25,479 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:52:26,025 : [3/3] EVALUATION : Execution of _predict took at 0.703 seconds.
2023-05-07 19:52:26,812 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:52:26,869 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:27,021 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:52:27,549 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:52:28,342 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:52:28,398 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:28,553 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:52:29,075 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 19:52:29,858 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:52:29,915 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:30,071 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:52:30,619 : [3/3] EVALUATION : Execution of _predict took at 0.707 seconds.
2023-05-07 19:52:31,414 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:52:31,470 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:31,626 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:52:32,159 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:52:32,951 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:52:33,008 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:33,162 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:52:33,687 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:52:34,481 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:52:34,537 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:34,691 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:52:35,213 : [3/3] EVALUATION : Execution of _predict took at 0.679 seconds.
2023-05-07 19:52:36,003 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:52:36,060 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:52:36,215 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:52:36,768 : [3/3] EVALUATION : Execution of _predict took at 0.711 seconds.
2023-05-07 19:52:37,770 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.696 seconds.
2023-05-07 19:52:37,771 : PIPELINE END : Execution of run took at 172.000 seconds.
d=0.0005, ns=2, nf=5


2023-05-07 19:52:37,804 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:52:37,804 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:52:38,979 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.175 seconds.
2023-05-07 19:52:39,304 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:52:39,754 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:52:39,766 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.962 seconds.
2023-05-07 19:52:39,766 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:52:39,766 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:52:39,766 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:52:39,766 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:52:41,792 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:52:41,792 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:54:29,159 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:54:29,159 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:54:37,426 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:54:37,426 : [2/3] TRAINING : Execution of ldlt took at 115.634 seconds.
2023-05-07 19:54:37,426 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:54:37,426 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:54:37,426 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:54:37,432 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:54:37,497 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:54:37,497 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 19:54:38,609 : [2/3] TRAINING : Execution of _umr_scan took at 1.112 seconds.
2023-05-07 19:54:38,680 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 19:54:38,680 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 19:54:50,305 : [2/3] TRAINING : Execution of _umr_scan took at 11.625 seconds.
2023-05-07 19:54:50,363 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 19:54:50,363 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:54:50,379 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:54:50,449 : [2/3] TRAINING : Current maximum residual: 0.51009865, relative Frobenius norm squared: 0.00459964
2023-05-07 19:54:50,450 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:54:50,469 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 19:54:50,526 : [2/3] TRAINING : Current maximum residual: 0.41169834, relative Frobenius norm squared: 0.00455080
2023-05-07 19:54:50,526 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:54:50,545 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:54:50,605 : [2/3] TRAINING : Current maximum residual: 0.32521814, relative Frobenius norm squared: 0.00451590
2023-05-07 19:54:50,605 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:54:50,620 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:54:50,678 : [2/3] TRAINING : Current maximum residual: 0.30632484, relative Frobenius norm squared: 0.00449150
2023-05-07 19:54:50,678 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:54:50,692 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.013 seconds.
2023-05-07 19:54:50,778 : [2/3] TRAINING : Current maximum residual: 0.29084502, relative Frobenius norm squared: 0.00447298
2023-05-07 19:54:50,792 : [2/3] TRAINING : Execution of ainv_L took at 13.365 seconds.
2023-05-07 19:54:50,792 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:54:50,792 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:54:50,799 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:54:50,804 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:54:51,225 : [2/3] TRAINING : Execution of _construct_weights took at 129.433 seconds.
2023-05-07 19:54:51,226 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:54:51,226 : [2/3] TRAINING : Execution of _get_model took at 131.460 seconds.
2023-05-07 19:54:51,226 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:54:51,289 : [3/3] EVALUATION : Execution of _matmat took at 0.007 seconds.
2023-05-07 19:54:51,446 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:54:51,976 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:54:52,777 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:54:52,834 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:54:52,988 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:54:53,501 : [3/3] EVALUATION : Execution of _predict took at 0.670 seconds.
2023-05-07 19:54:54,286 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:54:54,344 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:54:54,498 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:54:55,052 : [3/3] EVALUATION : Execution of _predict took at 0.711 seconds.
2023-05-07 19:54:55,845 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:54:55,902 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:54:56,057 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:54:56,601 : [3/3] EVALUATION : Execution of _predict took at 0.702 seconds.
2023-05-07 19:54:57,390 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:54:57,448 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:54:57,603 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:54:58,144 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:54:58,936 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:54:58,994 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:54:59,149 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:54:59,686 : [3/3] EVALUATION : Execution of _predict took at 0.695 seconds.
2023-05-07 19:55:00,482 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:55:00,540 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:00,693 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:55:01,220 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 19:55:02,004 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:55:02,061 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:02,213 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 19:55:02,732 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:55:03,514 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:55:03,572 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:03,731 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 19:55:04,272 : [3/3] EVALUATION : Execution of _predict took at 0.702 seconds.
2023-05-07 19:55:05,061 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:55:05,117 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:05,271 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:55:05,784 : [3/3] EVALUATION : Execution of _predict took at 0.670 seconds.
2023-05-07 19:55:06,570 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:55:06,627 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:06,780 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:55:07,298 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:55:08,082 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:55:08,140 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:08,295 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:55:08,858 : [3/3] EVALUATION : Execution of _predict took at 0.721 seconds.
2023-05-07 19:55:09,652 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:55:09,710 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:09,866 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:55:10,415 : [3/3] EVALUATION : Execution of _predict took at 0.708 seconds.
2023-05-07 19:55:11,207 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:55:11,264 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:11,417 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:55:11,944 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:55:12,739 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:55:12,796 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:12,951 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:55:13,470 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 19:55:14,259 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:55:14,315 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:14,469 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:55:15,004 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 19:55:15,798 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:55:15,855 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:16,012 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 19:55:16,569 : [3/3] EVALUATION : Execution of _predict took at 0.717 seconds.
2023-05-07 19:55:17,366 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:55:17,423 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:17,579 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:55:18,125 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 19:55:18,911 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:55:18,968 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:19,123 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:55:19,651 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 19:55:20,439 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:55:20,543 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:20,698 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:55:21,219 : [3/3] EVALUATION : Execution of _predict took at 0.679 seconds.
2023-05-07 19:55:22,001 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:55:22,058 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:22,213 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:55:22,760 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 19:55:23,555 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:55:23,610 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:23,768 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 19:55:24,301 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:55:25,092 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:55:25,150 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:25,304 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:55:25,829 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 19:55:26,625 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:55:26,681 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:26,835 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:55:27,357 : [3/3] EVALUATION : Execution of _predict took at 0.679 seconds.
2023-05-07 19:55:28,147 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:55:28,205 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:55:28,361 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:55:28,914 : [3/3] EVALUATION : Execution of _predict took at 0.712 seconds.
2023-05-07 19:55:29,922 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.696 seconds.
2023-05-07 19:55:29,923 : PIPELINE END : Execution of run took at 172.119 seconds.
d=0.0005, ns=2, nf=10


2023-05-07 19:55:29,955 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:55:29,955 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:55:31,131 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.176 seconds.
2023-05-07 19:55:31,456 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:55:31,907 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:55:31,920 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.965 seconds.
2023-05-07 19:55:31,920 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:55:31,920 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:55:31,920 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:55:31,920 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:55:33,942 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:55:33,942 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 19:57:20,912 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 19:57:20,912 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 19:57:29,179 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 19:57:29,179 : [2/3] TRAINING : Execution of ldlt took at 115.237 seconds.
2023-05-07 19:57:29,179 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 19:57:29,179 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 19:57:29,179 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 19:57:29,184 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 19:57:29,249 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 19:57:29,249 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 19:57:30,352 : [2/3] TRAINING : Execution of _umr_scan took at 1.103 seconds.
2023-05-07 19:57:30,422 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 19:57:30,422 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 19:57:41,874 : [2/3] TRAINING : Execution of _umr_scan took at 11.451 seconds.
2023-05-07 19:57:41,932 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 19:57:41,932 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 19:57:41,948 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 19:57:42,016 : [2/3] TRAINING : Current maximum residual: 0.51009865, relative Frobenius norm squared: 0.00459964
2023-05-07 19:57:42,016 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 19:57:42,036 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:57:42,092 : [2/3] TRAINING : Current maximum residual: 0.41169834, relative Frobenius norm squared: 0.00455080
2023-05-07 19:57:42,092 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 19:57:42,111 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:57:42,170 : [2/3] TRAINING : Current maximum residual: 0.32521814, relative Frobenius norm squared: 0.00451590
2023-05-07 19:57:42,170 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 19:57:42,184 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.014 seconds.
2023-05-07 19:57:42,243 : [2/3] TRAINING : Current maximum residual: 0.30632484, relative Frobenius norm squared: 0.00449150
2023-05-07 19:57:42,243 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 19:57:42,256 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.013 seconds.
2023-05-07 19:57:42,320 : [2/3] TRAINING : Current maximum residual: 0.29084502, relative Frobenius norm squared: 0.00447298
2023-05-07 19:57:42,320 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 19:57:42,337 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 19:57:42,397 : [2/3] TRAINING : Current maximum residual: 0.27882642, relative Frobenius norm squared: 0.00445212
2023-05-07 19:57:42,397 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 19:57:42,412 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:57:42,471 : [2/3] TRAINING : Current maximum residual: 0.27298996, relative Frobenius norm squared: 0.00443313
2023-05-07 19:57:42,472 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 19:57:42,486 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 19:57:42,561 : [2/3] TRAINING : Current maximum residual: 0.26798235, relative Frobenius norm squared: 0.00441372
2023-05-07 19:57:42,561 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 19:57:42,580 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 19:57:42,642 : [2/3] TRAINING : Current maximum residual: 0.26227587, relative Frobenius norm squared: 0.00439644
2023-05-07 19:57:42,642 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 19:57:42,661 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 19:57:42,737 : [2/3] TRAINING : Current maximum residual: 0.25756974, relative Frobenius norm squared: 0.00437803
2023-05-07 19:57:42,752 : [2/3] TRAINING : Execution of ainv_L took at 13.573 seconds.
2023-05-07 19:57:42,752 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 19:57:42,752 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 19:57:42,760 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 19:57:42,765 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 19:57:43,186 : [2/3] TRAINING : Execution of _construct_weights took at 129.244 seconds.
2023-05-07 19:57:43,188 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 19:57:43,188 : [2/3] TRAINING : Execution of _get_model took at 131.268 seconds.
2023-05-07 19:57:43,188 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 19:57:43,252 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 19:57:43,408 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:57:43,938 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:57:44,734 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 19:57:44,791 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:44,945 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:57:45,458 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 19:57:46,238 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 19:57:46,296 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:46,449 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:57:47,002 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 19:57:47,791 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 19:57:47,848 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:48,001 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:57:48,545 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:57:49,338 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 19:57:49,396 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:49,549 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:57:50,090 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 19:57:50,877 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 19:57:50,934 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:51,088 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:57:51,626 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:57:52,419 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 19:57:52,476 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:52,630 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:57:53,158 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 19:57:53,941 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 19:57:53,997 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:54,148 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 19:57:54,667 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 19:57:55,447 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 19:57:55,505 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:55,662 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 19:57:56,202 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 19:57:56,992 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 19:57:57,048 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:57,202 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:57:57,715 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 19:57:58,499 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 19:57:58,556 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:57:58,709 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:57:59,227 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 19:58:00,008 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 19:58:00,066 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:00,221 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:58:00,785 : [3/3] EVALUATION : Execution of _predict took at 0.722 seconds.
2023-05-07 19:58:01,578 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 19:58:01,636 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:01,791 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:58:02,339 : [3/3] EVALUATION : Execution of _predict took at 0.706 seconds.
2023-05-07 19:58:03,133 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 19:58:03,190 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:03,343 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 19:58:03,870 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 19:58:04,662 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 19:58:04,719 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:04,875 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:58:05,393 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 19:58:06,182 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 19:58:06,239 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:06,395 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:58:06,930 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 19:58:07,724 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 19:58:07,782 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:07,942 : [3/3] EVALUATION : Execution of _matmat took at 0.160 seconds.
2023-05-07 19:58:08,497 : [3/3] EVALUATION : Execution of _predict took at 0.718 seconds.
2023-05-07 19:58:09,296 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 19:58:09,353 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:09,508 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:58:10,054 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 19:58:10,839 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 19:58:10,896 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:11,052 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:58:11,580 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 19:58:12,369 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 19:58:12,477 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:12,632 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:58:13,154 : [3/3] EVALUATION : Execution of _predict took at 0.679 seconds.
2023-05-07 19:58:13,935 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 19:58:13,993 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:14,153 : [3/3] EVALUATION : Execution of _matmat took at 0.160 seconds.
2023-05-07 19:58:14,700 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 19:58:15,491 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 19:58:15,547 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:15,703 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 19:58:16,237 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 19:58:17,025 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 19:58:17,083 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:17,237 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 19:58:17,761 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 19:58:18,556 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 19:58:18,613 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:18,768 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:58:19,290 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 19:58:20,077 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 19:58:20,134 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 19:58:20,289 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 19:58:20,841 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 19:58:21,848 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.661 seconds.
2023-05-07 19:58:21,849 : PIPELINE END : Execution of run took at 171.894 seconds.
d=0.0005, ns=2, nf=20


2023-05-07 19:58:21,882 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 19:58:21,882 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 19:58:23,057 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.175 seconds.
2023-05-07 19:58:23,381 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 19:58:23,834 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 19:58:23,846 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.964 seconds.
2023-05-07 19:58:23,846 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 19:58:23,846 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 19:58:23,846 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 19:58:23,846 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 19:58:25,877 : [2/3] TRAINING : Constructing weights:
2023-05-07 19:58:25,877 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:00:12,849 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:00:12,849 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:00:21,127 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:00:21,127 : [2/3] TRAINING : Execution of ldlt took at 115.250 seconds.
2023-05-07 20:00:21,127 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:00:21,127 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:00:21,127 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:00:21,133 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:00:21,198 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:00:21,198 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:00:22,300 : [2/3] TRAINING : Execution of _umr_scan took at 1.102 seconds.
2023-05-07 20:00:22,370 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:00:22,370 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:00:33,981 : [2/3] TRAINING : Execution of _umr_scan took at 11.611 seconds.
2023-05-07 20:00:34,040 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:00:34,040 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:00:34,056 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:00:34,124 : [2/3] TRAINING : Current maximum residual: 0.51009865, relative Frobenius norm squared: 0.00459964
2023-05-07 20:00:34,124 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:00:34,144 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:00:34,200 : [2/3] TRAINING : Current maximum residual: 0.41169834, relative Frobenius norm squared: 0.00455080
2023-05-07 20:00:34,200 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:00:34,219 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:00:34,278 : [2/3] TRAINING : Current maximum residual: 0.32521814, relative Frobenius norm squared: 0.00451590
2023-05-07 20:00:34,278 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:00:34,292 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.014 seconds.
2023-05-07 20:00:34,351 : [2/3] TRAINING : Current maximum residual: 0.30632484, relative Frobenius norm squared: 0.00449150
2023-05-07 20:00:34,351 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:00:34,364 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.013 seconds.
2023-05-07 20:00:34,428 : [2/3] TRAINING : Current maximum residual: 0.29084502, relative Frobenius norm squared: 0.00447298
2023-05-07 20:00:34,429 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:00:34,446 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:00:34,506 : [2/3] TRAINING : Current maximum residual: 0.27882642, relative Frobenius norm squared: 0.00445212
2023-05-07 20:00:34,506 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:00:34,521 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 20:00:34,580 : [2/3] TRAINING : Current maximum residual: 0.27298996, relative Frobenius norm squared: 0.00443313
2023-05-07 20:00:34,580 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:00:34,595 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 20:00:34,667 : [2/3] TRAINING : Current maximum residual: 0.26798235, relative Frobenius norm squared: 0.00441372
2023-05-07 20:00:34,667 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:00:34,686 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:00:34,744 : [2/3] TRAINING : Current maximum residual: 0.26227587, relative Frobenius norm squared: 0.00439644
2023-05-07 20:00:34,744 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:00:34,763 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:00:34,827 : [2/3] TRAINING : Current maximum residual: 0.25756974, relative Frobenius norm squared: 0.00437803
2023-05-07 20:00:34,827 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 20:00:34,843 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 20:00:34,901 : [2/3] TRAINING : Current maximum residual: 0.25440829, relative Frobenius norm squared: 0.00436147
2023-05-07 20:00:34,901 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 20:00:34,917 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:00:34,977 : [2/3] TRAINING : Current maximum residual: 0.25168045, relative Frobenius norm squared: 0.00434410
2023-05-07 20:00:34,977 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 20:00:34,994 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:00:35,051 : [2/3] TRAINING : Current maximum residual: 0.24939355, relative Frobenius norm squared: 0.00432684
2023-05-07 20:00:35,051 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 20:00:35,068 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:00:35,125 : [2/3] TRAINING : Current maximum residual: 0.24745453, relative Frobenius norm squared: 0.00430879
2023-05-07 20:00:35,125 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 20:00:35,142 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:00:35,207 : [2/3] TRAINING : Current maximum residual: 0.24491005, relative Frobenius norm squared: 0.00429228
2023-05-07 20:00:35,207 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 20:00:35,225 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:00:35,282 : [2/3] TRAINING : Current maximum residual: 0.24278809, relative Frobenius norm squared: 0.00427558
2023-05-07 20:00:35,282 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 20:00:35,299 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:00:35,363 : [2/3] TRAINING : Current maximum residual: 0.24199371, relative Frobenius norm squared: 0.00425985
2023-05-07 20:00:35,363 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 20:00:35,379 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:00:35,440 : [2/3] TRAINING : Current maximum residual: 0.24005722, relative Frobenius norm squared: 0.00424274
2023-05-07 20:00:35,440 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 20:00:35,456 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:00:35,513 : [2/3] TRAINING : Current maximum residual: 0.23879986, relative Frobenius norm squared: 0.00422480
2023-05-07 20:00:35,513 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 20:00:35,530 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:00:35,600 : [2/3] TRAINING : Current maximum residual: 0.23734364, relative Frobenius norm squared: 0.00420791
2023-05-07 20:00:35,613 : [2/3] TRAINING : Execution of ainv_L took at 14.486 seconds.
2023-05-07 20:00:35,613 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:00:35,613 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:00:35,621 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:00:35,626 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:00:36,049 : [2/3] TRAINING : Execution of _construct_weights took at 130.173 seconds.
2023-05-07 20:00:36,051 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:00:36,051 : [2/3] TRAINING : Execution of _get_model took at 132.205 seconds.
2023-05-07 20:00:36,051 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:00:36,110 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:36,266 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:00:36,796 : [3/3] EVALUATION : Execution of _predict took at 0.690 seconds.
2023-05-07 20:00:37,592 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:00:37,650 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:37,804 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:00:38,316 : [3/3] EVALUATION : Execution of _predict took at 0.669 seconds.
2023-05-07 20:00:39,101 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:00:39,159 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:39,312 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:00:39,866 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:00:40,656 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:00:40,713 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:40,867 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:00:41,411 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 20:00:42,203 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:00:42,261 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:42,415 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:00:42,955 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:00:43,744 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:00:43,803 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:43,957 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:00:44,494 : [3/3] EVALUATION : Execution of _predict took at 0.694 seconds.
2023-05-07 20:00:45,287 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:00:45,344 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:45,496 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 20:00:46,024 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:00:46,812 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:00:46,868 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:47,020 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 20:00:47,539 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 20:00:48,320 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:00:48,378 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:48,533 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:00:49,074 : [3/3] EVALUATION : Execution of _predict took at 0.699 seconds.
2023-05-07 20:00:49,863 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:00:49,919 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:50,072 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:00:50,585 : [3/3] EVALUATION : Execution of _predict took at 0.670 seconds.
2023-05-07 20:00:51,372 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:00:51,430 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:51,581 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 20:00:52,099 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 20:00:52,882 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:00:52,939 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:53,093 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:00:53,657 : [3/3] EVALUATION : Execution of _predict took at 0.721 seconds.
2023-05-07 20:00:54,447 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:00:54,505 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:54,659 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:00:55,207 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 20:00:56,004 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:00:56,061 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:56,214 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:00:56,741 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:00:57,532 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:00:57,589 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:57,744 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:00:58,263 : [3/3] EVALUATION : Execution of _predict took at 0.676 seconds.
2023-05-07 20:00:59,053 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:00:59,109 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:00:59,263 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:00:59,797 : [3/3] EVALUATION : Execution of _predict took at 0.691 seconds.
2023-05-07 20:01:00,588 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:01:00,646 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:00,803 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:01:01,359 : [3/3] EVALUATION : Execution of _predict took at 0.716 seconds.
2023-05-07 20:01:02,154 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:01:02,211 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:02,364 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:01:02,911 : [3/3] EVALUATION : Execution of _predict took at 0.703 seconds.
2023-05-07 20:01:03,699 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:01:03,756 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:03,910 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:01:04,439 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 20:01:05,227 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:01:05,333 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:05,487 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:01:06,008 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 20:01:06,792 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:01:06,850 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:07,005 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:01:07,552 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 20:01:08,347 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:01:08,403 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:08,558 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:01:09,091 : [3/3] EVALUATION : Execution of _predict took at 0.691 seconds.
2023-05-07 20:01:09,879 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:01:09,936 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:10,090 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:01:10,614 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 20:01:11,407 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:01:11,463 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:11,616 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:01:12,139 : [3/3] EVALUATION : Execution of _predict took at 0.679 seconds.
2023-05-07 20:01:12,929 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:01:12,987 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:01:13,141 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:01:13,693 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:01:14,704 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.654 seconds.
2023-05-07 20:01:14,705 : PIPELINE END : Execution of run took at 172.823 seconds.
d=0.0005, ns=3, nf=0


2023-05-07 20:01:14,738 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:01:14,738 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:01:15,914 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.176 seconds.
2023-05-07 20:01:16,239 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:01:16,690 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:01:16,703 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.965 seconds.
2023-05-07 20:01:16,703 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:01:16,703 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:01:16,703 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:01:16,703 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:01:18,713 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:01:18,713 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:03:05,644 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:03:05,644 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:03:13,997 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:03:13,997 : [2/3] TRAINING : Execution of ldlt took at 115.284 seconds.
2023-05-07 20:03:13,997 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:03:13,997 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:03:13,997 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:03:14,003 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:03:14,057 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:03:14,057 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:03:15,177 : [2/3] TRAINING : Execution of _umr_scan took at 1.120 seconds.
2023-05-07 20:03:15,244 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:03:15,244 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:03:26,663 : [2/3] TRAINING : Execution of _umr_scan took at 11.419 seconds.
2023-05-07 20:03:26,725 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:03:26,725 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:03:48,626 : [2/3] TRAINING : Execution of _umr_scan took at 21.901 seconds.
2023-05-07 20:03:48,693 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:03:48,706 : [2/3] TRAINING : Execution of ainv_L took at 34.708 seconds.
2023-05-07 20:03:48,706 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:03:48,706 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:03:48,713 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:03:48,718 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:03:49,156 : [2/3] TRAINING : Execution of _construct_weights took at 150.443 seconds.
2023-05-07 20:03:49,157 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:03:49,157 : [2/3] TRAINING : Execution of _get_model took at 152.454 seconds.
2023-05-07 20:03:49,157 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:03:49,216 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:03:49,373 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:03:49,907 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 20:03:50,704 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:03:50,761 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:03:50,916 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:03:51,432 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 20:03:52,212 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:03:52,270 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:03:52,425 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:03:52,982 : [3/3] EVALUATION : Execution of _predict took at 0.715 seconds.
2023-05-07 20:03:53,775 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:03:53,833 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:03:53,987 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:03:54,536 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 20:03:55,329 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:03:55,387 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:03:55,542 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:03:56,087 : [3/3] EVALUATION : Execution of _predict took at 0.702 seconds.
2023-05-07 20:03:56,877 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:03:56,935 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:03:57,090 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:03:57,631 : [3/3] EVALUATION : Execution of _predict took at 0.699 seconds.
2023-05-07 20:03:58,420 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:03:58,477 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:03:58,631 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:03:59,164 : [3/3] EVALUATION : Execution of _predict took at 0.690 seconds.
2023-05-07 20:03:59,950 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:04:00,007 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:00,160 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:04:00,683 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 20:04:01,468 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:04:01,525 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:01,682 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:04:02,228 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 20:04:03,021 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:04:03,077 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:03,231 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:04:03,748 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 20:04:04,534 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:04:04,591 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:04,745 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:04:05,266 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 20:04:06,052 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:04:06,109 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:06,265 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:04:06,833 : [3/3] EVALUATION : Execution of _predict took at 0.728 seconds.
2023-05-07 20:04:07,625 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:04:07,682 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:07,838 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:04:08,391 : [3/3] EVALUATION : Execution of _predict took at 0.712 seconds.
2023-05-07 20:04:09,186 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:04:09,243 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:09,398 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:04:09,929 : [3/3] EVALUATION : Execution of _predict took at 0.690 seconds.
2023-05-07 20:04:10,722 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:04:10,779 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:10,935 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:04:11,457 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 20:04:12,244 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:04:12,299 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:12,454 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:04:12,993 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:04:13,784 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:04:13,842 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:14,000 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:04:14,560 : [3/3] EVALUATION : Execution of _predict took at 0.721 seconds.
2023-05-07 20:04:15,360 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:04:15,416 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:15,572 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:04:16,122 : [3/3] EVALUATION : Execution of _predict took at 0.708 seconds.
2023-05-07 20:04:16,909 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:04:16,966 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:17,120 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:04:17,652 : [3/3] EVALUATION : Execution of _predict took at 0.689 seconds.
2023-05-07 20:04:18,443 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:04:18,498 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:18,653 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:04:19,178 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:04:19,961 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:04:20,086 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:20,243 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:04:20,794 : [3/3] EVALUATION : Execution of _predict took at 0.711 seconds.
2023-05-07 20:04:21,590 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:04:21,645 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:21,802 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:04:22,340 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:04:23,132 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:04:23,189 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:23,344 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:04:23,872 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 20:04:24,663 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:04:24,719 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:24,874 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:04:25,401 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 20:04:26,190 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:04:26,247 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:04:26,403 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:04:26,959 : [3/3] EVALUATION : Execution of _predict took at 0.715 seconds.
2023-05-07 20:04:27,963 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.805 seconds.
2023-05-07 20:04:27,963 : PIPELINE END : Execution of run took at 193.226 seconds.
d=0.0005, ns=3, nf=5


2023-05-07 20:04:27,996 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:04:27,996 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:04:29,174 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.177 seconds.
2023-05-07 20:04:29,498 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:04:29,949 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:04:29,961 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.965 seconds.
2023-05-07 20:04:29,962 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:04:29,962 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:04:29,962 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:04:29,962 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:04:32,038 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:04:32,038 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:06:19,059 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:06:19,059 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:06:27,337 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:06:27,337 : [2/3] TRAINING : Execution of ldlt took at 115.299 seconds.
2023-05-07 20:06:27,337 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:06:27,338 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:06:27,338 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:06:27,343 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:06:27,404 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:06:27,404 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:06:28,513 : [2/3] TRAINING : Execution of _umr_scan took at 1.109 seconds.
2023-05-07 20:06:28,579 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:06:28,579 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:06:40,110 : [2/3] TRAINING : Execution of _umr_scan took at 11.531 seconds.
2023-05-07 20:06:40,173 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:06:40,173 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:07:02,388 : [2/3] TRAINING : Execution of _umr_scan took at 22.215 seconds.
2023-05-07 20:07:02,444 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:07:02,444 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:07:02,464 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:07:02,519 : [2/3] TRAINING : Current maximum residual: 0.41115296, relative Frobenius norm squared: 0.00096926
2023-05-07 20:07:02,519 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:07:02,541 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:07:02,597 : [2/3] TRAINING : Current maximum residual: 0.25550888, relative Frobenius norm squared: 0.00094675
2023-05-07 20:07:02,597 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:07:02,618 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:07:02,674 : [2/3] TRAINING : Current maximum residual: 0.24930327, relative Frobenius norm squared: 0.00093622
2023-05-07 20:07:02,674 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:07:02,695 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:07:02,751 : [2/3] TRAINING : Current maximum residual: 0.24862583, relative Frobenius norm squared: 0.00092796
2023-05-07 20:07:02,751 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:07:02,771 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:07:02,837 : [2/3] TRAINING : Current maximum residual: 0.24829677, relative Frobenius norm squared: 0.00092200
2023-05-07 20:07:02,850 : [2/3] TRAINING : Execution of ainv_L took at 35.512 seconds.
2023-05-07 20:07:02,850 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:07:02,850 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:07:02,857 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:07:02,863 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:07:03,296 : [2/3] TRAINING : Execution of _construct_weights took at 151.258 seconds.
2023-05-07 20:07:03,297 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:07:03,297 : [2/3] TRAINING : Execution of _get_model took at 153.336 seconds.
2023-05-07 20:07:03,297 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:07:03,356 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:03,512 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:07:04,046 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 20:07:04,846 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:07:04,903 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:05,058 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:05,573 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 20:07:06,354 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:07:06,412 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:06,566 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:07,125 : [3/3] EVALUATION : Execution of _predict took at 0.715 seconds.
2023-05-07 20:07:07,917 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:07:07,975 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:08,129 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:08,678 : [3/3] EVALUATION : Execution of _predict took at 0.706 seconds.
2023-05-07 20:07:09,470 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:07:09,528 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:09,682 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:10,226 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 20:07:11,015 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:07:11,072 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:11,227 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:07:11,768 : [3/3] EVALUATION : Execution of _predict took at 0.699 seconds.
2023-05-07 20:07:12,560 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:07:12,617 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:12,771 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:07:13,303 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:07:14,087 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:07:14,144 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:14,297 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:07:14,819 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 20:07:15,602 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:07:15,660 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:15,817 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:07:16,361 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 20:07:17,152 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:07:17,208 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:17,362 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:17,879 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 20:07:18,666 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:07:18,724 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:18,879 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:07:19,401 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 20:07:20,187 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:07:20,244 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:20,399 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:07:20,966 : [3/3] EVALUATION : Execution of _predict took at 0.725 seconds.
2023-05-07 20:07:21,760 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:07:21,817 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:21,976 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:07:22,528 : [3/3] EVALUATION : Execution of _predict took at 0.714 seconds.
2023-05-07 20:07:23,321 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:07:23,377 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:23,532 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:24,062 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:07:24,854 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:07:24,912 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:25,067 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:07:25,589 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 20:07:26,377 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:07:26,433 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:26,587 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:07:27,125 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 20:07:27,915 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:07:27,972 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:28,130 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:07:28,689 : [3/3] EVALUATION : Execution of _predict took at 0.720 seconds.
2023-05-07 20:07:29,488 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:07:29,544 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:29,700 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:07:30,249 : [3/3] EVALUATION : Execution of _predict took at 0.707 seconds.
2023-05-07 20:07:31,034 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:07:31,090 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:31,244 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:31,776 : [3/3] EVALUATION : Execution of _predict took at 0.689 seconds.
2023-05-07 20:07:32,565 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:07:32,621 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:32,775 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:33,300 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 20:07:34,079 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:07:34,194 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:34,350 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:07:34,901 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:07:35,694 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:07:35,750 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:35,906 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:07:36,442 : [3/3] EVALUATION : Execution of _predict took at 0.695 seconds.
2023-05-07 20:07:37,233 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:07:37,290 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:37,446 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:07:37,974 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:07:38,765 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:07:38,822 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:38,976 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:07:39,502 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:07:40,292 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:07:40,348 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:07:40,504 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:07:41,059 : [3/3] EVALUATION : Execution of _predict took at 0.713 seconds.
2023-05-07 20:07:42,068 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.770 seconds.
2023-05-07 20:07:42,068 : PIPELINE END : Execution of run took at 194.072 seconds.
d=0.0005, ns=3, nf=10


2023-05-07 20:07:42,101 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:07:42,101 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:07:43,276 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.175 seconds.
2023-05-07 20:07:43,600 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:07:44,052 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:07:44,064 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.963 seconds.
2023-05-07 20:07:44,064 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:07:44,064 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:07:44,065 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:07:44,065 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:07:46,132 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:07:46,132 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:09:33,510 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:09:33,510 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:09:41,786 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:09:41,787 : [2/3] TRAINING : Execution of ldlt took at 115.655 seconds.
2023-05-07 20:09:41,787 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:09:41,787 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:09:41,787 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:09:41,792 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:09:41,846 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:09:41,846 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:09:42,956 : [2/3] TRAINING : Execution of _umr_scan took at 1.110 seconds.
2023-05-07 20:09:43,021 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:09:43,021 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:09:54,517 : [2/3] TRAINING : Execution of _umr_scan took at 11.496 seconds.
2023-05-07 20:09:54,582 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:09:54,582 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:10:16,809 : [2/3] TRAINING : Execution of _umr_scan took at 22.227 seconds.
2023-05-07 20:10:16,864 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:10:16,864 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:10:16,883 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:10:16,938 : [2/3] TRAINING : Current maximum residual: 0.41115296, relative Frobenius norm squared: 0.00096926
2023-05-07 20:10:16,938 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:10:16,959 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:10:17,015 : [2/3] TRAINING : Current maximum residual: 0.25550888, relative Frobenius norm squared: 0.00094675
2023-05-07 20:10:17,015 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:10:17,036 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:10:17,091 : [2/3] TRAINING : Current maximum residual: 0.24930327, relative Frobenius norm squared: 0.00093622
2023-05-07 20:10:17,091 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:10:17,112 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:10:17,167 : [2/3] TRAINING : Current maximum residual: 0.24862583, relative Frobenius norm squared: 0.00092796
2023-05-07 20:10:17,168 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:10:17,188 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:10:17,242 : [2/3] TRAINING : Current maximum residual: 0.24829677, relative Frobenius norm squared: 0.00092200
2023-05-07 20:10:17,242 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:10:17,261 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:10:17,316 : [2/3] TRAINING : Current maximum residual: 0.24814399, relative Frobenius norm squared: 0.00091673
2023-05-07 20:10:17,316 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:10:17,335 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:10:17,400 : [2/3] TRAINING : Current maximum residual: 0.24809233, relative Frobenius norm squared: 0.00091389
2023-05-07 20:10:17,400 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:10:17,417 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:10:17,478 : [2/3] TRAINING : Current maximum residual: 0.24807583, relative Frobenius norm squared: 0.00091134
2023-05-07 20:10:17,478 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:10:17,494 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:10:17,560 : [2/3] TRAINING : Current maximum residual: 0.24775583, relative Frobenius norm squared: 0.00090857
2023-05-07 20:10:17,560 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:10:17,583 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:10:17,638 : [2/3] TRAINING : Current maximum residual: 0.24767879, relative Frobenius norm squared: 0.00090718
2023-05-07 20:10:17,650 : [2/3] TRAINING : Execution of ainv_L took at 35.863 seconds.
2023-05-07 20:10:17,650 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:10:17,650 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:10:17,657 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:10:17,662 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:10:18,097 : [2/3] TRAINING : Execution of _construct_weights took at 151.966 seconds.
2023-05-07 20:10:18,098 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:10:18,098 : [2/3] TRAINING : Execution of _get_model took at 154.034 seconds.
2023-05-07 20:10:18,098 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:10:18,158 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:18,313 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:10:18,846 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 20:10:19,647 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:10:19,704 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:19,859 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:20,374 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 20:10:21,156 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:10:21,214 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:21,368 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:21,926 : [3/3] EVALUATION : Execution of _predict took at 0.715 seconds.
2023-05-07 20:10:22,720 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:10:22,777 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:22,931 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:23,479 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 20:10:24,271 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:10:24,329 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:24,483 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:25,027 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 20:10:25,815 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:10:25,873 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:26,027 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:26,567 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:10:27,360 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:10:27,417 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:27,570 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:10:28,102 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:10:28,888 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:10:28,945 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:29,097 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:10:29,620 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 20:10:30,404 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:10:30,462 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:30,620 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:10:31,164 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 20:10:31,958 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:10:32,014 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:32,169 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:32,685 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 20:10:33,470 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:10:33,527 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:33,681 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:10:34,201 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 20:10:34,985 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:10:35,043 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:35,198 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:10:35,766 : [3/3] EVALUATION : Execution of _predict took at 0.726 seconds.
2023-05-07 20:10:36,558 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:10:36,615 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:36,771 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:10:37,322 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:10:38,116 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:10:38,173 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:38,328 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:10:38,858 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:10:39,651 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:10:39,709 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:39,864 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:10:40,387 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 20:10:41,172 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:10:41,228 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:41,384 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:10:41,922 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:10:42,716 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:10:42,773 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:42,931 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:10:43,490 : [3/3] EVALUATION : Execution of _predict took at 0.720 seconds.
2023-05-07 20:10:44,289 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:10:44,345 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:44,500 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:10:45,050 : [3/3] EVALUATION : Execution of _predict took at 0.708 seconds.
2023-05-07 20:10:45,838 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:10:45,895 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:46,049 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:46,580 : [3/3] EVALUATION : Execution of _predict took at 0.689 seconds.
2023-05-07 20:10:47,370 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:10:47,426 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:47,580 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:10:48,105 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:10:48,884 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:10:48,942 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:49,097 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:10:49,648 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:10:50,442 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:10:50,498 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:50,655 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:10:51,192 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 20:10:51,982 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:10:52,100 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:52,255 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:10:52,783 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:10:53,574 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:10:53,631 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:53,786 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:10:54,313 : [3/3] EVALUATION : Execution of _predict took at 0.685 seconds.
2023-05-07 20:10:55,100 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:10:55,158 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:10:55,314 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:10:55,869 : [3/3] EVALUATION : Execution of _predict took at 0.714 seconds.
2023-05-07 20:10:56,878 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.779 seconds.
2023-05-07 20:10:56,878 : PIPELINE END : Execution of run took at 194.777 seconds.
d=0.0005, ns=3, nf=20


2023-05-07 20:10:56,911 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:10:56,911 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:10:58,087 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.176 seconds.
2023-05-07 20:10:58,413 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:10:58,865 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:10:58,877 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.966 seconds.
2023-05-07 20:10:58,877 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:10:58,878 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:10:58,878 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:10:58,878 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:11:00,885 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:11:00,885 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:12:47,976 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:12:47,976 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:12:56,242 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:12:56,242 : [2/3] TRAINING : Execution of ldlt took at 115.358 seconds.
2023-05-07 20:12:56,242 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:12:56,242 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:12:56,243 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:12:56,248 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:12:56,302 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:12:56,302 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:12:57,409 : [2/3] TRAINING : Execution of _umr_scan took at 1.107 seconds.
2023-05-07 20:12:57,474 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:12:57,474 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:13:09,130 : [2/3] TRAINING : Execution of _umr_scan took at 11.655 seconds.
2023-05-07 20:13:09,191 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:13:09,191 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:13:31,313 : [2/3] TRAINING : Execution of _umr_scan took at 22.123 seconds.
2023-05-07 20:13:31,381 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:13:31,381 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:13:31,400 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:13:31,466 : [2/3] TRAINING : Current maximum residual: 0.41115296, relative Frobenius norm squared: 0.00096926
2023-05-07 20:13:31,466 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:13:31,487 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:13:31,549 : [2/3] TRAINING : Current maximum residual: 0.25550888, relative Frobenius norm squared: 0.00094675
2023-05-07 20:13:31,549 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:13:31,570 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:13:31,625 : [2/3] TRAINING : Current maximum residual: 0.24930327, relative Frobenius norm squared: 0.00093622
2023-05-07 20:13:31,626 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:13:31,646 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:13:31,701 : [2/3] TRAINING : Current maximum residual: 0.24862583, relative Frobenius norm squared: 0.00092796
2023-05-07 20:13:31,701 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:13:31,721 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:13:31,775 : [2/3] TRAINING : Current maximum residual: 0.24829677, relative Frobenius norm squared: 0.00092200
2023-05-07 20:13:31,775 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:13:31,794 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:13:31,867 : [2/3] TRAINING : Current maximum residual: 0.24814399, relative Frobenius norm squared: 0.00091673
2023-05-07 20:13:31,867 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:13:31,886 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:13:31,948 : [2/3] TRAINING : Current maximum residual: 0.24809233, relative Frobenius norm squared: 0.00091389
2023-05-07 20:13:31,948 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:13:31,965 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:13:32,020 : [2/3] TRAINING : Current maximum residual: 0.24807583, relative Frobenius norm squared: 0.00091134
2023-05-07 20:13:32,021 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:13:32,037 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:13:32,092 : [2/3] TRAINING : Current maximum residual: 0.24775583, relative Frobenius norm squared: 0.00090857
2023-05-07 20:13:32,092 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:13:32,114 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:13:32,173 : [2/3] TRAINING : Current maximum residual: 0.24767879, relative Frobenius norm squared: 0.00090718
2023-05-07 20:13:32,174 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 20:13:32,191 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:13:32,256 : [2/3] TRAINING : Current maximum residual: 0.24765790, relative Frobenius norm squared: 0.00090575
2023-05-07 20:13:32,256 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 20:13:32,278 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:13:32,342 : [2/3] TRAINING : Current maximum residual: 0.24765199, relative Frobenius norm squared: 0.00090472
2023-05-07 20:13:32,342 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 20:13:32,364 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:13:32,419 : [2/3] TRAINING : Current maximum residual: 0.24765031, relative Frobenius norm squared: 0.00090375
2023-05-07 20:13:32,419 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 20:13:32,440 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:13:32,505 : [2/3] TRAINING : Current maximum residual: 0.24764982, relative Frobenius norm squared: 0.00090237
2023-05-07 20:13:32,505 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 20:13:32,525 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:13:32,580 : [2/3] TRAINING : Current maximum residual: 0.24764968, relative Frobenius norm squared: 0.00090109
2023-05-07 20:13:32,580 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 20:13:32,602 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:13:32,661 : [2/3] TRAINING : Current maximum residual: 0.24764964, relative Frobenius norm squared: 0.00090047
2023-05-07 20:13:32,661 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 20:13:32,677 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:13:32,732 : [2/3] TRAINING : Current maximum residual: 0.24764962, relative Frobenius norm squared: 0.00089918
2023-05-07 20:13:32,732 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 20:13:32,753 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:13:32,808 : [2/3] TRAINING : Current maximum residual: 0.24764962, relative Frobenius norm squared: 0.00089861
2023-05-07 20:13:32,808 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 20:13:32,826 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:13:32,881 : [2/3] TRAINING : Current maximum residual: 0.24764962, relative Frobenius norm squared: 0.00089770
2023-05-07 20:13:32,881 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 20:13:32,901 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:13:32,957 : [2/3] TRAINING : Current maximum residual: 0.24764961, relative Frobenius norm squared: 0.00089704
2023-05-07 20:13:32,971 : [2/3] TRAINING : Execution of ainv_L took at 36.728 seconds.
2023-05-07 20:13:32,971 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:13:32,971 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:13:32,978 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:13:32,983 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:13:33,415 : [2/3] TRAINING : Execution of _construct_weights took at 152.530 seconds.
2023-05-07 20:13:33,416 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:13:33,416 : [2/3] TRAINING : Execution of _get_model took at 154.539 seconds.
2023-05-07 20:13:33,416 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:13:33,476 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:33,632 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:13:34,166 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 20:13:34,964 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:13:35,021 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:35,175 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:13:35,690 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 20:13:36,473 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:13:36,531 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:36,686 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:13:37,243 : [3/3] EVALUATION : Execution of _predict took at 0.714 seconds.
2023-05-07 20:13:38,038 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:13:38,095 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:38,249 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:13:38,796 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 20:13:39,588 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:13:39,646 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:39,801 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:13:40,345 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 20:13:41,136 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:13:41,194 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:41,349 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:13:41,889 : [3/3] EVALUATION : Execution of _predict took at 0.698 seconds.
2023-05-07 20:13:42,684 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:13:42,741 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:42,895 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:13:43,419 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 20:13:44,204 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:13:44,260 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:44,412 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 20:13:44,935 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 20:13:45,717 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:13:45,775 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:45,933 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:13:46,476 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 20:13:47,269 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:13:47,325 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:47,479 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:13:47,996 : [3/3] EVALUATION : Execution of _predict took at 0.674 seconds.
2023-05-07 20:13:48,783 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:13:48,841 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:48,994 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:13:49,515 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 20:13:50,299 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:13:50,356 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:50,511 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:13:51,079 : [3/3] EVALUATION : Execution of _predict took at 0.725 seconds.
2023-05-07 20:13:51,869 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:13:51,926 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:52,081 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:13:52,633 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:13:53,427 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:13:53,484 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:53,639 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:13:54,169 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:13:54,964 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:13:55,021 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:55,177 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:13:55,699 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 20:13:56,486 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:13:56,542 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:56,697 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:13:57,234 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 20:13:58,026 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:13:58,083 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:58,241 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:13:58,801 : [3/3] EVALUATION : Execution of _predict took at 0.721 seconds.
2023-05-07 20:13:59,599 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:13:59,656 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:13:59,811 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:14:00,360 : [3/3] EVALUATION : Execution of _predict took at 0.707 seconds.
2023-05-07 20:14:01,147 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:14:01,204 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:14:01,358 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:14:01,889 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:14:02,677 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:14:02,734 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:14:02,889 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:14:03,414 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:14:04,197 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:14:04,255 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:14:04,411 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:14:04,961 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 20:14:05,756 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:14:05,813 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:14:05,970 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:14:06,506 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:14:07,298 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:14:07,416 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:14:07,571 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:14:08,099 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 20:14:08,891 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:14:08,947 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:14:09,101 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:14:09,627 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:14:10,417 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:14:10,475 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:14:10,631 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:14:11,186 : [3/3] EVALUATION : Execution of _predict took at 0.715 seconds.
2023-05-07 20:14:12,198 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.781 seconds.
2023-05-07 20:14:12,198 : PIPELINE END : Execution of run took at 195.287 seconds.
d=0.0005, ns=4, nf=0


2023-05-07 20:14:12,231 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:14:12,231 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:14:13,407 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.176 seconds.
2023-05-07 20:14:13,734 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:14:14,186 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:14:14,199 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.968 seconds.
2023-05-07 20:14:14,199 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:14:14,199 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:14:14,199 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:14:14,199 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:14:16,212 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:14:16,212 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:16:03,055 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:16:03,055 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:16:11,325 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:16:11,325 : [2/3] TRAINING : Execution of ldlt took at 115.113 seconds.
2023-05-07 20:16:11,325 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:16:11,325 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:16:11,325 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:16:11,330 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:16:11,395 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:16:11,395 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:16:12,506 : [2/3] TRAINING : Execution of _umr_scan took at 1.111 seconds.
2023-05-07 20:16:12,572 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:16:12,572 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:16:24,029 : [2/3] TRAINING : Execution of _umr_scan took at 11.456 seconds.
2023-05-07 20:16:24,092 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:16:24,092 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:16:45,958 : [2/3] TRAINING : Execution of _umr_scan took at 21.866 seconds.
2023-05-07 20:16:46,022 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:16:46,022 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 20:17:08,185 : [2/3] TRAINING : Execution of _umr_scan took at 22.163 seconds.
2023-05-07 20:17:08,262 : [2/3] TRAINING : Current maximum residual: 0.41115296, relative Frobenius norm squared: 0.00066946
2023-05-07 20:17:08,275 : [2/3] TRAINING : Execution of ainv_L took at 56.950 seconds.
2023-05-07 20:17:08,275 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:17:08,275 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:17:08,282 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:17:08,288 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:17:08,727 : [2/3] TRAINING : Execution of _construct_weights took at 172.515 seconds.
2023-05-07 20:17:08,728 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:17:08,728 : [2/3] TRAINING : Execution of _get_model took at 174.529 seconds.
2023-05-07 20:17:08,729 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:17:08,788 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:08,944 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:17:09,477 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 20:17:10,274 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:17:10,331 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:10,485 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:10,995 : [3/3] EVALUATION : Execution of _predict took at 0.667 seconds.
2023-05-07 20:17:11,775 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:17:11,833 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:11,988 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:12,545 : [3/3] EVALUATION : Execution of _predict took at 0.715 seconds.
2023-05-07 20:17:13,336 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:17:13,393 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:13,547 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:17:14,096 : [3/3] EVALUATION : Execution of _predict took at 0.706 seconds.
2023-05-07 20:17:14,884 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:17:14,942 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:15,098 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:17:15,642 : [3/3] EVALUATION : Execution of _predict took at 0.702 seconds.
2023-05-07 20:17:16,431 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:17:16,489 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:16,643 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:17,184 : [3/3] EVALUATION : Execution of _predict took at 0.698 seconds.
2023-05-07 20:17:17,975 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:17:18,032 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:18,185 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:17:18,717 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:17:19,500 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:17:19,557 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:19,709 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 20:17:20,231 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 20:17:21,010 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:17:21,068 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:21,224 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:17:21,768 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 20:17:22,559 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:17:22,615 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:22,769 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:17:23,285 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 20:17:24,070 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:17:24,127 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:24,280 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:17:24,801 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 20:17:25,583 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:17:25,639 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:25,794 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:17:26,362 : [3/3] EVALUATION : Execution of _predict took at 0.725 seconds.
2023-05-07 20:17:27,152 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:17:27,209 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:27,364 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:27,915 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 20:17:28,709 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:17:28,766 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:28,921 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:29,451 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:17:30,242 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:17:30,298 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:30,454 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:17:30,975 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 20:17:31,760 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:17:31,815 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:31,970 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:32,507 : [3/3] EVALUATION : Execution of _predict took at 0.695 seconds.
2023-05-07 20:17:33,296 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:17:33,352 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:33,509 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:17:34,069 : [3/3] EVALUATION : Execution of _predict took at 0.719 seconds.
2023-05-07 20:17:34,867 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:17:34,923 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:35,079 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:17:35,628 : [3/3] EVALUATION : Execution of _predict took at 0.708 seconds.
2023-05-07 20:17:36,412 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:17:36,468 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:36,621 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:17:37,153 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:17:37,939 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:17:37,995 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:38,149 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:38,674 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 20:17:39,454 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:17:39,511 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:39,666 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:17:40,217 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 20:17:41,008 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:17:41,064 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:41,221 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:17:41,758 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:17:42,546 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:17:42,603 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:42,758 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:17:43,286 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 20:17:44,073 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:17:44,200 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:44,354 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:17:44,880 : [3/3] EVALUATION : Execution of _predict took at 0.683 seconds.
2023-05-07 20:17:45,668 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:17:45,725 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:17:45,880 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:17:46,435 : [3/3] EVALUATION : Execution of _predict took at 0.714 seconds.
2023-05-07 20:17:47,439 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.710 seconds.
2023-05-07 20:17:47,439 : PIPELINE END : Execution of run took at 215.208 seconds.
d=0.0005, ns=4, nf=5


2023-05-07 20:17:47,472 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:17:47,472 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:17:48,649 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.176 seconds.
2023-05-07 20:17:48,975 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:17:49,426 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:17:49,439 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.966 seconds.
2023-05-07 20:17:49,439 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:17:49,439 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:17:49,439 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:17:49,439 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:17:51,457 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:17:51,457 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:19:39,067 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:19:39,067 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:19:47,326 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:19:47,326 : [2/3] TRAINING : Execution of ldlt took at 115.869 seconds.
2023-05-07 20:19:47,326 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:19:47,326 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:19:47,326 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:19:47,331 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:19:47,388 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:19:47,389 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:19:48,527 : [2/3] TRAINING : Execution of _umr_scan took at 1.138 seconds.
2023-05-07 20:19:48,593 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:19:48,593 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:20:00,128 : [2/3] TRAINING : Execution of _umr_scan took at 11.535 seconds.
2023-05-07 20:20:00,192 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:20:00,192 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:20:22,081 : [2/3] TRAINING : Execution of _umr_scan took at 21.889 seconds.
2023-05-07 20:20:22,140 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:20:22,140 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 20:20:43,968 : [2/3] TRAINING : Execution of _umr_scan took at 21.829 seconds.
2023-05-07 20:20:44,023 : [2/3] TRAINING : Current maximum residual: 0.41115296, relative Frobenius norm squared: 0.00066946
2023-05-07 20:20:44,023 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:20:44,039 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 20:20:44,094 : [2/3] TRAINING : Current maximum residual: 0.25192782, relative Frobenius norm squared: 0.00065608
2023-05-07 20:20:44,095 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:20:44,112 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:20:44,179 : [2/3] TRAINING : Current maximum residual: 0.24980678, relative Frobenius norm squared: 0.00065389
2023-05-07 20:20:44,180 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:20:44,198 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:20:44,265 : [2/3] TRAINING : Current maximum residual: 0.24925603, relative Frobenius norm squared: 0.00065286
2023-05-07 20:20:44,265 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:20:44,282 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:20:44,344 : [2/3] TRAINING : Current maximum residual: 0.24917641, relative Frobenius norm squared: 0.00065177
2023-05-07 20:20:44,344 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:20:44,363 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:20:44,430 : [2/3] TRAINING : Current maximum residual: 0.24911609, relative Frobenius norm squared: 0.00065158
2023-05-07 20:20:44,443 : [2/3] TRAINING : Execution of ainv_L took at 57.117 seconds.
2023-05-07 20:20:44,443 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:20:44,443 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:20:44,451 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:20:44,456 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:20:44,899 : [2/3] TRAINING : Execution of _construct_weights took at 173.442 seconds.
2023-05-07 20:20:44,900 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:20:44,900 : [2/3] TRAINING : Execution of _get_model took at 175.461 seconds.
2023-05-07 20:20:44,900 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:20:44,959 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:45,114 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:20:45,647 : [3/3] EVALUATION : Execution of _predict took at 0.691 seconds.
2023-05-07 20:20:46,450 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:20:46,507 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:46,660 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:20:47,175 : [3/3] EVALUATION : Execution of _predict took at 0.671 seconds.
2023-05-07 20:20:47,959 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:20:48,017 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:48,171 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:20:48,728 : [3/3] EVALUATION : Execution of _predict took at 0.714 seconds.
2023-05-07 20:20:49,524 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:20:49,581 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:49,736 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:20:50,283 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 20:20:51,075 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:20:51,133 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:51,286 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:20:51,830 : [3/3] EVALUATION : Execution of _predict took at 0.700 seconds.
2023-05-07 20:20:52,618 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:20:52,676 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:52,831 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:20:53,370 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:20:54,166 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:20:54,223 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:54,375 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 20:20:54,906 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 20:20:55,693 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:20:55,750 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:55,901 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 20:20:56,424 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 20:20:57,207 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:20:57,264 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:57,420 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:20:57,964 : [3/3] EVALUATION : Execution of _predict took at 0.703 seconds.
2023-05-07 20:20:58,757 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:20:58,813 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:20:58,967 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:20:59,483 : [3/3] EVALUATION : Execution of _predict took at 0.673 seconds.
2023-05-07 20:21:00,269 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:21:00,327 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:00,481 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:21:01,002 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 20:21:01,784 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:21:01,841 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:01,996 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:21:02,562 : [3/3] EVALUATION : Execution of _predict took at 0.724 seconds.
2023-05-07 20:21:03,352 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:21:03,409 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:03,564 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:21:04,115 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 20:21:04,909 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:21:04,965 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:05,120 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:21:05,650 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:21:06,441 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:21:06,499 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:06,653 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:21:07,175 : [3/3] EVALUATION : Execution of _predict took at 0.679 seconds.
2023-05-07 20:21:07,962 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:21:08,017 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:08,174 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:21:08,711 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:21:09,500 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:21:09,557 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:09,713 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:21:10,272 : [3/3] EVALUATION : Execution of _predict took at 0.718 seconds.
2023-05-07 20:21:11,070 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:21:11,126 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:11,281 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:21:11,829 : [3/3] EVALUATION : Execution of _predict took at 0.706 seconds.
2023-05-07 20:21:12,616 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:21:12,672 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:12,825 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 20:21:13,356 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:21:14,144 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:21:14,200 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:14,353 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:21:14,878 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 20:21:15,659 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:21:15,716 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:15,872 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:21:16,422 : [3/3] EVALUATION : Execution of _predict took at 0.708 seconds.
2023-05-07 20:21:17,212 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:21:17,268 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:17,424 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:21:17,961 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 20:21:18,749 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:21:18,807 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:18,961 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:21:19,488 : [3/3] EVALUATION : Execution of _predict took at 0.685 seconds.
2023-05-07 20:21:20,278 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:21:20,405 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:20,558 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:21:21,084 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 20:21:21,873 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:21:21,930 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:21:22,085 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:21:22,640 : [3/3] EVALUATION : Execution of _predict took at 0.713 seconds.
2023-05-07 20:21:23,652 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.752 seconds.
2023-05-07 20:21:23,653 : PIPELINE END : Execution of run took at 216.180 seconds.
d=0.0005, ns=4, nf=10


2023-05-07 20:21:23,685 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:21:23,686 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:21:24,863 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.178 seconds.
2023-05-07 20:21:25,188 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:21:25,639 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:21:25,652 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.966 seconds.
2023-05-07 20:21:25,652 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:21:25,652 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:21:25,652 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:21:25,652 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:21:27,718 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:21:27,718 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:23:14,906 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:23:14,906 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:23:23,178 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:23:23,178 : [2/3] TRAINING : Execution of ldlt took at 115.460 seconds.
2023-05-07 20:23:23,178 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:23:23,178 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:23:23,178 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:23:23,184 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:23:23,248 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:23:23,248 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:23:24,382 : [2/3] TRAINING : Execution of _umr_scan took at 1.134 seconds.
2023-05-07 20:23:24,448 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:23:24,448 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:23:35,970 : [2/3] TRAINING : Execution of _umr_scan took at 11.522 seconds.
2023-05-07 20:23:36,033 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:23:36,034 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:23:57,869 : [2/3] TRAINING : Execution of _umr_scan took at 21.835 seconds.
2023-05-07 20:23:57,927 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:23:57,927 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 20:24:19,790 : [2/3] TRAINING : Execution of _umr_scan took at 21.863 seconds.
2023-05-07 20:24:19,845 : [2/3] TRAINING : Current maximum residual: 0.41115296, relative Frobenius norm squared: 0.00066946
2023-05-07 20:24:19,846 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:24:19,861 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.015 seconds.
2023-05-07 20:24:19,916 : [2/3] TRAINING : Current maximum residual: 0.25192782, relative Frobenius norm squared: 0.00065608
2023-05-07 20:24:19,916 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:24:19,934 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:24:20,002 : [2/3] TRAINING : Current maximum residual: 0.24980678, relative Frobenius norm squared: 0.00065389
2023-05-07 20:24:20,002 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:24:20,021 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:24:20,087 : [2/3] TRAINING : Current maximum residual: 0.24925603, relative Frobenius norm squared: 0.00065286
2023-05-07 20:24:20,087 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:24:20,104 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:24:20,166 : [2/3] TRAINING : Current maximum residual: 0.24917641, relative Frobenius norm squared: 0.00065177
2023-05-07 20:24:20,166 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:24:20,185 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:24:20,241 : [2/3] TRAINING : Current maximum residual: 0.24911609, relative Frobenius norm squared: 0.00065158
2023-05-07 20:24:20,241 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:24:20,261 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:24:20,316 : [2/3] TRAINING : Current maximum residual: 0.24909780, relative Frobenius norm squared: 0.00065146
2023-05-07 20:24:20,316 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:24:20,337 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:24:20,403 : [2/3] TRAINING : Current maximum residual: 0.24909298, relative Frobenius norm squared: 0.00065129
2023-05-07 20:24:20,403 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:24:20,423 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:24:20,489 : [2/3] TRAINING : Current maximum residual: 0.24909215, relative Frobenius norm squared: 0.00065124
2023-05-07 20:24:20,489 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:24:20,511 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:24:20,574 : [2/3] TRAINING : Current maximum residual: 0.24909228, relative Frobenius norm squared: 0.00065118
2023-05-07 20:24:20,574 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:24:20,595 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:24:20,663 : [2/3] TRAINING : Current maximum residual: 0.24909253, relative Frobenius norm squared: 0.00065115
2023-05-07 20:24:20,675 : [2/3] TRAINING : Execution of ainv_L took at 57.497 seconds.
2023-05-07 20:24:20,675 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:24:20,675 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:24:20,683 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:24:20,688 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:24:21,127 : [2/3] TRAINING : Execution of _construct_weights took at 173.409 seconds.
2023-05-07 20:24:21,128 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:24:21,128 : [2/3] TRAINING : Execution of _get_model took at 175.476 seconds.
2023-05-07 20:24:21,128 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:24:21,187 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:21,342 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:21,875 : [3/3] EVALUATION : Execution of _predict took at 0.691 seconds.
2023-05-07 20:24:22,675 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:24:22,733 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:22,887 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:24:23,403 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 20:24:24,183 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:24:24,241 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:24,395 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:24:24,952 : [3/3] EVALUATION : Execution of _predict took at 0.714 seconds.
2023-05-07 20:24:25,746 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:24:25,803 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:25,958 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:26,505 : [3/3] EVALUATION : Execution of _predict took at 0.705 seconds.
2023-05-07 20:24:27,297 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:24:27,354 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:27,508 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:24:28,052 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 20:24:28,843 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:24:28,901 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:29,055 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:29,595 : [3/3] EVALUATION : Execution of _predict took at 0.697 seconds.
2023-05-07 20:24:30,387 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:24:30,444 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:30,597 : [3/3] EVALUATION : Execution of _matmat took at 0.152 seconds.
2023-05-07 20:24:31,128 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 20:24:31,913 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:24:31,969 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:32,121 : [3/3] EVALUATION : Execution of _matmat took at 0.151 seconds.
2023-05-07 20:24:32,643 : [3/3] EVALUATION : Execution of _predict took at 0.676 seconds.
2023-05-07 20:24:33,425 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:24:33,483 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:33,640 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:24:34,184 : [3/3] EVALUATION : Execution of _predict took at 0.704 seconds.
2023-05-07 20:24:34,975 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:24:35,031 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:35,184 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:24:35,701 : [3/3] EVALUATION : Execution of _predict took at 0.672 seconds.
2023-05-07 20:24:36,487 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:24:36,544 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:36,698 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:24:37,219 : [3/3] EVALUATION : Execution of _predict took at 0.677 seconds.
2023-05-07 20:24:38,000 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:24:38,057 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:38,212 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:38,780 : [3/3] EVALUATION : Execution of _predict took at 0.725 seconds.
2023-05-07 20:24:39,572 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:24:39,629 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:39,784 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:40,336 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:24:41,133 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:24:41,189 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:41,344 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:24:41,874 : [3/3] EVALUATION : Execution of _predict took at 0.688 seconds.
2023-05-07 20:24:42,665 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:24:42,723 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:42,878 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:43,400 : [3/3] EVALUATION : Execution of _predict took at 0.680 seconds.
2023-05-07 20:24:44,189 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:24:44,245 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:44,399 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:24:44,937 : [3/3] EVALUATION : Execution of _predict took at 0.695 seconds.
2023-05-07 20:24:45,727 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:24:45,784 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:45,941 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:24:46,488 : [3/3] EVALUATION : Execution of _predict took at 0.707 seconds.
2023-05-07 20:24:47,288 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:24:47,344 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:47,499 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:48,049 : [3/3] EVALUATION : Execution of _predict took at 0.707 seconds.
2023-05-07 20:24:48,837 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:24:48,894 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:49,047 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:24:49,579 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:24:50,364 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:24:50,420 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:50,573 : [3/3] EVALUATION : Execution of _matmat took at 0.153 seconds.
2023-05-07 20:24:51,098 : [3/3] EVALUATION : Execution of _predict took at 0.681 seconds.
2023-05-07 20:24:51,879 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:24:51,936 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:52,092 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:24:52,641 : [3/3] EVALUATION : Execution of _predict took at 0.708 seconds.
2023-05-07 20:24:53,437 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:24:53,493 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:53,649 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:24:54,186 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 20:24:54,977 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:24:55,034 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:55,189 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:55,717 : [3/3] EVALUATION : Execution of _predict took at 0.685 seconds.
2023-05-07 20:24:56,508 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:24:56,634 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:56,788 : [3/3] EVALUATION : Execution of _matmat took at 0.154 seconds.
2023-05-07 20:24:57,314 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 20:24:58,105 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:24:58,162 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:24:58,317 : [3/3] EVALUATION : Execution of _matmat took at 0.155 seconds.
2023-05-07 20:24:58,872 : [3/3] EVALUATION : Execution of _predict took at 0.712 seconds.
2023-05-07 20:24:59,886 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.758 seconds.
2023-05-07 20:24:59,887 : PIPELINE END : Execution of run took at 216.202 seconds.
d=0.0005, ns=4, nf=20


2023-05-07 20:24:59,920 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:24:59,920 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:25:01,099 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.179 seconds.
2023-05-07 20:25:01,426 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:25:01,877 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:25:01,890 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.970 seconds.
2023-05-07 20:25:01,890 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:25:01,890 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:25:01,890 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.050000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:25:01,890 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:25:03,931 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:25:03,931 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:26:50,906 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:26:50,906 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:26:59,188 : [2/3] TRAINING : sparsified L info | nnz: 846250, size: 10.320 MB, density: 0.050000%
2023-05-07 20:26:59,189 : [2/3] TRAINING : Execution of ldlt took at 115.258 seconds.
2023-05-07 20:26:59,189 : [2/3] TRAINING : nnz of L: 846250, size: 10.320 MB
2023-05-07 20:26:59,189 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:26:59,189 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:26:59,194 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:26:59,258 : [2/3] TRAINING : Current maximum residual: 6.46925918, relative Frobenius norm squared: 0.09882737
2023-05-07 20:26:59,259 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:27:00,377 : [2/3] TRAINING : Execution of _umr_scan took at 1.119 seconds.
2023-05-07 20:27:00,443 : [2/3] TRAINING : Current maximum residual: 2.02292033, relative Frobenius norm squared: 0.06628255
2023-05-07 20:27:00,443 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:27:12,074 : [2/3] TRAINING : Execution of _umr_scan took at 11.631 seconds.
2023-05-07 20:27:12,151 : [2/3] TRAINING : Current maximum residual: 0.66829989, relative Frobenius norm squared: 0.00464603
2023-05-07 20:27:12,151 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 20:27:34,382 : [2/3] TRAINING : Execution of _umr_scan took at 22.231 seconds.
2023-05-07 20:27:34,443 : [2/3] TRAINING : Current maximum residual: 0.51465612, relative Frobenius norm squared: 0.00101605
2023-05-07 20:27:34,443 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 20:27:56,656 : [2/3] TRAINING : Execution of _umr_scan took at 22.213 seconds.
2023-05-07 20:27:56,714 : [2/3] TRAINING : Current maximum residual: 0.41115296, relative Frobenius norm squared: 0.00066946
2023-05-07 20:27:56,714 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:27:56,729 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.016 seconds.
2023-05-07 20:27:56,787 : [2/3] TRAINING : Current maximum residual: 0.25192782, relative Frobenius norm squared: 0.00065608
2023-05-07 20:27:56,787 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:27:56,805 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.018 seconds.
2023-05-07 20:27:56,876 : [2/3] TRAINING : Current maximum residual: 0.24980678, relative Frobenius norm squared: 0.00065389
2023-05-07 20:27:56,876 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:27:56,895 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:27:56,963 : [2/3] TRAINING : Current maximum residual: 0.24925603, relative Frobenius norm squared: 0.00065286
2023-05-07 20:27:56,963 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:27:56,980 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.017 seconds.
2023-05-07 20:27:57,044 : [2/3] TRAINING : Current maximum residual: 0.24917641, relative Frobenius norm squared: 0.00065177
2023-05-07 20:27:57,044 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:27:57,064 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:27:57,121 : [2/3] TRAINING : Current maximum residual: 0.24911609, relative Frobenius norm squared: 0.00065158
2023-05-07 20:27:57,121 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:27:57,141 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:27:57,199 : [2/3] TRAINING : Current maximum residual: 0.24909780, relative Frobenius norm squared: 0.00065146
2023-05-07 20:27:57,199 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:27:57,220 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:27:57,289 : [2/3] TRAINING : Current maximum residual: 0.24909298, relative Frobenius norm squared: 0.00065129
2023-05-07 20:27:57,289 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:27:57,308 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:27:57,377 : [2/3] TRAINING : Current maximum residual: 0.24909215, relative Frobenius norm squared: 0.00065124
2023-05-07 20:27:57,377 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:27:57,399 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:27:57,463 : [2/3] TRAINING : Current maximum residual: 0.24909228, relative Frobenius norm squared: 0.00065118
2023-05-07 20:27:57,463 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:27:57,484 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:27:57,542 : [2/3] TRAINING : Current maximum residual: 0.24909253, relative Frobenius norm squared: 0.00065115
2023-05-07 20:27:57,542 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 20:27:57,562 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.020 seconds.
2023-05-07 20:27:57,620 : [2/3] TRAINING : Current maximum residual: 0.24909271, relative Frobenius norm squared: 0.00065096
2023-05-07 20:27:57,620 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 20:27:57,642 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:27:57,711 : [2/3] TRAINING : Current maximum residual: 0.24909282, relative Frobenius norm squared: 0.00065089
2023-05-07 20:27:57,711 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 20:27:57,732 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:27:57,800 : [2/3] TRAINING : Current maximum residual: 0.24909287, relative Frobenius norm squared: 0.00065083
2023-05-07 20:27:57,800 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 20:27:57,823 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.023 seconds.
2023-05-07 20:27:57,888 : [2/3] TRAINING : Current maximum residual: 0.24909290, relative Frobenius norm squared: 0.00065078
2023-05-07 20:27:57,888 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 20:27:57,909 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:27:57,966 : [2/3] TRAINING : Current maximum residual: 0.24909291, relative Frobenius norm squared: 0.00065073
2023-05-07 20:27:57,967 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 20:27:57,988 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.021 seconds.
2023-05-07 20:27:58,045 : [2/3] TRAINING : Current maximum residual: 0.24909292, relative Frobenius norm squared: 0.00065067
2023-05-07 20:27:58,045 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 20:27:58,067 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:27:58,124 : [2/3] TRAINING : Current maximum residual: 0.24909292, relative Frobenius norm squared: 0.00065051
2023-05-07 20:27:58,124 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 20:27:58,147 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:27:58,204 : [2/3] TRAINING : Current maximum residual: 0.24909292, relative Frobenius norm squared: 0.00065050
2023-05-07 20:27:58,204 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 20:27:58,223 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.019 seconds.
2023-05-07 20:27:58,281 : [2/3] TRAINING : Current maximum residual: 0.24909292, relative Frobenius norm squared: 0.00065049
2023-05-07 20:27:58,281 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 20:27:58,303 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.022 seconds.
2023-05-07 20:27:58,363 : [2/3] TRAINING : Current maximum residual: 0.24909292, relative Frobenius norm squared: 0.00065026
2023-05-07 20:27:58,378 : [2/3] TRAINING : Execution of ainv_L took at 59.189 seconds.
2023-05-07 20:27:58,378 : [2/3] TRAINING : nnz of L_inv: 846249, size: 10.320 MB
2023-05-07 20:27:58,378 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:27:58,385 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:27:58,390 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:27:58,837 : [2/3] TRAINING : Execution of _construct_weights took at 174.906 seconds.
2023-05-07 20:27:58,838 : [2/3] TRAINING : Model: SANSA, number of weights: 1692498, weights size: 19.683 MB
2023-05-07 20:27:58,838 : [2/3] TRAINING : Execution of _get_model took at 176.948 seconds.
2023-05-07 20:27:58,838 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:27:58,898 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:27:59,058 : [3/3] EVALUATION : Execution of _matmat took at 0.160 seconds.
2023-05-07 20:27:59,591 : [3/3] EVALUATION : Execution of _predict took at 0.696 seconds.
2023-05-07 20:28:00,392 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:28:00,450 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:00,607 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:28:01,122 : [3/3] EVALUATION : Execution of _predict took at 0.675 seconds.
2023-05-07 20:28:01,906 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:28:01,965 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:02,123 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:02,680 : [3/3] EVALUATION : Execution of _predict took at 0.718 seconds.
2023-05-07 20:28:03,477 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:28:03,534 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:03,692 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:04,241 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 20:28:05,036 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:28:05,095 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:05,253 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:05,798 : [3/3] EVALUATION : Execution of _predict took at 0.706 seconds.
2023-05-07 20:28:06,590 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:28:06,650 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:06,808 : [3/3] EVALUATION : Execution of _matmat took at 0.159 seconds.
2023-05-07 20:28:07,349 : [3/3] EVALUATION : Execution of _predict took at 0.702 seconds.
2023-05-07 20:28:08,144 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:28:08,203 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:08,363 : [3/3] EVALUATION : Execution of _matmat took at 0.160 seconds.
2023-05-07 20:28:08,894 : [3/3] EVALUATION : Execution of _predict took at 0.695 seconds.
2023-05-07 20:28:09,684 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:28:09,742 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:09,899 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:28:10,422 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 20:28:11,208 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:28:11,267 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:11,428 : [3/3] EVALUATION : Execution of _matmat took at 0.161 seconds.
2023-05-07 20:28:11,973 : [3/3] EVALUATION : Execution of _predict took at 0.709 seconds.
2023-05-07 20:28:12,768 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:28:12,825 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:12,982 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:13,499 : [3/3] EVALUATION : Execution of _predict took at 0.678 seconds.
2023-05-07 20:28:14,288 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:28:14,346 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:14,504 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:28:15,025 : [3/3] EVALUATION : Execution of _predict took at 0.682 seconds.
2023-05-07 20:28:15,809 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:28:15,867 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:16,025 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:16,592 : [3/3] EVALUATION : Execution of _predict took at 0.729 seconds.
2023-05-07 20:28:17,384 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:28:17,442 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:17,600 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:18,152 : [3/3] EVALUATION : Execution of _predict took at 0.713 seconds.
2023-05-07 20:28:18,948 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:28:19,006 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:19,164 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:19,695 : [3/3] EVALUATION : Execution of _predict took at 0.693 seconds.
2023-05-07 20:28:20,486 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:28:20,544 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:20,703 : [3/3] EVALUATION : Execution of _matmat took at 0.159 seconds.
2023-05-07 20:28:21,225 : [3/3] EVALUATION : Execution of _predict took at 0.684 seconds.
2023-05-07 20:28:22,013 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:28:22,069 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:22,227 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:22,766 : [3/3] EVALUATION : Execution of _predict took at 0.699 seconds.
2023-05-07 20:28:23,556 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:28:23,615 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:23,777 : [3/3] EVALUATION : Execution of _matmat took at 0.162 seconds.
2023-05-07 20:28:24,337 : [3/3] EVALUATION : Execution of _predict took at 0.726 seconds.
2023-05-07 20:28:25,138 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:28:25,195 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:25,353 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:28:25,902 : [3/3] EVALUATION : Execution of _predict took at 0.710 seconds.
2023-05-07 20:28:26,692 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:28:26,750 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:26,906 : [3/3] EVALUATION : Execution of _matmat took at 0.156 seconds.
2023-05-07 20:28:27,439 : [3/3] EVALUATION : Execution of _predict took at 0.692 seconds.
2023-05-07 20:28:28,226 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:28:28,283 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:28,440 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:28:28,966 : [3/3] EVALUATION : Execution of _predict took at 0.686 seconds.
2023-05-07 20:28:29,749 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:28:29,808 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:29,967 : [3/3] EVALUATION : Execution of _matmat took at 0.159 seconds.
2023-05-07 20:28:30,518 : [3/3] EVALUATION : Execution of _predict took at 0.713 seconds.
2023-05-07 20:28:31,313 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:28:31,369 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:31,529 : [3/3] EVALUATION : Execution of _matmat took at 0.160 seconds.
2023-05-07 20:28:32,067 : [3/3] EVALUATION : Execution of _predict took at 0.701 seconds.
2023-05-07 20:28:32,861 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:28:32,919 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:33,077 : [3/3] EVALUATION : Execution of _matmat took at 0.158 seconds.
2023-05-07 20:28:33,605 : [3/3] EVALUATION : Execution of _predict took at 0.690 seconds.
2023-05-07 20:28:34,399 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:28:34,456 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:34,613 : [3/3] EVALUATION : Execution of _matmat took at 0.157 seconds.
2023-05-07 20:28:35,140 : [3/3] EVALUATION : Execution of _predict took at 0.687 seconds.
2023-05-07 20:28:35,931 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:28:35,989 : [3/3] EVALUATION : Execution of _matmat took at 0.003 seconds.
2023-05-07 20:28:36,148 : [3/3] EVALUATION : Execution of _matmat took at 0.159 seconds.
2023-05-07 20:28:36,703 : [3/3] EVALUATION : Execution of _predict took at 0.717 seconds.
2023-05-07 20:28:37,725 : [3/3] EVALUATION : Execution of _evaluate_model took at 38.887 seconds.
2023-05-07 20:28:37,726 : PIPELINE END : Execution of run took at 217.806 seconds.
d=0.0025, ns=0, nf=0


2023-05-07 20:28:37,759 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:28:37,759 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:28:38,962 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.203 seconds.
2023-05-07 20:28:39,298 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:28:39,758 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:28:39,771 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.012 seconds.
2023-05-07 20:28:39,771 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:28:39,771 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:28:39,771 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:28:39,771 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:28:41,831 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:28:41,831 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:30:32,010 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:30:32,010 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:30:40,566 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:30:40,566 : [2/3] TRAINING : Execution of ldlt took at 118.735 seconds.
2023-05-07 20:30:40,567 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:30:40,567 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:30:40,567 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:30:40,607 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:30:41,230 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:30:41,304 : [2/3] TRAINING : Execution of ainv_L took at 0.738 seconds.
2023-05-07 20:30:41,304 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:30:41,304 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:30:41,340 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:30:41,377 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:30:41,903 : [2/3] TRAINING : Execution of _construct_weights took at 120.072 seconds.
2023-05-07 20:30:41,904 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:30:41,904 : [2/3] TRAINING : Execution of _get_model took at 122.134 seconds.
2023-05-07 20:30:41,905 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:30:41,980 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:30:42,868 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 20:30:44,164 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 20:30:45,325 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:30:45,399 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:30:46,274 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 20:30:47,541 : [3/3] EVALUATION : Execution of _predict took at 2.160 seconds.
2023-05-07 20:30:48,693 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:30:48,770 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:30:49,665 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 20:30:51,007 : [3/3] EVALUATION : Execution of _predict took at 2.258 seconds.
2023-05-07 20:30:52,156 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:30:52,231 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:30:53,118 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 20:30:54,444 : [3/3] EVALUATION : Execution of _predict took at 2.233 seconds.
2023-05-07 20:30:55,598 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:30:55,673 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:30:56,569 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 20:30:57,888 : [3/3] EVALUATION : Execution of _predict took at 2.235 seconds.
2023-05-07 20:30:59,042 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:30:59,117 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:30:59,995 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:31:01,308 : [3/3] EVALUATION : Execution of _predict took at 2.210 seconds.
2023-05-07 20:31:02,465 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:31:02,540 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:31:03,447 : [3/3] EVALUATION : Execution of _matmat took at 0.908 seconds.
2023-05-07 20:31:04,749 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 20:31:05,898 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:31:05,972 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:31:06,850 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:31:08,134 : [3/3] EVALUATION : Execution of _predict took at 2.182 seconds.
2023-05-07 20:31:09,287 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:31:09,362 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:31:10,262 : [3/3] EVALUATION : Execution of _matmat took at 0.900 seconds.
2023-05-07 20:31:11,576 : [3/3] EVALUATION : Execution of _predict took at 2.234 seconds.
2023-05-07 20:31:12,730 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:31:12,803 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:31:13,688 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 20:31:14,960 : [3/3] EVALUATION : Execution of _predict took at 2.176 seconds.
2023-05-07 20:31:16,107 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:31:16,178 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:17,070 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 20:31:18,344 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 20:31:19,494 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:31:19,566 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:31:20,443 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 20:31:21,802 : [3/3] EVALUATION : Execution of _predict took at 2.254 seconds.
2023-05-07 20:31:22,952 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:31:23,023 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:23,919 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 20:31:25,247 : [3/3] EVALUATION : Execution of _predict took at 2.241 seconds.
2023-05-07 20:31:26,404 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:31:26,474 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:27,359 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 20:31:28,650 : [3/3] EVALUATION : Execution of _predict took at 2.192 seconds.
2023-05-07 20:31:29,806 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:31:29,878 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:30,750 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 20:31:32,026 : [3/3] EVALUATION : Execution of _predict took at 2.165 seconds.
2023-05-07 20:31:33,172 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:31:33,242 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:34,130 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 20:31:35,443 : [3/3] EVALUATION : Execution of _predict took at 2.217 seconds.
2023-05-07 20:31:36,596 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:31:36,668 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:37,558 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 20:31:38,902 : [3/3] EVALUATION : Execution of _predict took at 2.251 seconds.
2023-05-07 20:31:40,064 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:31:40,136 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:41,031 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 20:31:42,353 : [3/3] EVALUATION : Execution of _predict took at 2.235 seconds.
2023-05-07 20:31:43,512 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:31:43,583 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:31:44,478 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 20:31:45,777 : [3/3] EVALUATION : Execution of _predict took at 2.210 seconds.
2023-05-07 20:31:46,928 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:31:46,999 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:47,890 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 20:31:49,165 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 20:31:50,299 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:31:50,371 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:51,273 : [3/3] EVALUATION : Execution of _matmat took at 0.902 seconds.
2023-05-07 20:31:52,603 : [3/3] EVALUATION : Execution of _predict took at 2.250 seconds.
2023-05-07 20:31:53,757 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:31:53,828 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:31:54,701 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 20:31:56,001 : [3/3] EVALUATION : Execution of _predict took at 2.191 seconds.
2023-05-07 20:31:57,146 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:31:57,217 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:31:58,099 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 20:31:59,386 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 20:32:00,542 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:32:00,605 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:32:01,489 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 20:32:02,771 : [3/3] EVALUATION : Execution of _predict took at 2.176 seconds.
2023-05-07 20:32:03,927 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:32:03,998 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:32:04,882 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 20:32:06,225 : [3/3] EVALUATION : Execution of _predict took at 2.244 seconds.
2023-05-07 20:32:07,617 : [3/3] EVALUATION : Execution of _evaluate_model took at 85.712 seconds.
2023-05-07 20:32:07,617 : PIPELINE END : Execution of run took at 209.858 seconds.
d=0.0025, ns=0, nf=5


2023-05-07 20:32:07,652 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:32:07,652 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:32:08,850 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.198 seconds.
2023-05-07 20:32:09,184 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:32:09,643 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:32:09,656 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.004 seconds.
2023-05-07 20:32:09,656 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:32:09,656 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:32:09,656 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:32:09,656 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:32:11,756 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:32:11,757 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:34:01,998 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:34:01,998 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:34:10,574 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:34:10,574 : [2/3] TRAINING : Execution of ldlt took at 118.818 seconds.
2023-05-07 20:34:10,574 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:34:10,574 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:34:10,574 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:34:10,615 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:34:11,237 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:34:11,237 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:34:11,421 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.183 seconds.
2023-05-07 20:34:12,051 : [2/3] TRAINING : Current maximum residual: 2.58861749, relative Frobenius norm squared: 0.09843970
2023-05-07 20:34:12,051 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:34:12,219 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.168 seconds.
2023-05-07 20:34:12,852 : [2/3] TRAINING : Current maximum residual: 2.11069200, relative Frobenius norm squared: 0.08524204
2023-05-07 20:34:12,852 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:34:13,015 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.163 seconds.
2023-05-07 20:34:13,640 : [2/3] TRAINING : Current maximum residual: 1.83859416, relative Frobenius norm squared: 0.07613941
2023-05-07 20:34:13,640 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:34:13,787 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.146 seconds.
2023-05-07 20:34:14,409 : [2/3] TRAINING : Current maximum residual: 1.65628561, relative Frobenius norm squared: 0.06895198
2023-05-07 20:34:14,410 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:34:14,543 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.133 seconds.
2023-05-07 20:34:15,169 : [2/3] TRAINING : Current maximum residual: 1.51435222, relative Frobenius norm squared: 0.06312496
2023-05-07 20:34:15,235 : [2/3] TRAINING : Execution of ainv_L took at 4.660 seconds.
2023-05-07 20:34:15,235 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:34:15,235 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:34:15,283 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:34:15,320 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:34:15,843 : [2/3] TRAINING : Execution of _construct_weights took at 124.086 seconds.
2023-05-07 20:34:15,844 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:34:15,844 : [2/3] TRAINING : Execution of _get_model took at 126.188 seconds.
2023-05-07 20:34:15,844 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:34:15,920 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:34:16,812 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 20:34:18,109 : [3/3] EVALUATION : Execution of _predict took at 2.209 seconds.
2023-05-07 20:34:19,159 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:34:19,231 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:34:20,111 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 20:34:21,378 : [3/3] EVALUATION : Execution of _predict took at 2.165 seconds.
2023-05-07 20:34:22,420 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:34:22,494 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:34:23,392 : [3/3] EVALUATION : Execution of _matmat took at 0.898 seconds.
2023-05-07 20:34:24,728 : [3/3] EVALUATION : Execution of _predict took at 2.252 seconds.
2023-05-07 20:34:25,772 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:34:25,844 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:34:26,739 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 20:34:28,064 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 20:34:29,110 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:34:29,183 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:34:30,084 : [3/3] EVALUATION : Execution of _matmat took at 0.900 seconds.
2023-05-07 20:34:31,404 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 20:34:32,437 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:34:32,510 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:34:33,399 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 20:34:34,711 : [3/3] EVALUATION : Execution of _predict took at 2.218 seconds.
2023-05-07 20:34:35,747 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:34:35,819 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:34:36,732 : [3/3] EVALUATION : Execution of _matmat took at 0.913 seconds.
2023-05-07 20:34:38,034 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 20:34:39,066 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:34:39,129 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:34:40,010 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:34:41,295 : [3/3] EVALUATION : Execution of _predict took at 2.174 seconds.
2023-05-07 20:34:42,332 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:34:42,404 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:34:43,312 : [3/3] EVALUATION : Execution of _matmat took at 0.907 seconds.
2023-05-07 20:34:44,625 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 20:34:45,666 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:34:45,728 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:34:46,620 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:34:47,892 : [3/3] EVALUATION : Execution of _predict took at 2.172 seconds.
2023-05-07 20:34:48,932 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:34:48,996 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:34:49,899 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 20:34:51,172 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 20:34:52,197 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:34:52,270 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:34:53,160 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:34:54,521 : [3/3] EVALUATION : Execution of _predict took at 2.269 seconds.
2023-05-07 20:34:55,564 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:34:55,636 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:34:56,540 : [3/3] EVALUATION : Execution of _matmat took at 0.904 seconds.
2023-05-07 20:34:57,869 : [3/3] EVALUATION : Execution of _predict took at 2.251 seconds.
2023-05-07 20:34:58,911 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:34:58,982 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:34:59,875 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:35:01,165 : [3/3] EVALUATION : Execution of _predict took at 2.199 seconds.
2023-05-07 20:35:02,210 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:35:02,282 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:03,159 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 20:35:04,435 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 20:35:05,480 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:35:05,551 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:06,447 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 20:35:07,761 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 20:35:08,806 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:35:08,879 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:09,775 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 20:35:11,117 : [3/3] EVALUATION : Execution of _predict took at 2.255 seconds.
2023-05-07 20:35:12,158 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:35:12,230 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:13,134 : [3/3] EVALUATION : Execution of _matmat took at 0.904 seconds.
2023-05-07 20:35:14,458 : [3/3] EVALUATION : Execution of _predict took at 2.245 seconds.
2023-05-07 20:35:15,501 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:35:15,564 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:35:16,468 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 20:35:17,768 : [3/3] EVALUATION : Execution of _predict took at 2.212 seconds.
2023-05-07 20:35:18,805 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:35:18,876 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:35:19,777 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 20:35:21,052 : [3/3] EVALUATION : Execution of _predict took at 2.192 seconds.
2023-05-07 20:35:22,073 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:35:22,146 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:23,060 : [3/3] EVALUATION : Execution of _matmat took at 0.914 seconds.
2023-05-07 20:35:24,389 : [3/3] EVALUATION : Execution of _predict took at 2.261 seconds.
2023-05-07 20:35:25,430 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:35:25,500 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:26,383 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 20:35:27,682 : [3/3] EVALUATION : Execution of _predict took at 2.198 seconds.
2023-05-07 20:35:28,718 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:35:28,790 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:29,680 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:35:30,969 : [3/3] EVALUATION : Execution of _predict took at 2.196 seconds.
2023-05-07 20:35:32,015 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:35:32,077 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:35:33,010 : [3/3] EVALUATION : Execution of _matmat took at 0.933 seconds.
2023-05-07 20:35:34,294 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 20:35:35,334 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:35:35,405 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:35:36,297 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:35:37,641 : [3/3] EVALUATION : Execution of _predict took at 2.253 seconds.
2023-05-07 20:35:38,913 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.069 seconds.
2023-05-07 20:35:38,914 : PIPELINE END : Execution of run took at 211.262 seconds.
d=0.0025, ns=0, nf=10


2023-05-07 20:35:38,949 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:35:38,949 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:35:40,149 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.200 seconds.
2023-05-07 20:35:40,484 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:35:40,944 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:35:40,957 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.008 seconds.
2023-05-07 20:35:40,957 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:35:40,957 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:35:40,957 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:35:40,957 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:35:43,062 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:35:43,062 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:37:33,139 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:37:33,139 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:37:41,681 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:37:41,682 : [2/3] TRAINING : Execution of ldlt took at 118.620 seconds.
2023-05-07 20:37:41,682 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:37:41,682 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:37:41,682 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:37:41,722 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:37:42,343 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:37:42,344 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:37:42,527 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.183 seconds.
2023-05-07 20:37:43,156 : [2/3] TRAINING : Current maximum residual: 2.58861749, relative Frobenius norm squared: 0.09843970
2023-05-07 20:37:43,157 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:37:43,324 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.168 seconds.
2023-05-07 20:37:43,961 : [2/3] TRAINING : Current maximum residual: 2.11069200, relative Frobenius norm squared: 0.08524204
2023-05-07 20:37:43,961 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:37:44,124 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.163 seconds.
2023-05-07 20:37:44,750 : [2/3] TRAINING : Current maximum residual: 1.83859416, relative Frobenius norm squared: 0.07613941
2023-05-07 20:37:44,750 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:37:44,895 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.145 seconds.
2023-05-07 20:37:45,516 : [2/3] TRAINING : Current maximum residual: 1.65628561, relative Frobenius norm squared: 0.06895198
2023-05-07 20:37:45,517 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:37:45,651 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.134 seconds.
2023-05-07 20:37:46,276 : [2/3] TRAINING : Current maximum residual: 1.51435222, relative Frobenius norm squared: 0.06312496
2023-05-07 20:37:46,276 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:37:46,401 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.125 seconds.
2023-05-07 20:37:47,027 : [2/3] TRAINING : Current maximum residual: 1.39573156, relative Frobenius norm squared: 0.05817897
2023-05-07 20:37:47,027 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:37:47,170 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.143 seconds.
2023-05-07 20:37:47,790 : [2/3] TRAINING : Current maximum residual: 1.30146497, relative Frobenius norm squared: 0.05402372
2023-05-07 20:37:47,790 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:37:47,906 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.116 seconds.
2023-05-07 20:37:48,531 : [2/3] TRAINING : Current maximum residual: 1.21978793, relative Frobenius norm squared: 0.05036413
2023-05-07 20:37:48,531 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:37:48,661 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.130 seconds.
2023-05-07 20:37:49,289 : [2/3] TRAINING : Current maximum residual: 1.15357925, relative Frobenius norm squared: 0.04712626
2023-05-07 20:37:49,289 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:37:49,420 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.131 seconds.
2023-05-07 20:37:50,049 : [2/3] TRAINING : Current maximum residual: 1.08516144, relative Frobenius norm squared: 0.04426377
2023-05-07 20:37:50,114 : [2/3] TRAINING : Execution of ainv_L took at 8.433 seconds.
2023-05-07 20:37:50,114 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:37:50,114 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:37:50,150 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:37:50,185 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:37:50,711 : [2/3] TRAINING : Execution of _construct_weights took at 127.649 seconds.
2023-05-07 20:37:50,712 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:37:50,712 : [2/3] TRAINING : Execution of _get_model took at 129.755 seconds.
2023-05-07 20:37:50,712 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:37:50,796 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:37:51,686 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:37:52,982 : [3/3] EVALUATION : Execution of _predict took at 2.211 seconds.
2023-05-07 20:37:54,034 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:37:54,110 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:37:54,991 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:37:56,262 : [3/3] EVALUATION : Execution of _predict took at 2.173 seconds.
2023-05-07 20:37:57,297 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:37:57,376 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:37:58,271 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 20:37:59,617 : [3/3] EVALUATION : Execution of _predict took at 2.265 seconds.
2023-05-07 20:38:00,662 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:38:00,736 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:38:01,628 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:38:02,955 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 20:38:04,007 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:38:04,082 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:38:04,986 : [3/3] EVALUATION : Execution of _matmat took at 0.904 seconds.
2023-05-07 20:38:06,307 : [3/3] EVALUATION : Execution of _predict took at 2.244 seconds.
2023-05-07 20:38:07,344 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:38:07,419 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:38:08,297 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:38:09,610 : [3/3] EVALUATION : Execution of _predict took at 2.210 seconds.
2023-05-07 20:38:10,654 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:38:10,729 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:38:11,632 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 20:38:12,937 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 20:38:13,978 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:38:14,052 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:38:14,914 : [3/3] EVALUATION : Execution of _matmat took at 0.862 seconds.
2023-05-07 20:38:16,203 : [3/3] EVALUATION : Execution of _predict took at 2.171 seconds.
2023-05-07 20:38:17,246 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:38:17,324 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 20:38:18,217 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 20:38:19,531 : [3/3] EVALUATION : Execution of _predict took at 2.230 seconds.
2023-05-07 20:38:20,583 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:38:20,657 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:38:21,533 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 20:38:22,807 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 20:38:23,854 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:38:23,931 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 20:38:24,814 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:38:26,092 : [3/3] EVALUATION : Execution of _predict took at 2.184 seconds.
2023-05-07 20:38:27,124 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:38:27,201 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 20:38:28,069 : [3/3] EVALUATION : Execution of _matmat took at 0.868 seconds.
2023-05-07 20:38:29,429 : [3/3] EVALUATION : Execution of _predict took at 2.251 seconds.
2023-05-07 20:38:30,477 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:38:30,551 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:38:31,438 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 20:38:32,766 : [3/3] EVALUATION : Execution of _predict took at 2.235 seconds.
2023-05-07 20:38:33,812 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:38:33,884 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:38:34,756 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 20:38:36,047 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 20:38:37,087 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:38:37,159 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:38:38,019 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 20:38:39,286 : [3/3] EVALUATION : Execution of _predict took at 2.145 seconds.
2023-05-07 20:38:40,328 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:38:40,399 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:38:41,275 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 20:38:42,588 : [3/3] EVALUATION : Execution of _predict took at 2.208 seconds.
2023-05-07 20:38:43,633 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:38:43,706 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:38:44,584 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 20:38:45,928 : [3/3] EVALUATION : Execution of _predict took at 2.240 seconds.
2023-05-07 20:38:46,978 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:38:47,050 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:38:47,932 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 20:38:49,256 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 20:38:50,303 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:38:50,378 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:38:51,260 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:38:52,563 : [3/3] EVALUATION : Execution of _predict took at 2.205 seconds.
2023-05-07 20:38:53,603 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:38:53,678 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:38:54,567 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 20:38:55,844 : [3/3] EVALUATION : Execution of _predict took at 2.187 seconds.
2023-05-07 20:38:56,869 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:38:56,947 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 20:38:57,849 : [3/3] EVALUATION : Execution of _matmat took at 0.902 seconds.
2023-05-07 20:38:59,178 : [3/3] EVALUATION : Execution of _predict took at 2.254 seconds.
2023-05-07 20:39:00,222 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:39:00,293 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:39:01,156 : [3/3] EVALUATION : Execution of _matmat took at 0.862 seconds.
2023-05-07 20:39:02,455 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 20:39:03,500 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:39:03,573 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:39:04,444 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 20:39:05,732 : [3/3] EVALUATION : Execution of _predict took at 2.178 seconds.
2023-05-07 20:39:06,784 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:39:06,857 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:39:07,726 : [3/3] EVALUATION : Execution of _matmat took at 0.868 seconds.
2023-05-07 20:39:09,012 : [3/3] EVALUATION : Execution of _predict took at 2.175 seconds.
2023-05-07 20:39:10,052 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:39:10,129 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:39:11,004 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 20:39:12,350 : [3/3] EVALUATION : Execution of _predict took at 2.244 seconds.
2023-05-07 20:39:13,610 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.898 seconds.
2023-05-07 20:39:13,611 : PIPELINE END : Execution of run took at 214.662 seconds.
d=0.0025, ns=0, nf=20


2023-05-07 20:39:13,645 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:39:13,646 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:39:14,812 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.166 seconds.
2023-05-07 20:39:15,132 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:39:15,580 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:39:15,593 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.947 seconds.
2023-05-07 20:39:15,593 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:39:15,593 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:39:15,593 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:39:15,593 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:39:17,610 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:39:17,610 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:41:03,474 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:41:03,474 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:41:11,858 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:41:11,858 : [2/3] TRAINING : Execution of ldlt took at 114.248 seconds.
2023-05-07 20:41:11,858 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:41:11,858 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:41:11,858 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:41:11,896 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:41:12,495 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:41:12,495 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:41:12,677 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.181 seconds.
2023-05-07 20:41:13,283 : [2/3] TRAINING : Current maximum residual: 2.58861749, relative Frobenius norm squared: 0.09843970
2023-05-07 20:41:13,283 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:41:13,447 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.164 seconds.
2023-05-07 20:41:14,055 : [2/3] TRAINING : Current maximum residual: 2.11069200, relative Frobenius norm squared: 0.08524204
2023-05-07 20:41:14,055 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:41:14,215 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.160 seconds.
2023-05-07 20:41:14,817 : [2/3] TRAINING : Current maximum residual: 1.83859416, relative Frobenius norm squared: 0.07613941
2023-05-07 20:41:14,817 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:41:14,959 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.142 seconds.
2023-05-07 20:41:15,556 : [2/3] TRAINING : Current maximum residual: 1.65628561, relative Frobenius norm squared: 0.06895198
2023-05-07 20:41:15,556 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:41:15,688 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.131 seconds.
2023-05-07 20:41:16,288 : [2/3] TRAINING : Current maximum residual: 1.51435222, relative Frobenius norm squared: 0.06312496
2023-05-07 20:41:16,288 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:41:16,410 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.122 seconds.
2023-05-07 20:41:17,011 : [2/3] TRAINING : Current maximum residual: 1.39573156, relative Frobenius norm squared: 0.05817897
2023-05-07 20:41:17,011 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:41:17,152 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.141 seconds.
2023-05-07 20:41:17,749 : [2/3] TRAINING : Current maximum residual: 1.30146497, relative Frobenius norm squared: 0.05402372
2023-05-07 20:41:17,749 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:41:17,862 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.113 seconds.
2023-05-07 20:41:18,461 : [2/3] TRAINING : Current maximum residual: 1.21978793, relative Frobenius norm squared: 0.05036413
2023-05-07 20:41:18,461 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:41:18,587 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.127 seconds.
2023-05-07 20:41:19,190 : [2/3] TRAINING : Current maximum residual: 1.15357925, relative Frobenius norm squared: 0.04712626
2023-05-07 20:41:19,191 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:41:19,318 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.127 seconds.
2023-05-07 20:41:19,922 : [2/3] TRAINING : Current maximum residual: 1.08516144, relative Frobenius norm squared: 0.04426377
2023-05-07 20:41:19,922 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 20:41:20,048 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.126 seconds.
2023-05-07 20:41:20,644 : [2/3] TRAINING : Current maximum residual: 1.04117228, relative Frobenius norm squared: 0.04169058
2023-05-07 20:41:20,644 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 20:41:20,778 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.133 seconds.
2023-05-07 20:41:21,380 : [2/3] TRAINING : Current maximum residual: 0.98204331, relative Frobenius norm squared: 0.03937666
2023-05-07 20:41:21,380 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 20:41:21,505 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.125 seconds.
2023-05-07 20:41:22,118 : [2/3] TRAINING : Current maximum residual: 0.94972519, relative Frobenius norm squared: 0.03725436
2023-05-07 20:41:22,119 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 20:41:22,235 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.116 seconds.
2023-05-07 20:41:22,839 : [2/3] TRAINING : Current maximum residual: 0.90828762, relative Frobenius norm squared: 0.03531652
2023-05-07 20:41:22,839 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 20:41:22,977 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.138 seconds.
2023-05-07 20:41:23,592 : [2/3] TRAINING : Current maximum residual: 0.87539271, relative Frobenius norm squared: 0.03352982
2023-05-07 20:41:23,592 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 20:41:23,738 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.146 seconds.
2023-05-07 20:41:24,343 : [2/3] TRAINING : Current maximum residual: 0.84290986, relative Frobenius norm squared: 0.03190848
2023-05-07 20:41:24,343 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 20:41:24,444 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.101 seconds.
2023-05-07 20:41:25,042 : [2/3] TRAINING : Current maximum residual: 0.80676523, relative Frobenius norm squared: 0.03043313
2023-05-07 20:41:25,042 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 20:41:25,167 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.125 seconds.
2023-05-07 20:41:25,777 : [2/3] TRAINING : Current maximum residual: 0.77469039, relative Frobenius norm squared: 0.02906563
2023-05-07 20:41:25,777 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 20:41:25,891 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.114 seconds.
2023-05-07 20:41:26,491 : [2/3] TRAINING : Current maximum residual: 0.74977298, relative Frobenius norm squared: 0.02777082
2023-05-07 20:41:26,491 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 20:41:26,595 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.104 seconds.
2023-05-07 20:41:27,196 : [2/3] TRAINING : Current maximum residual: 0.72189231, relative Frobenius norm squared: 0.02660011
2023-05-07 20:41:27,262 : [2/3] TRAINING : Execution of ainv_L took at 15.404 seconds.
2023-05-07 20:41:27,262 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:41:27,262 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:41:27,303 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:41:27,338 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:41:27,852 : [2/3] TRAINING : Execution of _construct_weights took at 130.243 seconds.
2023-05-07 20:41:27,853 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:41:27,854 : [2/3] TRAINING : Execution of _get_model took at 132.261 seconds.
2023-05-07 20:41:27,854 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:41:27,928 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:41:28,803 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 20:41:30,101 : [3/3] EVALUATION : Execution of _predict took at 2.191 seconds.
2023-05-07 20:41:31,162 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:41:31,232 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:41:32,094 : [3/3] EVALUATION : Execution of _matmat took at 0.862 seconds.
2023-05-07 20:41:33,362 : [3/3] EVALUATION : Execution of _predict took at 2.145 seconds.
2023-05-07 20:41:34,404 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:41:34,476 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:41:35,354 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:41:36,699 : [3/3] EVALUATION : Execution of _predict took at 2.239 seconds.
2023-05-07 20:41:37,744 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:41:37,814 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:41:38,688 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 20:41:40,015 : [3/3] EVALUATION : Execution of _predict took at 2.217 seconds.
2023-05-07 20:41:41,067 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:41:41,138 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:41:42,020 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 20:41:43,341 : [3/3] EVALUATION : Execution of _predict took at 2.220 seconds.
2023-05-07 20:41:44,386 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:41:44,457 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:41:45,328 : [3/3] EVALUATION : Execution of _matmat took at 0.871 seconds.
2023-05-07 20:41:46,640 : [3/3] EVALUATION : Execution of _predict took at 2.200 seconds.
2023-05-07 20:41:47,694 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:41:47,756 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:41:48,650 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 20:41:49,953 : [3/3] EVALUATION : Execution of _predict took at 2.205 seconds.
2023-05-07 20:41:50,988 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:41:51,050 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 20:41:51,908 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 20:41:53,193 : [3/3] EVALUATION : Execution of _predict took at 2.151 seconds.
2023-05-07 20:41:54,240 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:41:54,311 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:41:55,201 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:41:56,516 : [3/3] EVALUATION : Execution of _predict took at 2.221 seconds.
2023-05-07 20:41:57,572 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:41:57,633 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 20:41:58,512 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 20:41:59,784 : [3/3] EVALUATION : Execution of _predict took at 2.159 seconds.
2023-05-07 20:42:00,836 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:42:00,899 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 20:42:01,785 : [3/3] EVALUATION : Execution of _matmat took at 0.886 seconds.
2023-05-07 20:42:03,060 : [3/3] EVALUATION : Execution of _predict took at 2.169 seconds.
2023-05-07 20:42:04,105 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:42:04,176 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:42:05,044 : [3/3] EVALUATION : Execution of _matmat took at 0.868 seconds.
2023-05-07 20:42:06,404 : [3/3] EVALUATION : Execution of _predict took at 2.245 seconds.
2023-05-07 20:42:07,466 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:42:07,536 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:42:08,417 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:42:09,746 : [3/3] EVALUATION : Execution of _predict took at 2.226 seconds.
2023-05-07 20:42:10,799 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:42:10,861 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:42:11,731 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 20:42:13,022 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 20:42:14,074 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:42:14,146 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:42:15,003 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 20:42:16,279 : [3/3] EVALUATION : Execution of _predict took at 2.151 seconds.
2023-05-07 20:42:17,327 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:42:17,396 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:42:18,268 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 20:42:19,583 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 20:42:20,633 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:42:20,705 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:42:21,569 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 20:42:22,913 : [3/3] EVALUATION : Execution of _predict took at 2.224 seconds.
2023-05-07 20:42:23,971 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:42:24,041 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:42:24,922 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:42:26,245 : [3/3] EVALUATION : Execution of _predict took at 2.220 seconds.
2023-05-07 20:42:27,297 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:42:27,360 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 20:42:28,241 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 20:42:29,542 : [3/3] EVALUATION : Execution of _predict took at 2.190 seconds.
2023-05-07 20:42:30,588 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:42:30,649 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:42:31,533 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 20:42:32,806 : [3/3] EVALUATION : Execution of _predict took at 2.166 seconds.
2023-05-07 20:42:33,846 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:42:33,916 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:42:34,818 : [3/3] EVALUATION : Execution of _matmat took at 0.902 seconds.
2023-05-07 20:42:36,149 : [3/3] EVALUATION : Execution of _predict took at 2.249 seconds.
2023-05-07 20:42:37,200 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:42:37,269 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:42:38,127 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 20:42:39,427 : [3/3] EVALUATION : Execution of _predict took at 2.174 seconds.
2023-05-07 20:42:40,478 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:42:40,548 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:42:41,417 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 20:42:42,706 : [3/3] EVALUATION : Execution of _predict took at 2.173 seconds.
2023-05-07 20:42:43,763 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:42:43,826 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:42:44,692 : [3/3] EVALUATION : Execution of _matmat took at 0.866 seconds.
2023-05-07 20:42:45,975 : [3/3] EVALUATION : Execution of _predict took at 2.158 seconds.
2023-05-07 20:42:47,021 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:42:47,091 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:42:47,964 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 20:42:49,307 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 20:42:50,579 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.726 seconds.
2023-05-07 20:42:50,580 : PIPELINE END : Execution of run took at 216.935 seconds.
d=0.0025, ns=1, nf=0


2023-05-07 20:42:50,615 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:42:50,615 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:42:51,783 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.168 seconds.
2023-05-07 20:42:52,105 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:42:52,555 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:42:52,568 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.952 seconds.
2023-05-07 20:42:52,568 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:42:52,568 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:42:52,568 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:42:52,568 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:42:54,555 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:42:54,555 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:44:40,993 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:44:40,993 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:44:49,380 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:44:49,381 : [2/3] TRAINING : Execution of ldlt took at 114.826 seconds.
2023-05-07 20:44:49,381 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:44:49,381 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:44:49,381 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:44:49,419 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:44:50,017 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:44:50,017 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:44:53,073 : [2/3] TRAINING : Execution of _umr_scan took at 3.055 seconds.
2023-05-07 20:44:53,667 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 20:44:53,733 : [2/3] TRAINING : Execution of ainv_L took at 4.352 seconds.
2023-05-07 20:44:53,733 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:44:53,733 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:44:53,777 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:44:53,810 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:44:54,330 : [2/3] TRAINING : Execution of _construct_weights took at 119.775 seconds.
2023-05-07 20:44:54,331 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:44:54,331 : [2/3] TRAINING : Execution of _get_model took at 121.763 seconds.
2023-05-07 20:44:54,331 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:44:54,406 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:44:55,282 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 20:44:56,578 : [3/3] EVALUATION : Execution of _predict took at 2.191 seconds.
2023-05-07 20:44:57,638 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:44:57,713 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:44:58,575 : [3/3] EVALUATION : Execution of _matmat took at 0.862 seconds.
2023-05-07 20:44:59,842 : [3/3] EVALUATION : Execution of _predict took at 2.149 seconds.
2023-05-07 20:45:00,898 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:45:00,976 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:45:01,857 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 20:45:03,201 : [3/3] EVALUATION : Execution of _predict took at 2.248 seconds.
2023-05-07 20:45:04,258 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:45:04,331 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:05,206 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 20:45:06,532 : [3/3] EVALUATION : Execution of _predict took at 2.220 seconds.
2023-05-07 20:45:07,585 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:45:07,658 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:08,539 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 20:45:09,859 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 20:45:10,913 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:45:10,986 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:11,850 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 20:45:13,162 : [3/3] EVALUATION : Execution of _predict took at 2.195 seconds.
2023-05-07 20:45:14,214 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:45:14,286 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:45:15,175 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 20:45:16,477 : [3/3] EVALUATION : Execution of _predict took at 2.209 seconds.
2023-05-07 20:45:17,532 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:45:17,606 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:45:18,465 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 20:45:19,751 : [3/3] EVALUATION : Execution of _predict took at 2.166 seconds.
2023-05-07 20:45:20,806 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:45:20,884 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:45:21,772 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 20:45:23,086 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 20:45:24,141 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:45:24,213 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:45:25,091 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 20:45:26,361 : [3/3] EVALUATION : Execution of _predict took at 2.166 seconds.
2023-05-07 20:45:27,409 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:45:27,484 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:45:28,368 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:45:29,644 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 20:45:30,691 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:45:30,769 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 20:45:31,637 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 20:45:32,996 : [3/3] EVALUATION : Execution of _predict took at 2.251 seconds.
2023-05-07 20:45:34,058 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:45:34,131 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:35,010 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 20:45:36,336 : [3/3] EVALUATION : Execution of _predict took at 2.224 seconds.
2023-05-07 20:45:37,394 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:45:37,467 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:38,342 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 20:45:39,631 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 20:45:40,695 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:45:40,768 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:45:41,628 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 20:45:42,905 : [3/3] EVALUATION : Execution of _predict took at 2.155 seconds.
2023-05-07 20:45:43,962 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:45:44,033 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:44,910 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 20:45:46,222 : [3/3] EVALUATION : Execution of _predict took at 2.208 seconds.
2023-05-07 20:45:47,282 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:45:47,355 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:48,233 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:45:49,575 : [3/3] EVALUATION : Execution of _predict took at 2.239 seconds.
2023-05-07 20:45:50,633 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:45:50,706 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:45:51,591 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 20:45:52,913 : [3/3] EVALUATION : Execution of _predict took at 2.226 seconds.
2023-05-07 20:45:53,967 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:45:54,041 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:45:54,924 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 20:45:56,225 : [3/3] EVALUATION : Execution of _predict took at 2.204 seconds.
2023-05-07 20:45:57,275 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:45:57,351 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 20:45:58,236 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 20:45:59,509 : [3/3] EVALUATION : Execution of _predict took at 2.180 seconds.
2023-05-07 20:46:00,554 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:46:00,628 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:46:01,526 : [3/3] EVALUATION : Execution of _matmat took at 0.898 seconds.
2023-05-07 20:46:02,854 : [3/3] EVALUATION : Execution of _predict took at 2.246 seconds.
2023-05-07 20:46:03,917 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:46:03,989 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:46:04,849 : [3/3] EVALUATION : Execution of _matmat took at 0.860 seconds.
2023-05-07 20:46:06,149 : [3/3] EVALUATION : Execution of _predict took at 2.178 seconds.
2023-05-07 20:46:07,203 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:46:07,276 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:46:08,149 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 20:46:09,435 : [3/3] EVALUATION : Execution of _predict took at 2.178 seconds.
2023-05-07 20:46:10,499 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:46:10,574 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:46:11,438 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 20:46:12,724 : [3/3] EVALUATION : Execution of _predict took at 2.171 seconds.
2023-05-07 20:46:13,781 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:46:13,860 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:46:14,732 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 20:46:16,074 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 20:46:17,347 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.016 seconds.
2023-05-07 20:46:17,347 : PIPELINE END : Execution of run took at 206.732 seconds.
d=0.0025, ns=1, nf=5


2023-05-07 20:46:17,380 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:46:17,381 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:46:18,546 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.165 seconds.
2023-05-07 20:46:18,867 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:46:19,315 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:46:19,327 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.946 seconds.
2023-05-07 20:46:19,327 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:46:19,327 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:46:19,327 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:46:19,327 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:46:21,320 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:46:21,320 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:48:07,371 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:48:07,371 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:48:15,848 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:48:15,848 : [2/3] TRAINING : Execution of ldlt took at 114.528 seconds.
2023-05-07 20:48:15,848 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:48:15,848 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:48:15,848 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:48:15,877 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:48:16,471 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:48:16,471 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:48:19,534 : [2/3] TRAINING : Execution of _umr_scan took at 3.063 seconds.
2023-05-07 20:48:20,135 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 20:48:20,135 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:48:20,270 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.135 seconds.
2023-05-07 20:48:20,872 : [2/3] TRAINING : Current maximum residual: 1.81420436, relative Frobenius norm squared: 0.07521796
2023-05-07 20:48:20,872 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:48:21,008 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.136 seconds.
2023-05-07 20:48:21,613 : [2/3] TRAINING : Current maximum residual: 1.65083923, relative Frobenius norm squared: 0.06821227
2023-05-07 20:48:21,613 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:48:21,750 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.137 seconds.
2023-05-07 20:48:22,356 : [2/3] TRAINING : Current maximum residual: 1.50041605, relative Frobenius norm squared: 0.06250082
2023-05-07 20:48:22,356 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:48:22,510 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.154 seconds.
2023-05-07 20:48:23,113 : [2/3] TRAINING : Current maximum residual: 1.37220637, relative Frobenius norm squared: 0.05766452
2023-05-07 20:48:23,113 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:48:23,228 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.114 seconds.
2023-05-07 20:48:23,838 : [2/3] TRAINING : Current maximum residual: 1.29508234, relative Frobenius norm squared: 0.05357476
2023-05-07 20:48:23,907 : [2/3] TRAINING : Execution of ainv_L took at 8.058 seconds.
2023-05-07 20:48:23,907 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:48:23,907 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:48:23,955 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:48:23,991 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:48:24,504 : [2/3] TRAINING : Execution of _construct_weights took at 123.184 seconds.
2023-05-07 20:48:24,505 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:48:24,505 : [2/3] TRAINING : Execution of _get_model took at 125.178 seconds.
2023-05-07 20:48:24,505 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:48:24,580 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:48:25,453 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 20:48:26,750 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 20:48:27,798 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:48:27,869 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:48:28,731 : [3/3] EVALUATION : Execution of _matmat took at 0.863 seconds.
2023-05-07 20:48:29,998 : [3/3] EVALUATION : Execution of _predict took at 2.146 seconds.
2023-05-07 20:48:31,034 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:48:31,106 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:48:31,983 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 20:48:33,328 : [3/3] EVALUATION : Execution of _predict took at 2.239 seconds.
2023-05-07 20:48:34,373 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:48:34,446 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:48:35,363 : [3/3] EVALUATION : Execution of _matmat took at 0.918 seconds.
2023-05-07 20:48:36,690 : [3/3] EVALUATION : Execution of _predict took at 2.263 seconds.
2023-05-07 20:48:37,737 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:48:37,809 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:48:38,698 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 20:48:40,019 : [3/3] EVALUATION : Execution of _predict took at 2.227 seconds.
2023-05-07 20:48:41,052 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:48:41,124 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:48:42,003 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 20:48:43,314 : [3/3] EVALUATION : Execution of _predict took at 2.207 seconds.
2023-05-07 20:48:44,355 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:48:44,419 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:48:45,323 : [3/3] EVALUATION : Execution of _matmat took at 0.904 seconds.
2023-05-07 20:48:46,627 : [3/3] EVALUATION : Execution of _predict took at 2.217 seconds.
2023-05-07 20:48:47,661 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:48:47,732 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:48:48,601 : [3/3] EVALUATION : Execution of _matmat took at 0.868 seconds.
2023-05-07 20:48:49,885 : [3/3] EVALUATION : Execution of _predict took at 2.169 seconds.
2023-05-07 20:48:50,929 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:48:51,001 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:48:51,895 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 20:48:53,209 : [3/3] EVALUATION : Execution of _predict took at 2.224 seconds.
2023-05-07 20:48:54,254 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:48:54,316 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:48:55,203 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 20:48:56,473 : [3/3] EVALUATION : Execution of _predict took at 2.166 seconds.
2023-05-07 20:48:57,512 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:48:57,575 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 20:48:58,466 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 20:48:59,741 : [3/3] EVALUATION : Execution of _predict took at 2.174 seconds.
2023-05-07 20:49:00,766 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:49:00,839 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:49:01,719 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:49:03,079 : [3/3] EVALUATION : Execution of _predict took at 2.258 seconds.
2023-05-07 20:49:04,131 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:49:04,202 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:05,093 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 20:49:06,422 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 20:49:07,463 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:49:07,534 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:08,416 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:49:09,706 : [3/3] EVALUATION : Execution of _predict took at 2.188 seconds.
2023-05-07 20:49:10,744 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:49:10,816 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:49:11,683 : [3/3] EVALUATION : Execution of _matmat took at 0.867 seconds.
2023-05-07 20:49:12,959 : [3/3] EVALUATION : Execution of _predict took at 2.159 seconds.
2023-05-07 20:49:13,999 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:49:14,069 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:14,952 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:49:16,266 : [3/3] EVALUATION : Execution of _predict took at 2.214 seconds.
2023-05-07 20:49:17,303 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:49:17,375 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:18,259 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 20:49:19,601 : [3/3] EVALUATION : Execution of _predict took at 2.243 seconds.
2023-05-07 20:49:20,649 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:49:20,720 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:21,613 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 20:49:22,937 : [3/3] EVALUATION : Execution of _predict took at 2.233 seconds.
2023-05-07 20:49:23,977 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:49:24,040 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:49:24,932 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:49:26,230 : [3/3] EVALUATION : Execution of _predict took at 2.198 seconds.
2023-05-07 20:49:27,263 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:49:27,333 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:49:28,224 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:49:29,499 : [3/3] EVALUATION : Execution of _predict took at 2.182 seconds.
2023-05-07 20:49:30,524 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:49:30,596 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:31,503 : [3/3] EVALUATION : Execution of _matmat took at 0.907 seconds.
2023-05-07 20:49:32,831 : [3/3] EVALUATION : Execution of _predict took at 2.252 seconds.
2023-05-07 20:49:33,869 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:49:33,939 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:34,809 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 20:49:36,108 : [3/3] EVALUATION : Execution of _predict took at 2.187 seconds.
2023-05-07 20:49:37,147 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:49:37,218 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:38,099 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:49:39,387 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 20:49:40,434 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:49:40,497 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:49:41,375 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:49:42,658 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 20:49:43,688 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:49:43,759 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:49:44,639 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 20:49:45,981 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 20:49:47,243 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.738 seconds.
2023-05-07 20:49:47,244 : PIPELINE END : Execution of run took at 209.863 seconds.
d=0.0025, ns=1, nf=10


2023-05-07 20:49:47,279 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:49:47,280 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:49:48,468 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.188 seconds.
2023-05-07 20:49:48,800 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:49:49,257 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:49:49,270 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.990 seconds.
2023-05-07 20:49:49,270 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:49:49,270 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:49:49,270 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:49:49,270 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:49:51,303 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:49:51,303 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:51:40,212 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:51:40,212 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:51:48,739 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:51:48,739 : [2/3] TRAINING : Execution of ldlt took at 117.436 seconds.
2023-05-07 20:51:48,739 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:51:48,739 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:51:48,739 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:51:48,779 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:51:49,395 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:51:49,395 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:51:52,508 : [2/3] TRAINING : Execution of _umr_scan took at 3.113 seconds.
2023-05-07 20:51:53,119 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 20:51:53,119 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:51:53,256 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.137 seconds.
2023-05-07 20:51:53,882 : [2/3] TRAINING : Current maximum residual: 1.81420436, relative Frobenius norm squared: 0.07521796
2023-05-07 20:51:53,882 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:51:54,024 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.142 seconds.
2023-05-07 20:51:54,649 : [2/3] TRAINING : Current maximum residual: 1.65083923, relative Frobenius norm squared: 0.06821227
2023-05-07 20:51:54,649 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:51:54,788 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.138 seconds.
2023-05-07 20:51:55,405 : [2/3] TRAINING : Current maximum residual: 1.50041605, relative Frobenius norm squared: 0.06250082
2023-05-07 20:51:55,405 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:51:55,564 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.159 seconds.
2023-05-07 20:51:56,184 : [2/3] TRAINING : Current maximum residual: 1.37220637, relative Frobenius norm squared: 0.05766452
2023-05-07 20:51:56,184 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:51:56,302 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.118 seconds.
2023-05-07 20:51:56,925 : [2/3] TRAINING : Current maximum residual: 1.29508234, relative Frobenius norm squared: 0.05357476
2023-05-07 20:51:56,925 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:51:57,050 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.125 seconds.
2023-05-07 20:51:57,661 : [2/3] TRAINING : Current maximum residual: 1.20864705, relative Frobenius norm squared: 0.04996703
2023-05-07 20:51:57,661 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:51:57,792 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.131 seconds.
2023-05-07 20:51:58,404 : [2/3] TRAINING : Current maximum residual: 1.14107157, relative Frobenius norm squared: 0.04677134
2023-05-07 20:51:58,404 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:51:58,529 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.125 seconds.
2023-05-07 20:51:59,143 : [2/3] TRAINING : Current maximum residual: 1.08364919, relative Frobenius norm squared: 0.04395697
2023-05-07 20:51:59,143 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:51:59,274 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.131 seconds.
2023-05-07 20:51:59,904 : [2/3] TRAINING : Current maximum residual: 1.02801680, relative Frobenius norm squared: 0.04140653
2023-05-07 20:51:59,904 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:52:00,048 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.143 seconds.
2023-05-07 20:52:00,667 : [2/3] TRAINING : Current maximum residual: 0.97771484, relative Frobenius norm squared: 0.03910979
2023-05-07 20:52:00,740 : [2/3] TRAINING : Execution of ainv_L took at 12.001 seconds.
2023-05-07 20:52:00,740 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:52:00,740 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:52:00,782 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:52:00,819 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:52:01,356 : [2/3] TRAINING : Execution of _construct_weights took at 130.054 seconds.
2023-05-07 20:52:01,357 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:52:01,358 : [2/3] TRAINING : Execution of _get_model took at 132.088 seconds.
2023-05-07 20:52:01,358 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:52:01,433 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:52:02,322 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 20:52:03,618 : [3/3] EVALUATION : Execution of _predict took at 2.204 seconds.
2023-05-07 20:52:04,674 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:52:04,745 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:52:05,619 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 20:52:06,886 : [3/3] EVALUATION : Execution of _predict took at 2.157 seconds.
2023-05-07 20:52:07,923 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:52:07,995 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:08,886 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 20:52:10,231 : [3/3] EVALUATION : Execution of _predict took at 2.253 seconds.
2023-05-07 20:52:11,275 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:52:11,346 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:52:12,228 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 20:52:13,555 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 20:52:14,606 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:52:14,678 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:15,572 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 20:52:16,893 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 20:52:17,939 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:52:18,010 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:18,890 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 20:52:20,203 : [3/3] EVALUATION : Execution of _predict took at 2.209 seconds.
2023-05-07 20:52:21,249 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:52:21,312 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:52:22,215 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 20:52:23,517 : [3/3] EVALUATION : Execution of _predict took at 2.214 seconds.
2023-05-07 20:52:24,554 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:52:24,617 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:52:25,486 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 20:52:26,771 : [3/3] EVALUATION : Execution of _predict took at 2.163 seconds.
2023-05-07 20:52:27,816 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:52:27,889 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:28,792 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 20:52:30,105 : [3/3] EVALUATION : Execution of _predict took at 2.234 seconds.
2023-05-07 20:52:31,162 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:52:31,224 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:52:32,107 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:52:33,378 : [3/3] EVALUATION : Execution of _predict took at 2.162 seconds.
2023-05-07 20:52:34,426 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:52:34,489 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 20:52:35,382 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:52:36,656 : [3/3] EVALUATION : Execution of _predict took at 2.175 seconds.
2023-05-07 20:52:37,693 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:52:37,764 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:38,641 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 20:52:40,000 : [3/3] EVALUATION : Execution of _predict took at 2.253 seconds.
2023-05-07 20:52:41,049 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:52:41,120 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:42,012 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:52:43,340 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 20:52:44,387 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:52:44,457 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:52:45,340 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:52:46,631 : [3/3] EVALUATION : Execution of _predict took at 2.190 seconds.
2023-05-07 20:52:47,681 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:52:47,752 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:48,618 : [3/3] EVALUATION : Execution of _matmat took at 0.866 seconds.
2023-05-07 20:52:49,896 : [3/3] EVALUATION : Execution of _predict took at 2.161 seconds.
2023-05-07 20:52:50,946 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:52:51,015 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:52:51,898 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:52:53,210 : [3/3] EVALUATION : Execution of _predict took at 2.212 seconds.
2023-05-07 20:52:54,257 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:52:54,328 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:52:55,213 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 20:52:56,556 : [3/3] EVALUATION : Execution of _predict took at 2.244 seconds.
2023-05-07 20:52:57,612 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:52:57,682 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:52:58,603 : [3/3] EVALUATION : Execution of _matmat took at 0.920 seconds.
2023-05-07 20:52:59,925 : [3/3] EVALUATION : Execution of _predict took at 2.260 seconds.
2023-05-07 20:53:00,972 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:53:01,036 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:53:01,925 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 20:53:03,226 : [3/3] EVALUATION : Execution of _predict took at 2.199 seconds.
2023-05-07 20:53:04,266 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:53:04,328 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:53:05,227 : [3/3] EVALUATION : Execution of _matmat took at 0.899 seconds.
2023-05-07 20:53:06,501 : [3/3] EVALUATION : Execution of _predict took at 2.182 seconds.
2023-05-07 20:53:07,534 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:53:07,607 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:53:08,519 : [3/3] EVALUATION : Execution of _matmat took at 0.913 seconds.
2023-05-07 20:53:09,850 : [3/3] EVALUATION : Execution of _predict took at 2.261 seconds.
2023-05-07 20:53:10,899 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:53:10,970 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:53:11,846 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 20:53:13,145 : [3/3] EVALUATION : Execution of _predict took at 2.192 seconds.
2023-05-07 20:53:14,197 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:53:14,268 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:53:15,144 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 20:53:16,432 : [3/3] EVALUATION : Execution of _predict took at 2.180 seconds.
2023-05-07 20:53:17,486 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:53:17,548 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:53:18,425 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 20:53:19,710 : [3/3] EVALUATION : Execution of _predict took at 2.171 seconds.
2023-05-07 20:53:20,749 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:53:20,820 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 20:53:21,702 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 20:53:23,046 : [3/3] EVALUATION : Execution of _predict took at 2.243 seconds.
2023-05-07 20:53:24,331 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.973 seconds.
2023-05-07 20:53:24,332 : PIPELINE END : Execution of run took at 217.052 seconds.
d=0.0025, ns=1, nf=20


2023-05-07 20:53:24,367 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:53:24,367 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:53:25,555 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.188 seconds.
2023-05-07 20:53:25,888 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:53:26,346 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:53:26,359 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.992 seconds.
2023-05-07 20:53:26,359 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:53:26,359 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:53:26,359 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:53:26,359 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:53:28,408 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:53:28,408 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:55:17,304 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:55:17,304 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:55:25,817 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:55:25,817 : [2/3] TRAINING : Execution of ldlt took at 117.409 seconds.
2023-05-07 20:55:25,817 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:55:25,817 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:55:25,817 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:55:25,857 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:55:26,474 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:55:26,475 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:55:29,572 : [2/3] TRAINING : Execution of _umr_scan took at 3.097 seconds.
2023-05-07 20:55:30,184 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 20:55:30,184 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 20:55:30,322 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.138 seconds.
2023-05-07 20:55:30,943 : [2/3] TRAINING : Current maximum residual: 1.81420436, relative Frobenius norm squared: 0.07521796
2023-05-07 20:55:30,943 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 20:55:31,083 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.140 seconds.
2023-05-07 20:55:31,705 : [2/3] TRAINING : Current maximum residual: 1.65083923, relative Frobenius norm squared: 0.06821227
2023-05-07 20:55:31,705 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 20:55:31,842 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.137 seconds.
2023-05-07 20:55:32,460 : [2/3] TRAINING : Current maximum residual: 1.50041605, relative Frobenius norm squared: 0.06250082
2023-05-07 20:55:32,460 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 20:55:32,620 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.160 seconds.
2023-05-07 20:55:33,240 : [2/3] TRAINING : Current maximum residual: 1.37220637, relative Frobenius norm squared: 0.05766452
2023-05-07 20:55:33,240 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 20:55:33,358 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.117 seconds.
2023-05-07 20:55:33,985 : [2/3] TRAINING : Current maximum residual: 1.29508234, relative Frobenius norm squared: 0.05357476
2023-05-07 20:55:33,985 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 20:55:34,111 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.125 seconds.
2023-05-07 20:55:34,722 : [2/3] TRAINING : Current maximum residual: 1.20864705, relative Frobenius norm squared: 0.04996703
2023-05-07 20:55:34,722 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 20:55:34,853 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.131 seconds.
2023-05-07 20:55:35,465 : [2/3] TRAINING : Current maximum residual: 1.14107157, relative Frobenius norm squared: 0.04677134
2023-05-07 20:55:35,465 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 20:55:35,590 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.125 seconds.
2023-05-07 20:55:36,202 : [2/3] TRAINING : Current maximum residual: 1.08364919, relative Frobenius norm squared: 0.04395697
2023-05-07 20:55:36,202 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 20:55:36,333 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.131 seconds.
2023-05-07 20:55:36,964 : [2/3] TRAINING : Current maximum residual: 1.02801680, relative Frobenius norm squared: 0.04140653
2023-05-07 20:55:36,964 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 20:55:37,108 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.144 seconds.
2023-05-07 20:55:37,728 : [2/3] TRAINING : Current maximum residual: 0.97771484, relative Frobenius norm squared: 0.03910979
2023-05-07 20:55:37,728 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 20:55:37,872 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.143 seconds.
2023-05-07 20:55:38,497 : [2/3] TRAINING : Current maximum residual: 0.94379113, relative Frobenius norm squared: 0.03702469
2023-05-07 20:55:38,497 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 20:55:38,634 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.137 seconds.
2023-05-07 20:55:39,265 : [2/3] TRAINING : Current maximum residual: 0.90482177, relative Frobenius norm squared: 0.03510461
2023-05-07 20:55:39,265 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 20:55:39,374 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.108 seconds.
2023-05-07 20:55:39,987 : [2/3] TRAINING : Current maximum residual: 0.87539271, relative Frobenius norm squared: 0.03333893
2023-05-07 20:55:39,988 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 20:55:40,129 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.141 seconds.
2023-05-07 20:55:40,756 : [2/3] TRAINING : Current maximum residual: 0.83421248, relative Frobenius norm squared: 0.03173562
2023-05-07 20:55:40,757 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 20:55:40,871 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.115 seconds.
2023-05-07 20:55:41,503 : [2/3] TRAINING : Current maximum residual: 0.80499019, relative Frobenius norm squared: 0.03026231
2023-05-07 20:55:41,504 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 20:55:41,628 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.124 seconds.
2023-05-07 20:55:42,246 : [2/3] TRAINING : Current maximum residual: 0.77280695, relative Frobenius norm squared: 0.02890687
2023-05-07 20:55:42,246 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 20:55:42,380 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.134 seconds.
2023-05-07 20:55:43,011 : [2/3] TRAINING : Current maximum residual: 0.74491051, relative Frobenius norm squared: 0.02763335
2023-05-07 20:55:43,012 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 20:55:43,135 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.123 seconds.
2023-05-07 20:55:43,757 : [2/3] TRAINING : Current maximum residual: 0.72188091, relative Frobenius norm squared: 0.02647090
2023-05-07 20:55:43,757 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 20:55:43,891 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.134 seconds.
2023-05-07 20:55:44,513 : [2/3] TRAINING : Current maximum residual: 0.69488680, relative Frobenius norm squared: 0.02540420
2023-05-07 20:55:44,514 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 20:55:44,613 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.100 seconds.
2023-05-07 20:55:45,234 : [2/3] TRAINING : Current maximum residual: 0.67374303, relative Frobenius norm squared: 0.02441263
2023-05-07 20:55:45,309 : [2/3] TRAINING : Execution of ainv_L took at 19.492 seconds.
2023-05-07 20:55:45,309 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:55:45,309 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:55:45,352 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:55:45,384 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:55:45,908 : [2/3] TRAINING : Execution of _construct_weights took at 137.500 seconds.
2023-05-07 20:55:45,909 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:55:45,909 : [2/3] TRAINING : Execution of _get_model took at 139.550 seconds.
2023-05-07 20:55:45,909 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:55:45,984 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:55:46,872 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 20:55:48,168 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 20:55:49,226 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:55:49,301 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:55:50,177 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 20:55:51,445 : [3/3] EVALUATION : Execution of _predict took at 2.165 seconds.
2023-05-07 20:55:52,494 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:55:52,574 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:55:53,470 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 20:55:54,814 : [3/3] EVALUATION : Execution of _predict took at 2.264 seconds.
2023-05-07 20:55:55,864 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:55:55,937 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:55:56,826 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 20:55:58,152 : [3/3] EVALUATION : Execution of _predict took at 2.234 seconds.
2023-05-07 20:55:59,205 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:55:59,279 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:56:00,179 : [3/3] EVALUATION : Execution of _matmat took at 0.900 seconds.
2023-05-07 20:56:01,500 : [3/3] EVALUATION : Execution of _predict took at 2.240 seconds.
2023-05-07 20:56:02,548 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:56:02,622 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:56:03,500 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:56:04,813 : [3/3] EVALUATION : Execution of _predict took at 2.210 seconds.
2023-05-07 20:56:05,866 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 20:56:05,941 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:56:06,847 : [3/3] EVALUATION : Execution of _matmat took at 0.906 seconds.
2023-05-07 20:56:08,151 : [3/3] EVALUATION : Execution of _predict took at 2.230 seconds.
2023-05-07 20:56:09,193 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 20:56:09,270 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 20:56:10,142 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 20:56:11,429 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 20:56:12,477 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 20:56:12,556 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:56:13,461 : [3/3] EVALUATION : Execution of _matmat took at 0.905 seconds.
2023-05-07 20:56:14,776 : [3/3] EVALUATION : Execution of _predict took at 2.244 seconds.
2023-05-07 20:56:15,828 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 20:56:15,903 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:56:16,794 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 20:56:18,068 : [3/3] EVALUATION : Execution of _predict took at 2.187 seconds.
2023-05-07 20:56:19,127 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 20:56:19,203 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:56:20,098 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 20:56:21,375 : [3/3] EVALUATION : Execution of _predict took at 2.194 seconds.
2023-05-07 20:56:22,422 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 20:56:22,501 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:56:23,384 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:56:24,743 : [3/3] EVALUATION : Execution of _predict took at 2.267 seconds.
2023-05-07 20:56:25,807 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 20:56:25,881 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:56:26,771 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:56:28,099 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 20:56:29,159 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 20:56:29,234 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:56:30,121 : [3/3] EVALUATION : Execution of _matmat took at 0.886 seconds.
2023-05-07 20:56:31,414 : [3/3] EVALUATION : Execution of _predict took at 2.201 seconds.
2023-05-07 20:56:32,463 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 20:56:32,540 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 20:56:33,451 : [3/3] EVALUATION : Execution of _matmat took at 0.910 seconds.
2023-05-07 20:56:34,732 : [3/3] EVALUATION : Execution of _predict took at 2.214 seconds.
2023-05-07 20:56:35,782 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 20:56:35,858 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:56:36,752 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 20:56:38,066 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 20:56:39,132 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 20:56:39,207 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 20:56:40,092 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 20:56:41,435 : [3/3] EVALUATION : Execution of _predict took at 2.248 seconds.
2023-05-07 20:56:42,498 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 20:56:42,572 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:56:43,470 : [3/3] EVALUATION : Execution of _matmat took at 0.899 seconds.
2023-05-07 20:56:44,795 : [3/3] EVALUATION : Execution of _predict took at 2.242 seconds.
2023-05-07 20:56:45,849 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 20:56:45,925 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:56:46,823 : [3/3] EVALUATION : Execution of _matmat took at 0.898 seconds.
2023-05-07 20:56:48,127 : [3/3] EVALUATION : Execution of _predict took at 2.223 seconds.
2023-05-07 20:56:49,174 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 20:56:49,249 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 20:56:50,152 : [3/3] EVALUATION : Execution of _matmat took at 0.902 seconds.
2023-05-07 20:56:51,429 : [3/3] EVALUATION : Execution of _predict took at 2.201 seconds.
2023-05-07 20:56:52,473 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 20:56:52,552 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 20:56:53,470 : [3/3] EVALUATION : Execution of _matmat took at 0.917 seconds.
2023-05-07 20:56:54,801 : [3/3] EVALUATION : Execution of _predict took at 2.272 seconds.
2023-05-07 20:56:55,856 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 20:56:55,929 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:56:56,808 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 20:56:58,108 : [3/3] EVALUATION : Execution of _predict took at 2.198 seconds.
2023-05-07 20:56:59,164 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 20:56:59,237 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:57:00,128 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:57:01,418 : [3/3] EVALUATION : Execution of _predict took at 2.199 seconds.
2023-05-07 20:57:02,468 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 20:57:02,545 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 20:57:03,436 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 20:57:04,724 : [3/3] EVALUATION : Execution of _predict took at 2.201 seconds.
2023-05-07 20:57:05,772 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 20:57:05,851 : [3/3] EVALUATION : Execution of _matmat took at 0.025 seconds.
2023-05-07 20:57:06,744 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 20:57:08,088 : [3/3] EVALUATION : Execution of _predict took at 2.262 seconds.
2023-05-07 20:57:09,374 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.465 seconds.
2023-05-07 20:57:09,375 : PIPELINE END : Execution of run took at 225.008 seconds.
d=0.0025, ns=2, nf=0


2023-05-07 20:57:09,408 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 20:57:09,408 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 20:57:10,607 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.198 seconds.
2023-05-07 20:57:10,945 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 20:57:11,404 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 20:57:11,417 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.008 seconds.
2023-05-07 20:57:11,417 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 20:57:11,417 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 20:57:11,417 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 20:57:11,417 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 20:57:13,501 : [2/3] TRAINING : Constructing weights:
2023-05-07 20:57:13,501 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 20:59:03,616 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 20:59:03,616 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 20:59:12,179 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 20:59:12,179 : [2/3] TRAINING : Execution of ldlt took at 118.678 seconds.
2023-05-07 20:59:12,179 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 20:59:12,179 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 20:59:12,179 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 20:59:12,208 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 20:59:12,830 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 20:59:12,830 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 20:59:15,954 : [2/3] TRAINING : Execution of _umr_scan took at 3.124 seconds.
2023-05-07 20:59:16,581 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 20:59:16,581 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 20:59:40,016 : [2/3] TRAINING : Execution of _umr_scan took at 23.435 seconds.
2023-05-07 20:59:40,643 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 20:59:40,712 : [2/3] TRAINING : Execution of ainv_L took at 28.533 seconds.
2023-05-07 20:59:40,713 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 20:59:40,713 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 20:59:40,760 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 20:59:40,797 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 20:59:41,327 : [2/3] TRAINING : Execution of _construct_weights took at 147.826 seconds.
2023-05-07 20:59:41,329 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 20:59:41,329 : [2/3] TRAINING : Execution of _get_model took at 149.912 seconds.
2023-05-07 20:59:41,329 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 20:59:41,405 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 20:59:42,300 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 20:59:43,597 : [3/3] EVALUATION : Execution of _predict took at 2.212 seconds.
2023-05-07 20:59:44,671 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 20:59:44,743 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 20:59:45,626 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 20:59:46,894 : [3/3] EVALUATION : Execution of _predict took at 2.167 seconds.
2023-05-07 20:59:47,949 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 20:59:48,023 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 20:59:48,924 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 20:59:50,270 : [3/3] EVALUATION : Execution of _predict took at 2.265 seconds.
2023-05-07 20:59:51,342 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 20:59:51,407 : [3/3] EVALUATION : Execution of _matmat took at 0.010 seconds.
2023-05-07 20:59:52,296 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 20:59:53,624 : [3/3] EVALUATION : Execution of _predict took at 2.227 seconds.
2023-05-07 20:59:54,688 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 20:59:54,753 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:59:55,654 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 20:59:56,975 : [3/3] EVALUATION : Execution of _predict took at 2.231 seconds.
2023-05-07 20:59:58,036 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 20:59:58,100 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 20:59:58,990 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 21:00:00,303 : [3/3] EVALUATION : Execution of _predict took at 2.212 seconds.
2023-05-07 21:00:01,375 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:00:01,447 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:00:02,363 : [3/3] EVALUATION : Execution of _matmat took at 0.916 seconds.
2023-05-07 21:00:03,666 : [3/3] EVALUATION : Execution of _predict took at 2.236 seconds.
2023-05-07 21:00:04,730 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:00:04,793 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:05,671 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 21:00:06,937 : [3/3] EVALUATION : Execution of _predict took at 2.153 seconds.
2023-05-07 21:00:08,003 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:00:08,068 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:08,980 : [3/3] EVALUATION : Execution of _matmat took at 0.912 seconds.
2023-05-07 21:00:10,296 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 21:00:11,369 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:00:11,440 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:00:12,335 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 21:00:13,608 : [3/3] EVALUATION : Execution of _predict took at 2.186 seconds.
2023-05-07 21:00:14,686 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:00:14,750 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:15,656 : [3/3] EVALUATION : Execution of _matmat took at 0.906 seconds.
2023-05-07 21:00:16,930 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 21:00:17,987 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:00:18,059 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:00:18,948 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 21:00:20,310 : [3/3] EVALUATION : Execution of _predict took at 2.268 seconds.
2023-05-07 21:00:21,378 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:00:21,449 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:00:22,382 : [3/3] EVALUATION : Execution of _matmat took at 0.933 seconds.
2023-05-07 21:00:23,710 : [3/3] EVALUATION : Execution of _predict took at 2.277 seconds.
2023-05-07 21:00:24,781 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:00:24,845 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:25,733 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 21:00:27,025 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 21:00:28,093 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:00:28,157 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:29,032 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:00:30,308 : [3/3] EVALUATION : Execution of _predict took at 2.160 seconds.
2023-05-07 21:00:31,376 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:00:31,437 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:32,327 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 21:00:33,640 : [3/3] EVALUATION : Execution of _predict took at 2.211 seconds.
2023-05-07 21:00:34,705 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:00:34,777 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:00:35,659 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:00:37,002 : [3/3] EVALUATION : Execution of _predict took at 2.243 seconds.
2023-05-07 21:00:38,087 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:00:38,150 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:39,046 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 21:00:40,369 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 21:00:41,439 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:00:41,503 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:42,396 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 21:00:43,696 : [3/3] EVALUATION : Execution of _predict took at 2.202 seconds.
2023-05-07 21:00:44,764 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:00:44,826 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:45,727 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 21:00:47,002 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 21:00:48,054 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:00:48,126 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:00:49,039 : [3/3] EVALUATION : Execution of _matmat took at 0.913 seconds.
2023-05-07 21:00:50,367 : [3/3] EVALUATION : Execution of _predict took at 2.258 seconds.
2023-05-07 21:00:51,438 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:00:51,500 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:52,377 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 21:00:53,677 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 21:00:54,755 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:00:54,817 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:55,694 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:00:56,981 : [3/3] EVALUATION : Execution of _predict took at 2.172 seconds.
2023-05-07 21:00:58,045 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:00:58,108 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:00:58,994 : [3/3] EVALUATION : Execution of _matmat took at 0.886 seconds.
2023-05-07 21:01:00,279 : [3/3] EVALUATION : Execution of _predict took at 2.179 seconds.
2023-05-07 21:01:01,344 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:01:01,414 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:01:02,305 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 21:01:03,651 : [3/3] EVALUATION : Execution of _predict took at 2.253 seconds.
2023-05-07 21:01:04,948 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.619 seconds.
2023-05-07 21:01:04,948 : PIPELINE END : Execution of run took at 235.540 seconds.
d=0.0025, ns=2, nf=5


2023-05-07 21:01:04,984 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:01:04,984 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:01:06,178 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.194 seconds.
2023-05-07 21:01:06,511 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:01:06,969 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:01:06,981 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.997 seconds.
2023-05-07 21:01:06,981 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:01:06,981 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:01:06,982 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:01:06,982 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:01:09,039 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:01:09,039 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:02:58,256 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:02:58,256 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:03:06,821 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:03:06,821 : [2/3] TRAINING : Execution of ldlt took at 117.782 seconds.
2023-05-07 21:03:06,821 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:03:06,821 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:03:06,821 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:03:06,861 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:03:07,493 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:03:07,493 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:03:10,636 : [2/3] TRAINING : Execution of _umr_scan took at 3.143 seconds.
2023-05-07 21:03:11,264 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:03:11,265 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:03:34,447 : [2/3] TRAINING : Execution of _umr_scan took at 23.182 seconds.
2023-05-07 21:03:35,065 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:03:35,065 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:03:35,254 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.188 seconds.
2023-05-07 21:03:35,879 : [2/3] TRAINING : Current maximum residual: 0.79011318, relative Frobenius norm squared: 0.00620647
2023-05-07 21:03:35,879 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:03:36,046 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.167 seconds.
2023-05-07 21:03:36,661 : [2/3] TRAINING : Current maximum residual: 0.65701651, relative Frobenius norm squared: 0.00601973
2023-05-07 21:03:36,661 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:03:36,805 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.143 seconds.
2023-05-07 21:03:37,435 : [2/3] TRAINING : Current maximum residual: 0.29464275, relative Frobenius norm squared: 0.00586487
2023-05-07 21:03:37,435 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:03:37,595 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.160 seconds.
2023-05-07 21:03:38,216 : [2/3] TRAINING : Current maximum residual: 0.26774581, relative Frobenius norm squared: 0.00576440
2023-05-07 21:03:38,217 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:03:38,360 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.143 seconds.
2023-05-07 21:03:38,981 : [2/3] TRAINING : Current maximum residual: 0.25661892, relative Frobenius norm squared: 0.00567449
2023-05-07 21:03:39,050 : [2/3] TRAINING : Execution of ainv_L took at 32.229 seconds.
2023-05-07 21:03:39,050 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:03:39,050 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:03:39,098 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:03:39,134 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:03:39,661 : [2/3] TRAINING : Execution of _construct_weights took at 150.623 seconds.
2023-05-07 21:03:39,662 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:03:39,662 : [2/3] TRAINING : Execution of _get_model took at 152.681 seconds.
2023-05-07 21:03:39,663 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:03:39,739 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:03:40,624 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:03:41,920 : [3/3] EVALUATION : Execution of _predict took at 2.201 seconds.
2023-05-07 21:03:42,980 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:03:43,051 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:03:43,927 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:03:45,193 : [3/3] EVALUATION : Execution of _predict took at 2.158 seconds.
2023-05-07 21:03:46,244 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:03:46,316 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:03:47,209 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:03:48,553 : [3/3] EVALUATION : Execution of _predict took at 2.253 seconds.
2023-05-07 21:03:49,612 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:03:49,676 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:03:50,559 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:03:51,885 : [3/3] EVALUATION : Execution of _predict took at 2.218 seconds.
2023-05-07 21:03:52,938 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:03:53,003 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:03:53,900 : [3/3] EVALUATION : Execution of _matmat took at 0.897 seconds.
2023-05-07 21:03:55,219 : [3/3] EVALUATION : Execution of _predict took at 2.226 seconds.
2023-05-07 21:03:56,261 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:03:56,333 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:03:57,212 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:03:58,524 : [3/3] EVALUATION : Execution of _predict took at 2.208 seconds.
2023-05-07 21:03:59,577 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:03:59,641 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:00,549 : [3/3] EVALUATION : Execution of _matmat took at 0.908 seconds.
2023-05-07 21:04:01,851 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 21:04:02,895 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:04:02,958 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:03,833 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 21:04:05,116 : [3/3] EVALUATION : Execution of _predict took at 2.167 seconds.
2023-05-07 21:04:06,170 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:04:06,243 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:04:07,145 : [3/3] EVALUATION : Execution of _matmat took at 0.902 seconds.
2023-05-07 21:04:08,457 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 21:04:09,515 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:04:09,578 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:10,471 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:04:11,741 : [3/3] EVALUATION : Execution of _predict took at 2.172 seconds.
2023-05-07 21:04:12,801 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:04:12,864 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:04:13,765 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 21:04:15,039 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 21:04:16,082 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:04:16,154 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:04:17,035 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 21:04:18,395 : [3/3] EVALUATION : Execution of _predict took at 2.259 seconds.
2023-05-07 21:04:19,450 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:04:19,521 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:04:20,416 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 21:04:21,744 : [3/3] EVALUATION : Execution of _predict took at 2.240 seconds.
2023-05-07 21:04:22,802 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:04:22,864 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:23,747 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:04:25,038 : [3/3] EVALUATION : Execution of _predict took at 2.182 seconds.
2023-05-07 21:04:26,095 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:04:26,159 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:27,037 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 21:04:28,313 : [3/3] EVALUATION : Execution of _predict took at 2.162 seconds.
2023-05-07 21:04:29,365 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:04:29,428 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:30,314 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 21:04:31,626 : [3/3] EVALUATION : Execution of _predict took at 2.208 seconds.
2023-05-07 21:04:32,680 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:04:32,752 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:04:33,665 : [3/3] EVALUATION : Execution of _matmat took at 0.913 seconds.
2023-05-07 21:04:35,007 : [3/3] EVALUATION : Execution of _predict took at 2.273 seconds.
2023-05-07 21:04:36,077 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:04:36,140 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:37,037 : [3/3] EVALUATION : Execution of _matmat took at 0.897 seconds.
2023-05-07 21:04:38,360 : [3/3] EVALUATION : Execution of _predict took at 2.229 seconds.
2023-05-07 21:04:39,416 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:04:39,480 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:40,418 : [3/3] EVALUATION : Execution of _matmat took at 0.938 seconds.
2023-05-07 21:04:41,717 : [3/3] EVALUATION : Execution of _predict took at 2.246 seconds.
2023-05-07 21:04:42,766 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:04:42,829 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:43,722 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:04:44,996 : [3/3] EVALUATION : Execution of _predict took at 2.177 seconds.
2023-05-07 21:04:46,038 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:04:46,109 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:04:47,019 : [3/3] EVALUATION : Execution of _matmat took at 0.909 seconds.
2023-05-07 21:04:48,348 : [3/3] EVALUATION : Execution of _predict took at 2.256 seconds.
2023-05-07 21:04:49,408 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:04:49,470 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:50,345 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:04:51,644 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 21:04:52,699 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:04:52,762 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:53,637 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:04:54,925 : [3/3] EVALUATION : Execution of _predict took at 2.172 seconds.
2023-05-07 21:04:55,973 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:04:56,035 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:04:56,918 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:04:58,202 : [3/3] EVALUATION : Execution of _predict took at 2.175 seconds.
2023-05-07 21:04:59,253 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:04:59,324 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:05:00,211 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 21:05:01,554 : [3/3] EVALUATION : Execution of _predict took at 2.247 seconds.
2023-05-07 21:05:02,841 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.178 seconds.
2023-05-07 21:05:02,841 : PIPELINE END : Execution of run took at 237.857 seconds.
d=0.0025, ns=2, nf=10


2023-05-07 21:05:02,876 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:05:02,876 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:05:04,071 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.195 seconds.
2023-05-07 21:05:04,406 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:05:04,865 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:05:04,878 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.002 seconds.
2023-05-07 21:05:04,878 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:05:04,878 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:05:04,878 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:05:04,878 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:05:06,938 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:05:06,939 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:06:56,201 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:06:56,201 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:07:04,727 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:07:04,727 : [2/3] TRAINING : Execution of ldlt took at 117.789 seconds.
2023-05-07 21:07:04,727 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:07:04,727 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:07:04,727 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:07:04,767 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:07:05,385 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:07:05,386 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:07:08,486 : [2/3] TRAINING : Execution of _umr_scan took at 3.100 seconds.
2023-05-07 21:07:09,100 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:07:09,100 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:07:32,333 : [2/3] TRAINING : Execution of _umr_scan took at 23.232 seconds.
2023-05-07 21:07:32,961 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:07:32,961 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:07:33,150 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.188 seconds.
2023-05-07 21:07:33,779 : [2/3] TRAINING : Current maximum residual: 0.79011318, relative Frobenius norm squared: 0.00620647
2023-05-07 21:07:33,779 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:07:33,950 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.170 seconds.
2023-05-07 21:07:34,570 : [2/3] TRAINING : Current maximum residual: 0.65701651, relative Frobenius norm squared: 0.00601973
2023-05-07 21:07:34,570 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:07:34,714 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.144 seconds.
2023-05-07 21:07:35,351 : [2/3] TRAINING : Current maximum residual: 0.29464275, relative Frobenius norm squared: 0.00586487
2023-05-07 21:07:35,351 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:07:35,511 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.160 seconds.
2023-05-07 21:07:36,134 : [2/3] TRAINING : Current maximum residual: 0.26774581, relative Frobenius norm squared: 0.00576440
2023-05-07 21:07:36,135 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:07:36,276 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.142 seconds.
2023-05-07 21:07:36,900 : [2/3] TRAINING : Current maximum residual: 0.25661892, relative Frobenius norm squared: 0.00567449
2023-05-07 21:07:36,900 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 21:07:37,008 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.107 seconds.
2023-05-07 21:07:37,631 : [2/3] TRAINING : Current maximum residual: 0.24786458, relative Frobenius norm squared: 0.00559355
2023-05-07 21:07:37,631 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 21:07:37,755 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.124 seconds.
2023-05-07 21:07:38,381 : [2/3] TRAINING : Current maximum residual: 0.24208313, relative Frobenius norm squared: 0.00551295
2023-05-07 21:07:38,381 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 21:07:38,501 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.120 seconds.
2023-05-07 21:07:39,126 : [2/3] TRAINING : Current maximum residual: 0.23632800, relative Frobenius norm squared: 0.00543674
2023-05-07 21:07:39,126 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 21:07:39,231 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.105 seconds.
2023-05-07 21:07:39,852 : [2/3] TRAINING : Current maximum residual: 0.23263740, relative Frobenius norm squared: 0.00536205
2023-05-07 21:07:39,852 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 21:07:39,975 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.122 seconds.
2023-05-07 21:07:40,599 : [2/3] TRAINING : Current maximum residual: 0.22799589, relative Frobenius norm squared: 0.00528713
2023-05-07 21:07:40,666 : [2/3] TRAINING : Execution of ainv_L took at 35.938 seconds.
2023-05-07 21:07:40,666 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:07:40,666 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:07:40,703 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:07:40,736 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:07:41,271 : [2/3] TRAINING : Execution of _construct_weights took at 154.332 seconds.
2023-05-07 21:07:41,272 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:07:41,272 : [2/3] TRAINING : Execution of _get_model took at 156.394 seconds.
2023-05-07 21:07:41,272 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:07:41,355 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 21:07:42,249 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 21:07:43,546 : [3/3] EVALUATION : Execution of _predict took at 2.215 seconds.
2023-05-07 21:07:44,607 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:07:44,683 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:07:45,564 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 21:07:46,834 : [3/3] EVALUATION : Execution of _predict took at 2.172 seconds.
2023-05-07 21:07:47,887 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:07:47,967 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 21:07:48,871 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 21:07:50,216 : [3/3] EVALUATION : Execution of _predict took at 2.274 seconds.
2023-05-07 21:07:51,272 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:07:51,347 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:07:52,240 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:07:53,569 : [3/3] EVALUATION : Execution of _predict took at 2.242 seconds.
2023-05-07 21:07:54,630 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:07:54,707 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:07:55,610 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 21:07:56,933 : [3/3] EVALUATION : Execution of _predict took at 2.248 seconds.
2023-05-07 21:07:57,978 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:07:58,055 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:07:58,947 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:08:00,263 : [3/3] EVALUATION : Execution of _predict took at 2.231 seconds.
2023-05-07 21:08:01,325 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:08:01,402 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:02,317 : [3/3] EVALUATION : Execution of _matmat took at 0.915 seconds.
2023-05-07 21:08:03,624 : [3/3] EVALUATION : Execution of _predict took at 2.244 seconds.
2023-05-07 21:08:04,674 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:08:04,750 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:08:05,636 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:08:06,924 : [3/3] EVALUATION : Execution of _predict took at 2.195 seconds.
2023-05-07 21:08:07,987 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:08:08,067 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 21:08:08,983 : [3/3] EVALUATION : Execution of _matmat took at 0.916 seconds.
2023-05-07 21:08:10,299 : [3/3] EVALUATION : Execution of _predict took at 2.257 seconds.
2023-05-07 21:08:11,365 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:08:11,441 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:12,343 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 21:08:13,617 : [3/3] EVALUATION : Execution of _predict took at 2.198 seconds.
2023-05-07 21:08:14,680 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:08:14,758 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:15,668 : [3/3] EVALUATION : Execution of _matmat took at 0.910 seconds.
2023-05-07 21:08:16,947 : [3/3] EVALUATION : Execution of _predict took at 2.211 seconds.
2023-05-07 21:08:17,993 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:08:18,072 : [3/3] EVALUATION : Execution of _matmat took at 0.025 seconds.
2023-05-07 21:08:18,965 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:08:20,327 : [3/3] EVALUATION : Execution of _predict took at 2.279 seconds.
2023-05-07 21:08:21,389 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:08:21,463 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 21:08:22,368 : [3/3] EVALUATION : Execution of _matmat took at 0.905 seconds.
2023-05-07 21:08:23,696 : [3/3] EVALUATION : Execution of _predict took at 2.252 seconds.
2023-05-07 21:08:24,754 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:08:24,829 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:25,722 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:08:27,016 : [3/3] EVALUATION : Execution of _predict took at 2.208 seconds.
2023-05-07 21:08:28,073 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:08:28,150 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:29,032 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:08:30,312 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 21:08:31,360 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:08:31,435 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:32,347 : [3/3] EVALUATION : Execution of _matmat took at 0.913 seconds.
2023-05-07 21:08:33,664 : [3/3] EVALUATION : Execution of _predict took at 2.251 seconds.
2023-05-07 21:08:34,730 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:08:34,808 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 21:08:35,696 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 21:08:37,040 : [3/3] EVALUATION : Execution of _predict took at 2.256 seconds.
2023-05-07 21:08:38,112 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:08:38,187 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:08:39,094 : [3/3] EVALUATION : Execution of _matmat took at 0.906 seconds.
2023-05-07 21:08:40,420 : [3/3] EVALUATION : Execution of _predict took at 2.254 seconds.
2023-05-07 21:08:41,471 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:08:41,547 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:42,446 : [3/3] EVALUATION : Execution of _matmat took at 0.899 seconds.
2023-05-07 21:08:43,751 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 21:08:44,810 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:08:44,885 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:08:45,789 : [3/3] EVALUATION : Execution of _matmat took at 0.903 seconds.
2023-05-07 21:08:47,067 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 21:08:48,113 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:08:48,192 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 21:08:49,114 : [3/3] EVALUATION : Execution of _matmat took at 0.921 seconds.
2023-05-07 21:08:50,443 : [3/3] EVALUATION : Execution of _predict took at 2.275 seconds.
2023-05-07 21:08:51,502 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:08:51,576 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:08:52,459 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:08:53,761 : [3/3] EVALUATION : Execution of _predict took at 2.206 seconds.
2023-05-07 21:08:54,816 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:08:54,891 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:08:55,773 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 21:08:57,063 : [3/3] EVALUATION : Execution of _predict took at 2.193 seconds.
2023-05-07 21:08:58,115 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:08:58,189 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:08:59,081 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:09:00,367 : [3/3] EVALUATION : Execution of _predict took at 2.199 seconds.
2023-05-07 21:09:01,418 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:09:01,496 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 21:09:02,391 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 21:09:03,735 : [3/3] EVALUATION : Execution of _predict took at 2.263 seconds.
2023-05-07 21:09:05,020 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.748 seconds.
2023-05-07 21:09:05,020 : PIPELINE END : Execution of run took at 242.144 seconds.
d=0.0025, ns=2, nf=20


2023-05-07 21:09:05,055 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:09:05,055 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:09:06,255 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.199 seconds.
2023-05-07 21:09:06,593 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:09:07,053 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:09:07,066 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.011 seconds.
2023-05-07 21:09:07,066 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:09:07,066 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:09:07,066 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:09:07,066 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:09:09,130 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:09:09,130 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:10:55,545 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:10:55,545 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:11:03,923 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:11:03,923 : [2/3] TRAINING : Execution of ldlt took at 114.793 seconds.
2023-05-07 21:11:03,923 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:11:03,923 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:11:03,923 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:11:03,962 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:11:04,561 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:11:04,562 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:11:07,620 : [2/3] TRAINING : Execution of _umr_scan took at 3.058 seconds.
2023-05-07 21:11:08,214 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:11:08,214 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:11:30,998 : [2/3] TRAINING : Execution of _umr_scan took at 22.784 seconds.
2023-05-07 21:11:31,598 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:11:31,598 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:11:31,787 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.189 seconds.
2023-05-07 21:11:32,392 : [2/3] TRAINING : Current maximum residual: 0.79011318, relative Frobenius norm squared: 0.00620647
2023-05-07 21:11:32,392 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:11:32,558 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.166 seconds.
2023-05-07 21:11:33,153 : [2/3] TRAINING : Current maximum residual: 0.65701651, relative Frobenius norm squared: 0.00601973
2023-05-07 21:11:33,153 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:11:33,295 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.142 seconds.
2023-05-07 21:11:33,909 : [2/3] TRAINING : Current maximum residual: 0.29464275, relative Frobenius norm squared: 0.00586487
2023-05-07 21:11:33,909 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:11:34,064 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.155 seconds.
2023-05-07 21:11:34,663 : [2/3] TRAINING : Current maximum residual: 0.26774581, relative Frobenius norm squared: 0.00576440
2023-05-07 21:11:34,664 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:11:34,803 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.139 seconds.
2023-05-07 21:11:35,400 : [2/3] TRAINING : Current maximum residual: 0.25661892, relative Frobenius norm squared: 0.00567449
2023-05-07 21:11:35,400 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 21:11:35,506 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.106 seconds.
2023-05-07 21:11:36,105 : [2/3] TRAINING : Current maximum residual: 0.24786458, relative Frobenius norm squared: 0.00559355
2023-05-07 21:11:36,105 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 21:11:36,227 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.122 seconds.
2023-05-07 21:11:36,829 : [2/3] TRAINING : Current maximum residual: 0.24208313, relative Frobenius norm squared: 0.00551295
2023-05-07 21:11:36,829 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 21:11:36,946 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.117 seconds.
2023-05-07 21:11:37,546 : [2/3] TRAINING : Current maximum residual: 0.23632800, relative Frobenius norm squared: 0.00543674
2023-05-07 21:11:37,546 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 21:11:37,649 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.103 seconds.
2023-05-07 21:11:38,245 : [2/3] TRAINING : Current maximum residual: 0.23263740, relative Frobenius norm squared: 0.00536205
2023-05-07 21:11:38,245 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 21:11:38,365 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.120 seconds.
2023-05-07 21:11:38,966 : [2/3] TRAINING : Current maximum residual: 0.22799589, relative Frobenius norm squared: 0.00528713
2023-05-07 21:11:38,966 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 21:11:39,082 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.116 seconds.
2023-05-07 21:11:39,683 : [2/3] TRAINING : Current maximum residual: 0.22451220, relative Frobenius norm squared: 0.00521359
2023-05-07 21:11:39,683 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 21:11:39,806 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.123 seconds.
2023-05-07 21:11:40,401 : [2/3] TRAINING : Current maximum residual: 0.22126841, relative Frobenius norm squared: 0.00514322
2023-05-07 21:11:40,401 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 21:11:40,512 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.111 seconds.
2023-05-07 21:11:41,126 : [2/3] TRAINING : Current maximum residual: 0.21822180, relative Frobenius norm squared: 0.00507038
2023-05-07 21:11:41,126 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 21:11:41,250 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.124 seconds.
2023-05-07 21:11:41,846 : [2/3] TRAINING : Current maximum residual: 0.21532326, relative Frobenius norm squared: 0.00499837
2023-05-07 21:11:41,846 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 21:11:41,961 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.115 seconds.
2023-05-07 21:11:42,573 : [2/3] TRAINING : Current maximum residual: 0.21305994, relative Frobenius norm squared: 0.00492570
2023-05-07 21:11:42,573 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 21:11:42,699 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.127 seconds.
2023-05-07 21:11:43,294 : [2/3] TRAINING : Current maximum residual: 0.21165736, relative Frobenius norm squared: 0.00485713
2023-05-07 21:11:43,294 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 21:11:43,418 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.124 seconds.
2023-05-07 21:11:44,018 : [2/3] TRAINING : Current maximum residual: 0.21143197, relative Frobenius norm squared: 0.00478888
2023-05-07 21:11:44,018 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 21:11:44,152 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.133 seconds.
2023-05-07 21:11:44,756 : [2/3] TRAINING : Current maximum residual: 0.21124777, relative Frobenius norm squared: 0.00472543
2023-05-07 21:11:44,756 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 21:11:44,879 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.122 seconds.
2023-05-07 21:11:45,481 : [2/3] TRAINING : Current maximum residual: 0.21119684, relative Frobenius norm squared: 0.00466144
2023-05-07 21:11:45,481 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 21:11:45,583 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.102 seconds.
2023-05-07 21:11:46,189 : [2/3] TRAINING : Current maximum residual: 0.21118256, relative Frobenius norm squared: 0.00459698
2023-05-07 21:11:46,250 : [2/3] TRAINING : Execution of ainv_L took at 42.327 seconds.
2023-05-07 21:11:46,250 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:11:46,250 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:11:46,298 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:11:46,334 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:11:46,857 : [2/3] TRAINING : Execution of _construct_weights took at 157.727 seconds.
2023-05-07 21:11:46,858 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:11:46,858 : [2/3] TRAINING : Execution of _get_model took at 159.792 seconds.
2023-05-07 21:11:46,858 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:11:46,932 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:11:47,803 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:11:49,099 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 21:11:50,157 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:11:50,227 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:11:51,087 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 21:11:52,353 : [3/3] EVALUATION : Execution of _predict took at 2.142 seconds.
2023-05-07 21:11:53,400 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:11:53,471 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:11:54,349 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 21:11:55,694 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 21:11:56,749 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:11:56,812 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:11:57,682 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:11:59,009 : [3/3] EVALUATION : Execution of _predict took at 2.205 seconds.
2023-05-07 21:12:00,072 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:12:00,135 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:01,020 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:12:02,340 : [3/3] EVALUATION : Execution of _predict took at 2.213 seconds.
2023-05-07 21:12:03,389 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:12:03,453 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:12:04,321 : [3/3] EVALUATION : Execution of _matmat took at 0.868 seconds.
2023-05-07 21:12:05,632 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 21:12:06,688 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:12:06,750 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:07,637 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 21:12:08,939 : [3/3] EVALUATION : Execution of _predict took at 2.197 seconds.
2023-05-07 21:12:09,983 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:12:10,046 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:10,901 : [3/3] EVALUATION : Execution of _matmat took at 0.854 seconds.
2023-05-07 21:12:12,185 : [3/3] EVALUATION : Execution of _predict took at 2.147 seconds.
2023-05-07 21:12:13,240 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:12:13,303 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:14,186 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:12:15,498 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 21:12:16,561 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:12:16,622 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:17,495 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:12:18,765 : [3/3] EVALUATION : Execution of _predict took at 2.151 seconds.
2023-05-07 21:12:19,824 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:12:19,887 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:20,770 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:12:22,045 : [3/3] EVALUATION : Execution of _predict took at 2.167 seconds.
2023-05-07 21:12:23,091 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:12:23,162 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:12:24,034 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:12:25,394 : [3/3] EVALUATION : Execution of _predict took at 2.249 seconds.
2023-05-07 21:12:26,455 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:12:26,525 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:12:27,407 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:12:28,735 : [3/3] EVALUATION : Execution of _predict took at 2.226 seconds.
2023-05-07 21:12:29,794 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:12:29,856 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:30,724 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 21:12:32,016 : [3/3] EVALUATION : Execution of _predict took at 2.169 seconds.
2023-05-07 21:12:33,068 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:12:33,131 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:33,989 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 21:12:35,265 : [3/3] EVALUATION : Execution of _predict took at 2.142 seconds.
2023-05-07 21:12:36,317 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:12:36,378 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:37,249 : [3/3] EVALUATION : Execution of _matmat took at 0.871 seconds.
2023-05-07 21:12:38,561 : [3/3] EVALUATION : Execution of _predict took at 2.192 seconds.
2023-05-07 21:12:39,615 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:12:39,686 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:12:40,546 : [3/3] EVALUATION : Execution of _matmat took at 0.860 seconds.
2023-05-07 21:12:41,889 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 21:12:42,968 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:12:43,030 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:43,912 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:12:45,235 : [3/3] EVALUATION : Execution of _predict took at 2.214 seconds.
2023-05-07 21:12:46,285 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:12:46,347 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:47,222 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:12:48,521 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 21:12:49,579 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:12:49,641 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:50,518 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 21:12:51,793 : [3/3] EVALUATION : Execution of _predict took at 2.160 seconds.
2023-05-07 21:12:52,829 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:12:52,900 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:12:53,796 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 21:12:55,124 : [3/3] EVALUATION : Execution of _predict took at 2.241 seconds.
2023-05-07 21:12:56,180 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:12:56,242 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:12:57,101 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 21:12:58,400 : [3/3] EVALUATION : Execution of _predict took at 2.167 seconds.
2023-05-07 21:12:59,457 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:12:59,520 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:13:00,382 : [3/3] EVALUATION : Execution of _matmat took at 0.862 seconds.
2023-05-07 21:13:01,671 : [3/3] EVALUATION : Execution of _predict took at 2.160 seconds.
2023-05-07 21:13:02,737 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:13:02,799 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:13:03,663 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 21:13:04,947 : [3/3] EVALUATION : Execution of _predict took at 2.156 seconds.
2023-05-07 21:13:05,991 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:13:06,061 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:13:06,941 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 21:13:08,285 : [3/3] EVALUATION : Execution of _predict took at 2.241 seconds.
2023-05-07 21:13:09,570 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.712 seconds.
2023-05-07 21:13:09,571 : PIPELINE END : Execution of run took at 244.515 seconds.
d=0.0025, ns=3, nf=0


2023-05-07 21:13:09,606 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:13:09,606 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:13:10,784 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.178 seconds.
2023-05-07 21:13:11,111 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:13:11,561 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:13:11,574 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.968 seconds.
2023-05-07 21:13:11,574 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:13:11,574 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:13:11,574 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:13:11,574 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:13:13,757 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:13:13,758 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:14:59,745 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:14:59,745 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:15:08,133 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:15:08,133 : [2/3] TRAINING : Execution of ldlt took at 114.376 seconds.
2023-05-07 21:15:08,133 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:15:08,133 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:15:08,133 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:15:08,172 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:15:08,772 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:15:08,772 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:15:11,834 : [2/3] TRAINING : Execution of _umr_scan took at 3.062 seconds.
2023-05-07 21:15:12,429 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:15:12,429 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:15:35,274 : [2/3] TRAINING : Execution of _umr_scan took at 22.845 seconds.
2023-05-07 21:15:35,873 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:15:35,873 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:16:07,047 : [2/3] TRAINING : Execution of _umr_scan took at 31.173 seconds.
2023-05-07 21:16:07,652 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:16:07,716 : [2/3] TRAINING : Execution of ainv_L took at 59.583 seconds.
2023-05-07 21:16:07,717 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:16:07,717 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:16:07,750 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:16:07,782 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:16:08,305 : [2/3] TRAINING : Execution of _construct_weights took at 174.548 seconds.
2023-05-07 21:16:08,306 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:16:08,306 : [2/3] TRAINING : Execution of _get_model took at 176.732 seconds.
2023-05-07 21:16:08,306 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:16:08,380 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:16:09,256 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:16:10,553 : [3/3] EVALUATION : Execution of _predict took at 2.191 seconds.
2023-05-07 21:16:11,613 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:16:11,687 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:12,552 : [3/3] EVALUATION : Execution of _matmat took at 0.865 seconds.
2023-05-07 21:16:13,819 : [3/3] EVALUATION : Execution of _predict took at 2.152 seconds.
2023-05-07 21:16:14,864 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:16:14,941 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:16:15,824 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:16:17,170 : [3/3] EVALUATION : Execution of _predict took at 2.251 seconds.
2023-05-07 21:16:18,219 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:16:18,293 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:19,173 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 21:16:20,500 : [3/3] EVALUATION : Execution of _predict took at 2.227 seconds.
2023-05-07 21:16:21,556 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:16:21,631 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:22,515 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:16:23,837 : [3/3] EVALUATION : Execution of _predict took at 2.227 seconds.
2023-05-07 21:16:24,880 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:16:24,954 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:25,823 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 21:16:27,139 : [3/3] EVALUATION : Execution of _predict took at 2.205 seconds.
2023-05-07 21:16:28,190 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:16:28,265 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:29,157 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:16:30,461 : [3/3] EVALUATION : Execution of _predict took at 2.216 seconds.
2023-05-07 21:16:31,511 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:16:31,585 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:32,446 : [3/3] EVALUATION : Execution of _matmat took at 0.860 seconds.
2023-05-07 21:16:33,734 : [3/3] EVALUATION : Execution of _predict took at 2.169 seconds.
2023-05-07 21:16:34,790 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:16:34,865 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:35,747 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:16:37,063 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 21:16:38,121 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:16:38,195 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:39,071 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:16:40,345 : [3/3] EVALUATION : Execution of _predict took at 2.171 seconds.
2023-05-07 21:16:41,404 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:16:41,478 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:42,366 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 21:16:43,643 : [3/3] EVALUATION : Execution of _predict took at 2.184 seconds.
2023-05-07 21:16:44,694 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:16:44,771 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:16:45,643 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:16:47,003 : [3/3] EVALUATION : Execution of _predict took at 2.255 seconds.
2023-05-07 21:16:48,061 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:16:48,134 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 21:16:49,028 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 21:16:50,356 : [3/3] EVALUATION : Execution of _predict took at 2.241 seconds.
2023-05-07 21:16:51,410 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:16:51,485 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:16:52,359 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:16:53,653 : [3/3] EVALUATION : Execution of _predict took at 2.190 seconds.
2023-05-07 21:16:54,708 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:16:54,782 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:16:55,644 : [3/3] EVALUATION : Execution of _matmat took at 0.861 seconds.
2023-05-07 21:16:56,923 : [3/3] EVALUATION : Execution of _predict took at 2.161 seconds.
2023-05-07 21:16:57,966 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:16:58,040 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:16:58,914 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 21:17:00,228 : [3/3] EVALUATION : Execution of _predict took at 2.209 seconds.
2023-05-07 21:17:01,290 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:17:01,367 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:17:02,236 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 21:17:03,577 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 21:17:04,648 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:17:04,722 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:17:05,606 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:17:06,929 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 21:17:07,980 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:17:08,054 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:17:08,937 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:17:10,240 : [3/3] EVALUATION : Execution of _predict took at 2.206 seconds.
2023-05-07 21:17:11,297 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:17:11,371 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:17:12,253 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:17:13,531 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 21:17:14,567 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:17:14,644 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:17:15,542 : [3/3] EVALUATION : Execution of _matmat took at 0.898 seconds.
2023-05-07 21:17:16,870 : [3/3] EVALUATION : Execution of _predict took at 2.249 seconds.
2023-05-07 21:17:17,925 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:17:17,997 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:17:18,863 : [3/3] EVALUATION : Execution of _matmat took at 0.866 seconds.
2023-05-07 21:17:20,165 : [3/3] EVALUATION : Execution of _predict took at 2.187 seconds.
2023-05-07 21:17:21,223 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:17:21,297 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:17:22,155 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 21:17:23,444 : [3/3] EVALUATION : Execution of _predict took at 2.168 seconds.
2023-05-07 21:17:24,495 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:17:24,569 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:17:25,436 : [3/3] EVALUATION : Execution of _matmat took at 0.867 seconds.
2023-05-07 21:17:26,708 : [3/3] EVALUATION : Execution of _predict took at 2.160 seconds.
2023-05-07 21:17:27,752 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:17:27,828 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:17:28,700 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:17:30,043 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 21:17:31,321 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.015 seconds.
2023-05-07 21:17:31,322 : PIPELINE END : Execution of run took at 261.716 seconds.
d=0.0025, ns=3, nf=5


2023-05-07 21:17:31,355 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:17:31,355 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:17:32,520 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.165 seconds.
2023-05-07 21:17:32,840 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:17:33,289 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:17:33,301 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.946 seconds.
2023-05-07 21:17:33,302 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:17:33,302 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:17:33,302 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:17:33,302 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:17:35,320 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:17:35,320 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:19:21,433 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:19:21,434 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:19:29,818 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:19:29,818 : [2/3] TRAINING : Execution of ldlt took at 114.498 seconds.
2023-05-07 21:19:29,818 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:19:29,818 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:19:29,818 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:19:29,842 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:19:30,436 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:19:30,436 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:19:33,497 : [2/3] TRAINING : Execution of _umr_scan took at 3.061 seconds.
2023-05-07 21:19:34,098 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:19:34,098 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:19:57,028 : [2/3] TRAINING : Execution of _umr_scan took at 22.930 seconds.
2023-05-07 21:19:57,629 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:19:57,629 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:20:29,045 : [2/3] TRAINING : Execution of _umr_scan took at 31.415 seconds.
2023-05-07 21:20:29,647 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:20:29,647 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:20:29,840 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.193 seconds.
2023-05-07 21:20:30,435 : [2/3] TRAINING : Current maximum residual: 0.65552315, relative Frobenius norm squared: 0.00170081
2023-05-07 21:20:30,435 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:20:30,630 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.195 seconds.
2023-05-07 21:20:31,226 : [2/3] TRAINING : Current maximum residual: 0.30015692, relative Frobenius norm squared: 0.00159472
2023-05-07 21:20:31,226 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:20:31,423 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.197 seconds.
2023-05-07 21:20:32,018 : [2/3] TRAINING : Current maximum residual: 0.21798663, relative Frobenius norm squared: 0.00155982
2023-05-07 21:20:32,018 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:20:32,208 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.189 seconds.
2023-05-07 21:20:32,816 : [2/3] TRAINING : Current maximum residual: 0.21466036, relative Frobenius norm squared: 0.00153307
2023-05-07 21:20:32,816 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:20:33,038 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.221 seconds.
2023-05-07 21:20:33,631 : [2/3] TRAINING : Current maximum residual: 0.21328874, relative Frobenius norm squared: 0.00151465
2023-05-07 21:20:33,700 : [2/3] TRAINING : Execution of ainv_L took at 63.882 seconds.
2023-05-07 21:20:33,700 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:20:33,700 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:20:33,730 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:20:33,751 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:20:34,286 : [2/3] TRAINING : Execution of _construct_weights took at 178.966 seconds.
2023-05-07 21:20:34,288 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:20:34,288 : [2/3] TRAINING : Execution of _get_model took at 180.986 seconds.
2023-05-07 21:20:34,288 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:20:34,362 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:20:35,233 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:20:36,531 : [3/3] EVALUATION : Execution of _predict took at 2.187 seconds.
2023-05-07 21:20:37,590 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:20:37,663 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 21:20:38,521 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 21:20:39,790 : [3/3] EVALUATION : Execution of _predict took at 2.146 seconds.
2023-05-07 21:20:40,832 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:20:40,910 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:20:41,790 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 21:20:43,136 : [3/3] EVALUATION : Execution of _predict took at 2.248 seconds.
2023-05-07 21:20:44,185 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:20:44,259 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 21:20:45,135 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:20:46,463 : [3/3] EVALUATION : Execution of _predict took at 2.224 seconds.
2023-05-07 21:20:47,511 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:20:47,586 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:20:48,466 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 21:20:49,789 : [3/3] EVALUATION : Execution of _predict took at 2.223 seconds.
2023-05-07 21:20:50,823 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:20:50,898 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:20:51,763 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 21:20:53,076 : [3/3] EVALUATION : Execution of _predict took at 2.198 seconds.
2023-05-07 21:20:54,122 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:20:54,197 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:20:55,082 : [3/3] EVALUATION : Execution of _matmat took at 0.886 seconds.
2023-05-07 21:20:56,387 : [3/3] EVALUATION : Execution of _predict took at 2.211 seconds.
2023-05-07 21:20:57,425 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:20:57,499 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:20:58,355 : [3/3] EVALUATION : Execution of _matmat took at 0.856 seconds.
2023-05-07 21:20:59,643 : [3/3] EVALUATION : Execution of _predict took at 2.164 seconds.
2023-05-07 21:21:00,693 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:21:00,769 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:21:01,648 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:21:02,965 : [3/3] EVALUATION : Execution of _predict took at 2.217 seconds.
2023-05-07 21:21:04,018 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:21:04,091 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:04,968 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:21:06,242 : [3/3] EVALUATION : Execution of _predict took at 2.171 seconds.
2023-05-07 21:21:07,294 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:21:07,369 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:08,253 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:21:09,531 : [3/3] EVALUATION : Execution of _predict took at 2.182 seconds.
2023-05-07 21:21:10,574 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:21:10,651 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:21:11,521 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:21:12,882 : [3/3] EVALUATION : Execution of _predict took at 2.254 seconds.
2023-05-07 21:21:13,930 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:21:14,004 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:14,887 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:21:16,216 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 21:21:17,271 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:21:17,341 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:21:18,214 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:21:19,508 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 21:21:20,562 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:21:20,637 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:21,495 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 21:21:22,773 : [3/3] EVALUATION : Execution of _predict took at 2.156 seconds.
2023-05-07 21:21:23,816 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:21:23,890 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:24,759 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:21:26,075 : [3/3] EVALUATION : Execution of _predict took at 2.205 seconds.
2023-05-07 21:21:27,136 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:21:27,213 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:21:28,074 : [3/3] EVALUATION : Execution of _matmat took at 0.861 seconds.
2023-05-07 21:21:29,415 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 21:21:30,482 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:21:30,555 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:31,436 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 21:21:32,759 : [3/3] EVALUATION : Execution of _predict took at 2.223 seconds.
2023-05-07 21:21:33,811 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:21:33,885 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:34,762 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 21:21:36,066 : [3/3] EVALUATION : Execution of _predict took at 2.201 seconds.
2023-05-07 21:21:37,116 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:21:37,190 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:38,069 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:21:39,346 : [3/3] EVALUATION : Execution of _predict took at 2.176 seconds.
2023-05-07 21:21:40,389 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:21:40,465 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:21:41,358 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:21:42,688 : [3/3] EVALUATION : Execution of _predict took at 2.245 seconds.
2023-05-07 21:21:43,740 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:21:43,813 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:44,674 : [3/3] EVALUATION : Execution of _matmat took at 0.861 seconds.
2023-05-07 21:21:45,973 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 21:21:47,031 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:21:47,105 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:21:47,967 : [3/3] EVALUATION : Execution of _matmat took at 0.862 seconds.
2023-05-07 21:21:49,258 : [3/3] EVALUATION : Execution of _predict took at 2.173 seconds.
2023-05-07 21:21:50,304 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:21:50,377 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:21:51,242 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 21:21:52,528 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 21:21:53,569 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:21:53,645 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:21:54,518 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:21:55,860 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 21:21:57,136 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.848 seconds.
2023-05-07 21:21:57,136 : PIPELINE END : Execution of run took at 265.781 seconds.
d=0.0025, ns=3, nf=10


2023-05-07 21:21:57,169 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:21:57,169 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:21:58,336 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.167 seconds.
2023-05-07 21:21:58,663 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:21:59,112 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:21:59,125 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.955 seconds.
2023-05-07 21:21:59,125 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:21:59,125 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:21:59,125 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:21:59,125 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:22:01,143 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:22:01,143 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:23:47,442 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:23:47,442 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:23:55,819 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:23:55,819 : [2/3] TRAINING : Execution of ldlt took at 114.676 seconds.
2023-05-07 21:23:55,819 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:23:55,819 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:23:55,819 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:23:55,838 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:23:56,432 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:23:56,432 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:23:59,506 : [2/3] TRAINING : Execution of _umr_scan took at 3.074 seconds.
2023-05-07 21:24:00,105 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:24:00,105 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:24:23,120 : [2/3] TRAINING : Execution of _umr_scan took at 23.015 seconds.
2023-05-07 21:24:23,723 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:24:23,723 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:24:55,126 : [2/3] TRAINING : Execution of _umr_scan took at 31.403 seconds.
2023-05-07 21:24:55,730 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:24:55,730 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:24:55,923 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.192 seconds.
2023-05-07 21:24:56,518 : [2/3] TRAINING : Current maximum residual: 0.65552315, relative Frobenius norm squared: 0.00170081
2023-05-07 21:24:56,518 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:24:56,713 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.195 seconds.
2023-05-07 21:24:57,309 : [2/3] TRAINING : Current maximum residual: 0.30015692, relative Frobenius norm squared: 0.00159472
2023-05-07 21:24:57,309 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:24:57,505 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.196 seconds.
2023-05-07 21:24:58,100 : [2/3] TRAINING : Current maximum residual: 0.21798663, relative Frobenius norm squared: 0.00155982
2023-05-07 21:24:58,100 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:24:58,290 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.190 seconds.
2023-05-07 21:24:58,900 : [2/3] TRAINING : Current maximum residual: 0.21466036, relative Frobenius norm squared: 0.00153307
2023-05-07 21:24:58,900 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:24:59,120 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.220 seconds.
2023-05-07 21:24:59,719 : [2/3] TRAINING : Current maximum residual: 0.21328874, relative Frobenius norm squared: 0.00151465
2023-05-07 21:24:59,719 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 21:24:59,928 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.209 seconds.
2023-05-07 21:25:00,538 : [2/3] TRAINING : Current maximum residual: 0.21305809, relative Frobenius norm squared: 0.00149822
2023-05-07 21:25:00,538 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 21:25:00,745 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.207 seconds.
2023-05-07 21:25:01,346 : [2/3] TRAINING : Current maximum residual: 0.21275584, relative Frobenius norm squared: 0.00148504
2023-05-07 21:25:01,346 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 21:25:01,549 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.203 seconds.
2023-05-07 21:25:02,154 : [2/3] TRAINING : Current maximum residual: 0.21263903, relative Frobenius norm squared: 0.00147674
2023-05-07 21:25:02,154 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 21:25:02,375 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.220 seconds.
2023-05-07 21:25:02,981 : [2/3] TRAINING : Current maximum residual: 0.21263427, relative Frobenius norm squared: 0.00146805
2023-05-07 21:25:02,981 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 21:25:03,191 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.210 seconds.
2023-05-07 21:25:03,804 : [2/3] TRAINING : Current maximum residual: 0.21261553, relative Frobenius norm squared: 0.00146200
2023-05-07 21:25:03,881 : [2/3] TRAINING : Execution of ainv_L took at 68.062 seconds.
2023-05-07 21:25:03,881 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:25:03,881 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:25:03,911 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:25:03,932 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:25:04,453 : [2/3] TRAINING : Execution of _construct_weights took at 183.310 seconds.
2023-05-07 21:25:04,454 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:25:04,455 : [2/3] TRAINING : Execution of _get_model took at 185.330 seconds.
2023-05-07 21:25:04,455 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:25:04,529 : [3/3] EVALUATION : Execution of _matmat took at 0.018 seconds.
2023-05-07 21:25:05,405 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:25:06,703 : [3/3] EVALUATION : Execution of _predict took at 2.192 seconds.
2023-05-07 21:25:07,760 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:25:07,834 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:08,694 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 21:25:09,963 : [3/3] EVALUATION : Execution of _predict took at 2.149 seconds.
2023-05-07 21:25:11,008 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:25:11,086 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:25:12,012 : [3/3] EVALUATION : Execution of _matmat took at 0.926 seconds.
2023-05-07 21:25:13,358 : [3/3] EVALUATION : Execution of _predict took at 2.295 seconds.
2023-05-07 21:25:14,406 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:25:14,482 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:25:15,381 : [3/3] EVALUATION : Execution of _matmat took at 0.899 seconds.
2023-05-07 21:25:16,710 : [3/3] EVALUATION : Execution of _predict took at 2.250 seconds.
2023-05-07 21:25:17,757 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:25:17,832 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:18,716 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:25:20,040 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 21:25:21,077 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:25:21,151 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:22,018 : [3/3] EVALUATION : Execution of _matmat took at 0.867 seconds.
2023-05-07 21:25:23,331 : [3/3] EVALUATION : Execution of _predict took at 2.200 seconds.
2023-05-07 21:25:24,383 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:25:24,457 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:25,348 : [3/3] EVALUATION : Execution of _matmat took at 0.891 seconds.
2023-05-07 21:25:26,653 : [3/3] EVALUATION : Execution of _predict took at 2.216 seconds.
2023-05-07 21:25:27,697 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:25:27,771 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:28,689 : [3/3] EVALUATION : Execution of _matmat took at 0.918 seconds.
2023-05-07 21:25:29,977 : [3/3] EVALUATION : Execution of _predict took at 2.226 seconds.
2023-05-07 21:25:31,020 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:25:31,096 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:25:31,974 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 21:25:33,291 : [3/3] EVALUATION : Execution of _predict took at 2.216 seconds.
2023-05-07 21:25:34,342 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:25:34,417 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:25:35,292 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:25:36,567 : [3/3] EVALUATION : Execution of _predict took at 2.171 seconds.
2023-05-07 21:25:37,621 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:25:37,696 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:38,580 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:25:39,857 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 21:25:40,893 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:25:40,970 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:25:41,844 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:25:43,203 : [3/3] EVALUATION : Execution of _predict took at 2.256 seconds.
2023-05-07 21:25:44,253 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:25:44,326 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 21:25:45,210 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:25:46,536 : [3/3] EVALUATION : Execution of _predict took at 2.229 seconds.
2023-05-07 21:25:47,591 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:25:47,665 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:48,539 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 21:25:49,830 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 21:25:50,878 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:25:50,953 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:51,814 : [3/3] EVALUATION : Execution of _matmat took at 0.860 seconds.
2023-05-07 21:25:53,094 : [3/3] EVALUATION : Execution of _predict took at 2.161 seconds.
2023-05-07 21:25:54,137 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:25:54,210 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:25:55,083 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:25:56,399 : [3/3] EVALUATION : Execution of _predict took at 2.209 seconds.
2023-05-07 21:25:57,456 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:25:57,532 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:25:58,402 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 21:25:59,745 : [3/3] EVALUATION : Execution of _predict took at 2.235 seconds.
2023-05-07 21:26:00,812 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:26:00,885 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:26:01,767 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:26:03,090 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 21:26:04,144 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:26:04,218 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:26:05,103 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:26:06,405 : [3/3] EVALUATION : Execution of _predict took at 2.207 seconds.
2023-05-07 21:26:07,463 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:26:07,537 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:26:08,447 : [3/3] EVALUATION : Execution of _matmat took at 0.910 seconds.
2023-05-07 21:26:09,724 : [3/3] EVALUATION : Execution of _predict took at 2.208 seconds.
2023-05-07 21:26:10,767 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:26:10,844 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:26:11,740 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 21:26:13,068 : [3/3] EVALUATION : Execution of _predict took at 2.247 seconds.
2023-05-07 21:26:14,120 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:26:14,193 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:26:15,058 : [3/3] EVALUATION : Execution of _matmat took at 0.865 seconds.
2023-05-07 21:26:16,357 : [3/3] EVALUATION : Execution of _predict took at 2.184 seconds.
2023-05-07 21:26:17,415 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:26:17,488 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:26:18,350 : [3/3] EVALUATION : Execution of _matmat took at 0.861 seconds.
2023-05-07 21:26:19,638 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 21:26:20,684 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:26:20,756 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:26:21,651 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 21:26:22,935 : [3/3] EVALUATION : Execution of _predict took at 2.199 seconds.
2023-05-07 21:26:23,975 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:26:24,051 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:26:24,927 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:26:26,270 : [3/3] EVALUATION : Execution of _predict took at 2.241 seconds.
2023-05-07 21:26:27,547 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.093 seconds.
2023-05-07 21:26:27,548 : PIPELINE END : Execution of run took at 270.379 seconds.
d=0.0025, ns=3, nf=20


2023-05-07 21:26:27,581 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:26:27,581 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:26:28,749 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.168 seconds.
2023-05-07 21:26:29,076 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:26:29,525 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:26:29,537 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.956 seconds.
2023-05-07 21:26:29,537 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:26:29,537 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:26:29,537 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:26:29,537 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:26:31,550 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:26:31,551 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:28:17,727 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:28:17,727 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:28:26,114 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:28:26,115 : [2/3] TRAINING : Execution of ldlt took at 114.564 seconds.
2023-05-07 21:28:26,115 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:28:26,115 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:28:26,115 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:28:26,133 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:28:26,726 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:28:26,726 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:28:29,796 : [2/3] TRAINING : Execution of _umr_scan took at 3.070 seconds.
2023-05-07 21:28:30,393 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:28:30,393 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:28:53,243 : [2/3] TRAINING : Execution of _umr_scan took at 22.850 seconds.
2023-05-07 21:28:53,846 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:28:53,846 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:29:25,250 : [2/3] TRAINING : Execution of _umr_scan took at 31.404 seconds.
2023-05-07 21:29:25,852 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:29:25,853 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:29:26,044 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.192 seconds.
2023-05-07 21:29:26,641 : [2/3] TRAINING : Current maximum residual: 0.65552315, relative Frobenius norm squared: 0.00170081
2023-05-07 21:29:26,642 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:29:26,837 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.196 seconds.
2023-05-07 21:29:27,434 : [2/3] TRAINING : Current maximum residual: 0.30015692, relative Frobenius norm squared: 0.00159472
2023-05-07 21:29:27,434 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:29:27,630 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.196 seconds.
2023-05-07 21:29:28,229 : [2/3] TRAINING : Current maximum residual: 0.21798663, relative Frobenius norm squared: 0.00155982
2023-05-07 21:29:28,229 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:29:28,420 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.191 seconds.
2023-05-07 21:29:29,027 : [2/3] TRAINING : Current maximum residual: 0.21466036, relative Frobenius norm squared: 0.00153307
2023-05-07 21:29:29,027 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:29:29,247 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.220 seconds.
2023-05-07 21:29:29,847 : [2/3] TRAINING : Current maximum residual: 0.21328874, relative Frobenius norm squared: 0.00151465
2023-05-07 21:29:29,847 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 21:29:30,058 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.211 seconds.
2023-05-07 21:29:30,665 : [2/3] TRAINING : Current maximum residual: 0.21305809, relative Frobenius norm squared: 0.00149822
2023-05-07 21:29:30,665 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 21:29:30,871 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.206 seconds.
2023-05-07 21:29:31,471 : [2/3] TRAINING : Current maximum residual: 0.21275584, relative Frobenius norm squared: 0.00148504
2023-05-07 21:29:31,471 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 21:29:31,674 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.203 seconds.
2023-05-07 21:29:32,279 : [2/3] TRAINING : Current maximum residual: 0.21263903, relative Frobenius norm squared: 0.00147674
2023-05-07 21:29:32,279 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 21:29:32,498 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.219 seconds.
2023-05-07 21:29:33,104 : [2/3] TRAINING : Current maximum residual: 0.21263427, relative Frobenius norm squared: 0.00146805
2023-05-07 21:29:33,104 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 21:29:33,314 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.210 seconds.
2023-05-07 21:29:33,928 : [2/3] TRAINING : Current maximum residual: 0.21261553, relative Frobenius norm squared: 0.00146200
2023-05-07 21:29:33,928 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 21:29:34,130 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.202 seconds.
2023-05-07 21:29:34,731 : [2/3] TRAINING : Current maximum residual: 0.21260835, relative Frobenius norm squared: 0.00145561
2023-05-07 21:29:34,731 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 21:29:34,932 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.201 seconds.
2023-05-07 21:29:35,560 : [2/3] TRAINING : Current maximum residual: 0.21260581, relative Frobenius norm squared: 0.00145108
2023-05-07 21:29:35,560 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 21:29:35,784 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.224 seconds.
2023-05-07 21:29:36,384 : [2/3] TRAINING : Current maximum residual: 0.21260507, relative Frobenius norm squared: 0.00144727
2023-05-07 21:29:36,384 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 21:29:36,618 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.233 seconds.
2023-05-07 21:29:37,220 : [2/3] TRAINING : Current maximum residual: 0.21260497, relative Frobenius norm squared: 0.00144489
2023-05-07 21:29:37,220 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 21:29:37,450 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.230 seconds.
2023-05-07 21:29:38,052 : [2/3] TRAINING : Current maximum residual: 0.21260507, relative Frobenius norm squared: 0.00144244
2023-05-07 21:29:38,052 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 21:29:38,279 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.226 seconds.
2023-05-07 21:29:38,893 : [2/3] TRAINING : Current maximum residual: 0.21260520, relative Frobenius norm squared: 0.00144069
2023-05-07 21:29:38,893 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 21:29:39,106 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.212 seconds.
2023-05-07 21:29:39,712 : [2/3] TRAINING : Current maximum residual: 0.21260531, relative Frobenius norm squared: 0.00143931
2023-05-07 21:29:39,712 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 21:29:39,943 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.231 seconds.
2023-05-07 21:29:40,558 : [2/3] TRAINING : Current maximum residual: 0.21260539, relative Frobenius norm squared: 0.00143763
2023-05-07 21:29:40,558 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 21:29:40,769 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.211 seconds.
2023-05-07 21:29:41,368 : [2/3] TRAINING : Current maximum residual: 0.21260545, relative Frobenius norm squared: 0.00143672
2023-05-07 21:29:41,368 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 21:29:41,591 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.223 seconds.
2023-05-07 21:29:42,197 : [2/3] TRAINING : Current maximum residual: 0.21260548, relative Frobenius norm squared: 0.00143551
2023-05-07 21:29:42,260 : [2/3] TRAINING : Execution of ainv_L took at 76.145 seconds.
2023-05-07 21:29:42,260 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:29:42,260 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:29:42,289 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:29:42,311 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:29:42,823 : [2/3] TRAINING : Execution of _construct_weights took at 191.273 seconds.
2023-05-07 21:29:42,824 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:29:42,824 : [2/3] TRAINING : Execution of _get_model took at 193.287 seconds.
2023-05-07 21:29:42,824 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:29:42,896 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:29:43,770 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:29:45,068 : [3/3] EVALUATION : Execution of _predict took at 2.188 seconds.
2023-05-07 21:29:46,124 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:29:46,187 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:29:47,048 : [3/3] EVALUATION : Execution of _matmat took at 0.860 seconds.
2023-05-07 21:29:48,315 : [3/3] EVALUATION : Execution of _predict took at 2.137 seconds.
2023-05-07 21:29:49,357 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:29:49,429 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:29:50,310 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 21:29:51,655 : [3/3] EVALUATION : Execution of _predict took at 2.243 seconds.
2023-05-07 21:29:52,702 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:29:52,768 : [3/3] EVALUATION : Execution of _matmat took at 0.012 seconds.
2023-05-07 21:29:53,649 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 21:29:54,974 : [3/3] EVALUATION : Execution of _predict took at 2.218 seconds.
2023-05-07 21:29:56,023 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:29:56,086 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:29:56,966 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:29:58,287 : [3/3] EVALUATION : Execution of _predict took at 2.209 seconds.
2023-05-07 21:29:59,324 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:29:59,387 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:00,257 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:30:01,568 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 21:30:02,621 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:30:02,684 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:03,577 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:30:04,880 : [3/3] EVALUATION : Execution of _predict took at 2.204 seconds.
2023-05-07 21:30:05,920 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:30:05,982 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:06,841 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 21:30:08,124 : [3/3] EVALUATION : Execution of _predict took at 2.150 seconds.
2023-05-07 21:30:09,177 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:30:09,240 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:10,122 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:30:11,436 : [3/3] EVALUATION : Execution of _predict took at 2.204 seconds.
2023-05-07 21:30:12,487 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:30:12,548 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:13,426 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 21:30:14,698 : [3/3] EVALUATION : Execution of _predict took at 2.158 seconds.
2023-05-07 21:30:15,750 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:30:15,813 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:16,701 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 21:30:17,976 : [3/3] EVALUATION : Execution of _predict took at 2.172 seconds.
2023-05-07 21:30:19,014 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:30:19,077 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:30:19,947 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:30:21,307 : [3/3] EVALUATION : Execution of _predict took at 2.239 seconds.
2023-05-07 21:30:22,359 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:30:22,422 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:23,307 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:30:24,635 : [3/3] EVALUATION : Execution of _predict took at 2.221 seconds.
2023-05-07 21:30:25,684 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:30:25,746 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:26,622 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:30:27,912 : [3/3] EVALUATION : Execution of _predict took at 2.174 seconds.
2023-05-07 21:30:28,958 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:30:29,021 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:29,882 : [3/3] EVALUATION : Execution of _matmat took at 0.861 seconds.
2023-05-07 21:30:31,159 : [3/3] EVALUATION : Execution of _predict took at 2.145 seconds.
2023-05-07 21:30:32,203 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:30:32,264 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:33,140 : [3/3] EVALUATION : Execution of _matmat took at 0.876 seconds.
2023-05-07 21:30:34,453 : [3/3] EVALUATION : Execution of _predict took at 2.197 seconds.
2023-05-07 21:30:35,510 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:30:35,573 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:36,443 : [3/3] EVALUATION : Execution of _matmat took at 0.871 seconds.
2023-05-07 21:30:37,786 : [3/3] EVALUATION : Execution of _predict took at 2.222 seconds.
2023-05-07 21:30:38,849 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:30:38,911 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:39,799 : [3/3] EVALUATION : Execution of _matmat took at 0.888 seconds.
2023-05-07 21:30:41,122 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 21:30:42,177 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:30:42,239 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:43,121 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:30:44,420 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 21:30:45,478 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:30:45,539 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:46,422 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:30:47,697 : [3/3] EVALUATION : Execution of _predict took at 2.166 seconds.
2023-05-07 21:30:48,738 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:30:48,802 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:30:49,698 : [3/3] EVALUATION : Execution of _matmat took at 0.896 seconds.
2023-05-07 21:30:51,025 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 21:30:52,080 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:30:52,141 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:53,003 : [3/3] EVALUATION : Execution of _matmat took at 0.862 seconds.
2023-05-07 21:30:54,303 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 21:30:55,355 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:30:55,418 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:56,280 : [3/3] EVALUATION : Execution of _matmat took at 0.861 seconds.
2023-05-07 21:30:57,566 : [3/3] EVALUATION : Execution of _predict took at 2.156 seconds.
2023-05-07 21:30:58,610 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:30:58,672 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:30:59,540 : [3/3] EVALUATION : Execution of _matmat took at 0.868 seconds.
2023-05-07 21:31:00,823 : [3/3] EVALUATION : Execution of _predict took at 2.160 seconds.
2023-05-07 21:31:01,868 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:31:01,930 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:31:02,805 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:31:04,147 : [3/3] EVALUATION : Execution of _predict took at 2.225 seconds.
2023-05-07 21:31:05,420 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.595 seconds.
2023-05-07 21:31:05,421 : PIPELINE END : Execution of run took at 277.840 seconds.
d=0.0025, ns=4, nf=0


2023-05-07 21:31:05,455 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:31:05,455 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:31:06,624 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.169 seconds.
2023-05-07 21:31:06,944 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:31:07,394 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:31:07,406 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.951 seconds.
2023-05-07 21:31:07,407 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:31:07,407 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:31:07,407 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:31:07,407 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:31:09,411 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:31:09,412 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:32:55,347 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:32:55,347 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:33:03,733 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:33:03,733 : [2/3] TRAINING : Execution of ldlt took at 114.321 seconds.
2023-05-07 21:33:03,733 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:33:03,733 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:33:03,733 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:33:03,751 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:33:04,347 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:33:04,347 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:33:07,458 : [2/3] TRAINING : Execution of _umr_scan took at 3.111 seconds.
2023-05-07 21:33:08,067 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:33:08,067 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:33:31,366 : [2/3] TRAINING : Execution of _umr_scan took at 23.298 seconds.
2023-05-07 21:33:31,990 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:33:31,990 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:34:04,364 : [2/3] TRAINING : Execution of _umr_scan took at 32.374 seconds.
2023-05-07 21:34:04,992 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:34:04,992 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 21:34:43,108 : [2/3] TRAINING : Execution of _umr_scan took at 38.116 seconds.
2023-05-07 21:34:43,738 : [2/3] TRAINING : Current maximum residual: 0.65249825, relative Frobenius norm squared: 0.00127518
2023-05-07 21:34:43,814 : [2/3] TRAINING : Execution of ainv_L took at 100.082 seconds.
2023-05-07 21:34:43,815 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:34:43,815 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:34:43,845 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:34:43,866 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:34:44,401 : [2/3] TRAINING : Execution of _construct_weights took at 214.990 seconds.
2023-05-07 21:34:44,402 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:34:44,403 : [2/3] TRAINING : Execution of _get_model took at 216.996 seconds.
2023-05-07 21:34:44,403 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:34:44,476 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:34:45,360 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:34:46,658 : [3/3] EVALUATION : Execution of _predict took at 2.199 seconds.
2023-05-07 21:34:47,702 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:34:47,778 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:34:48,676 : [3/3] EVALUATION : Execution of _matmat took at 0.897 seconds.
2023-05-07 21:34:49,945 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 21:34:50,980 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:34:51,059 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:34:51,948 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 21:34:53,292 : [3/3] EVALUATION : Execution of _predict took at 2.256 seconds.
2023-05-07 21:34:54,343 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:34:54,418 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:34:55,302 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:34:56,629 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 21:34:57,674 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:34:57,751 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:34:58,643 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:34:59,967 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 21:35:01,002 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:35:01,079 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:35:01,957 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 21:35:03,272 : [3/3] EVALUATION : Execution of _predict took at 2.215 seconds.
2023-05-07 21:35:04,316 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:35:04,392 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:35:05,291 : [3/3] EVALUATION : Execution of _matmat took at 0.899 seconds.
2023-05-07 21:35:06,595 : [3/3] EVALUATION : Execution of _predict took at 2.224 seconds.
2023-05-07 21:35:07,637 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:35:07,712 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:35:08,580 : [3/3] EVALUATION : Execution of _matmat took at 0.868 seconds.
2023-05-07 21:35:09,867 : [3/3] EVALUATION : Execution of _predict took at 2.176 seconds.
2023-05-07 21:35:10,912 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:35:10,989 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:35:11,883 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:35:13,199 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 21:35:14,247 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:35:14,322 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:35:15,207 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:35:16,480 : [3/3] EVALUATION : Execution of _predict took at 2.179 seconds.
2023-05-07 21:35:17,538 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:35:17,612 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:35:18,508 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 21:35:19,784 : [3/3] EVALUATION : Execution of _predict took at 2.191 seconds.
2023-05-07 21:35:20,820 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:35:20,898 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:35:21,777 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:35:23,137 : [3/3] EVALUATION : Execution of _predict took at 2.262 seconds.
2023-05-07 21:35:24,179 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:35:24,252 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 21:35:25,141 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 21:35:26,470 : [3/3] EVALUATION : Execution of _predict took at 2.236 seconds.
2023-05-07 21:35:27,522 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:35:27,596 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:35:28,480 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:35:29,772 : [3/3] EVALUATION : Execution of _predict took at 2.197 seconds.
2023-05-07 21:35:30,823 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:35:30,899 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:35:31,807 : [3/3] EVALUATION : Execution of _matmat took at 0.908 seconds.
2023-05-07 21:35:33,088 : [3/3] EVALUATION : Execution of _predict took at 2.210 seconds.
2023-05-07 21:35:34,125 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:35:34,200 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:35:35,083 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:35:36,397 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 21:35:37,445 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:35:37,521 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:35:38,394 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:35:39,741 : [3/3] EVALUATION : Execution of _predict took at 2.241 seconds.
2023-05-07 21:35:40,801 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:35:40,876 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:35:41,768 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:35:43,093 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 21:35:44,136 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:35:44,212 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:35:45,109 : [3/3] EVALUATION : Execution of _matmat took at 0.897 seconds.
2023-05-07 21:35:46,412 : [3/3] EVALUATION : Execution of _predict took at 2.221 seconds.
2023-05-07 21:35:47,462 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:35:47,536 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:35:48,429 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:35:49,706 : [3/3] EVALUATION : Execution of _predict took at 2.191 seconds.
2023-05-07 21:35:50,737 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:35:50,815 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:35:51,727 : [3/3] EVALUATION : Execution of _matmat took at 0.912 seconds.
2023-05-07 21:35:53,055 : [3/3] EVALUATION : Execution of _predict took at 2.264 seconds.
2023-05-07 21:35:54,107 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:35:54,181 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:35:55,057 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:35:56,357 : [3/3] EVALUATION : Execution of _predict took at 2.197 seconds.
2023-05-07 21:35:57,410 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:35:57,486 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:35:58,359 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:35:59,649 : [3/3] EVALUATION : Execution of _predict took at 2.185 seconds.
2023-05-07 21:36:00,696 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:36:00,771 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:36:01,653 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:36:02,939 : [3/3] EVALUATION : Execution of _predict took at 2.189 seconds.
2023-05-07 21:36:03,980 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:36:04,055 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:36:04,942 : [3/3] EVALUATION : Execution of _matmat took at 0.886 seconds.
2023-05-07 21:36:06,287 : [3/3] EVALUATION : Execution of _predict took at 2.253 seconds.
2023-05-07 21:36:07,566 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.164 seconds.
2023-05-07 21:36:07,567 : PIPELINE END : Execution of run took at 302.112 seconds.
d=0.0025, ns=4, nf=5


2023-05-07 21:36:07,600 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:36:07,601 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:36:08,803 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.202 seconds.
2023-05-07 21:36:09,139 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:36:09,599 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:36:09,612 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.012 seconds.
2023-05-07 21:36:09,612 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:36:09,612 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:36:09,612 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:36:09,612 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:36:11,660 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:36:11,660 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:38:01,612 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:38:01,612 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:38:10,217 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:38:10,218 : [2/3] TRAINING : Execution of ldlt took at 118.557 seconds.
2023-05-07 21:38:10,218 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:38:10,218 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:38:10,218 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:38:10,237 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:38:10,862 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:38:10,862 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:38:14,035 : [2/3] TRAINING : Execution of _umr_scan took at 3.173 seconds.
2023-05-07 21:38:14,661 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:38:14,661 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:38:37,979 : [2/3] TRAINING : Execution of _umr_scan took at 23.318 seconds.
2023-05-07 21:38:38,603 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:38:38,604 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:39:10,951 : [2/3] TRAINING : Execution of _umr_scan took at 32.348 seconds.
2023-05-07 21:39:11,577 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:39:11,577 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 21:39:49,610 : [2/3] TRAINING : Execution of _umr_scan took at 38.033 seconds.
2023-05-07 21:39:50,239 : [2/3] TRAINING : Current maximum residual: 0.65249825, relative Frobenius norm squared: 0.00127518
2023-05-07 21:39:50,239 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:39:50,459 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.219 seconds.
2023-05-07 21:39:51,091 : [2/3] TRAINING : Current maximum residual: 0.29719472, relative Frobenius norm squared: 0.00118895
2023-05-07 21:39:51,091 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:39:51,309 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.219 seconds.
2023-05-07 21:39:51,944 : [2/3] TRAINING : Current maximum residual: 0.21830640, relative Frobenius norm squared: 0.00117481
2023-05-07 21:39:51,944 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:39:52,137 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.193 seconds.
2023-05-07 21:39:52,772 : [2/3] TRAINING : Current maximum residual: 0.21486974, relative Frobenius norm squared: 0.00116755
2023-05-07 21:39:52,773 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:39:52,997 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.224 seconds.
2023-05-07 21:39:53,633 : [2/3] TRAINING : Current maximum residual: 0.21413998, relative Frobenius norm squared: 0.00116392
2023-05-07 21:39:53,633 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:39:53,847 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.213 seconds.
2023-05-07 21:39:54,476 : [2/3] TRAINING : Current maximum residual: 0.21404043, relative Frobenius norm squared: 0.00116084
2023-05-07 21:39:54,550 : [2/3] TRAINING : Execution of ainv_L took at 104.332 seconds.
2023-05-07 21:39:54,550 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:39:54,550 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:39:54,580 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:39:54,602 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:39:55,140 : [2/3] TRAINING : Execution of _construct_weights took at 223.480 seconds.
2023-05-07 21:39:55,141 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:39:55,141 : [2/3] TRAINING : Execution of _get_model took at 225.529 seconds.
2023-05-07 21:39:55,142 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:39:55,219 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:39:56,104 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:39:57,401 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 21:39:58,454 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:39:58,530 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:39:59,404 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 21:40:00,673 : [3/3] EVALUATION : Execution of _predict took at 2.164 seconds.
2023-05-07 21:40:01,712 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:40:01,791 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:40:02,685 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 21:40:04,030 : [3/3] EVALUATION : Execution of _predict took at 2.263 seconds.
2023-05-07 21:40:05,085 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:40:05,161 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:06,043 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:40:07,373 : [3/3] EVALUATION : Execution of _predict took at 2.233 seconds.
2023-05-07 21:40:08,425 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:40:08,502 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:09,394 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:40:10,716 : [3/3] EVALUATION : Execution of _predict took at 2.236 seconds.
2023-05-07 21:40:11,761 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:40:11,837 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:40:12,716 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 21:40:14,031 : [3/3] EVALUATION : Execution of _predict took at 2.215 seconds.
2023-05-07 21:40:15,081 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:40:15,156 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:16,058 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 21:40:17,362 : [3/3] EVALUATION : Execution of _predict took at 2.227 seconds.
2023-05-07 21:40:18,406 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:40:18,482 : [3/3] EVALUATION : Execution of _matmat took at 0.022 seconds.
2023-05-07 21:40:19,354 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:40:20,641 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 21:40:21,694 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:40:21,771 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:22,669 : [3/3] EVALUATION : Execution of _matmat took at 0.898 seconds.
2023-05-07 21:40:23,985 : [3/3] EVALUATION : Execution of _predict took at 2.235 seconds.
2023-05-07 21:40:25,040 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:40:25,115 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:26,005 : [3/3] EVALUATION : Execution of _matmat took at 0.890 seconds.
2023-05-07 21:40:27,278 : [3/3] EVALUATION : Execution of _predict took at 2.184 seconds.
2023-05-07 21:40:28,334 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:40:28,409 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:40:29,307 : [3/3] EVALUATION : Execution of _matmat took at 0.898 seconds.
2023-05-07 21:40:30,584 : [3/3] EVALUATION : Execution of _predict took at 2.196 seconds.
2023-05-07 21:40:31,625 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:40:31,703 : [3/3] EVALUATION : Execution of _matmat took at 0.023 seconds.
2023-05-07 21:40:32,585 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:40:33,945 : [3/3] EVALUATION : Execution of _predict took at 2.266 seconds.
2023-05-07 21:40:34,992 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:40:35,066 : [3/3] EVALUATION : Execution of _matmat took at 0.019 seconds.
2023-05-07 21:40:35,960 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 21:40:37,288 : [3/3] EVALUATION : Execution of _predict took at 2.241 seconds.
2023-05-07 21:40:38,341 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:40:38,416 : [3/3] EVALUATION : Execution of _matmat took at 0.020 seconds.
2023-05-07 21:40:39,305 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 21:40:40,599 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 21:40:41,651 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:40:41,727 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:42,598 : [3/3] EVALUATION : Execution of _matmat took at 0.871 seconds.
2023-05-07 21:40:43,875 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 21:40:44,920 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:40:44,994 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:45,877 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:40:47,191 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 21:40:48,240 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:40:48,316 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:49,189 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:40:50,533 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 21:40:51,601 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:40:51,676 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:52,568 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:40:53,894 : [3/3] EVALUATION : Execution of _predict took at 2.238 seconds.
2023-05-07 21:40:54,943 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:40:55,019 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:55,911 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:40:57,212 : [3/3] EVALUATION : Execution of _predict took at 2.214 seconds.
2023-05-07 21:40:58,260 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:40:58,335 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:40:59,229 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 21:41:00,506 : [3/3] EVALUATION : Execution of _predict took at 2.192 seconds.
2023-05-07 21:41:01,539 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:41:01,619 : [3/3] EVALUATION : Execution of _matmat took at 0.024 seconds.
2023-05-07 21:41:02,534 : [3/3] EVALUATION : Execution of _matmat took at 0.915 seconds.
2023-05-07 21:41:03,863 : [3/3] EVALUATION : Execution of _predict took at 2.268 seconds.
2023-05-07 21:41:04,920 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:41:04,994 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:41:05,869 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:41:07,169 : [3/3] EVALUATION : Execution of _predict took at 2.196 seconds.
2023-05-07 21:41:08,223 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:41:08,298 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:41:09,170 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:41:10,459 : [3/3] EVALUATION : Execution of _predict took at 2.182 seconds.
2023-05-07 21:41:11,507 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:41:11,582 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:41:12,464 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:41:13,748 : [3/3] EVALUATION : Execution of _predict took at 2.187 seconds.
2023-05-07 21:41:14,791 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:41:14,866 : [3/3] EVALUATION : Execution of _matmat took at 0.021 seconds.
2023-05-07 21:41:15,753 : [3/3] EVALUATION : Execution of _matmat took at 0.886 seconds.
2023-05-07 21:41:17,097 : [3/3] EVALUATION : Execution of _predict took at 2.252 seconds.
2023-05-07 21:41:18,378 : [3/3] EVALUATION : Execution of _evaluate_model took at 83.237 seconds.
2023-05-07 21:41:18,379 : PIPELINE END : Execution of run took at 310.779 seconds.
d=0.0025, ns=4, nf=10


2023-05-07 21:41:18,412 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:41:18,412 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:41:19,613 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.201 seconds.
2023-05-07 21:41:19,950 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:41:20,409 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:41:20,422 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.010 seconds.
2023-05-07 21:41:20,422 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:41:20,423 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:41:20,423 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:41:20,423 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:41:22,488 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:41:22,488 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:43:12,731 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:43:12,731 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:43:21,325 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:43:21,325 : [2/3] TRAINING : Execution of ldlt took at 118.837 seconds.
2023-05-07 21:43:21,325 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:43:21,325 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:43:21,325 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:43:21,348 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:43:21,966 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:43:21,966 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:43:25,102 : [2/3] TRAINING : Execution of _umr_scan took at 3.136 seconds.
2023-05-07 21:43:25,723 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:43:25,723 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:43:49,109 : [2/3] TRAINING : Execution of _umr_scan took at 23.386 seconds.
2023-05-07 21:43:49,734 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:43:49,734 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:44:20,525 : [2/3] TRAINING : Execution of _umr_scan took at 30.790 seconds.
2023-05-07 21:44:21,154 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:44:21,155 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 21:44:59,245 : [2/3] TRAINING : Execution of _umr_scan took at 38.090 seconds.
2023-05-07 21:44:59,857 : [2/3] TRAINING : Current maximum residual: 0.65249825, relative Frobenius norm squared: 0.00127518
2023-05-07 21:44:59,857 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:45:00,068 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.211 seconds.
2023-05-07 21:45:00,683 : [2/3] TRAINING : Current maximum residual: 0.29719472, relative Frobenius norm squared: 0.00118895
2023-05-07 21:45:00,683 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:45:00,894 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.211 seconds.
2023-05-07 21:45:01,505 : [2/3] TRAINING : Current maximum residual: 0.21830640, relative Frobenius norm squared: 0.00117481
2023-05-07 21:45:01,505 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:45:01,699 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.194 seconds.
2023-05-07 21:45:02,303 : [2/3] TRAINING : Current maximum residual: 0.21486974, relative Frobenius norm squared: 0.00116755
2023-05-07 21:45:02,304 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:45:02,515 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.212 seconds.
2023-05-07 21:45:03,134 : [2/3] TRAINING : Current maximum residual: 0.21413998, relative Frobenius norm squared: 0.00116392
2023-05-07 21:45:03,134 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:45:03,346 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.212 seconds.
2023-05-07 21:45:03,950 : [2/3] TRAINING : Current maximum residual: 0.21404043, relative Frobenius norm squared: 0.00116084
2023-05-07 21:45:03,951 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 21:45:04,181 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.231 seconds.
2023-05-07 21:45:04,789 : [2/3] TRAINING : Current maximum residual: 0.21398808, relative Frobenius norm squared: 0.00115874
2023-05-07 21:45:04,789 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 21:45:05,034 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.244 seconds.
2023-05-07 21:45:05,644 : [2/3] TRAINING : Current maximum residual: 0.21396507, relative Frobenius norm squared: 0.00115734
2023-05-07 21:45:05,644 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 21:45:05,863 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.218 seconds.
2023-05-07 21:45:06,475 : [2/3] TRAINING : Current maximum residual: 0.21395478, relative Frobenius norm squared: 0.00115573
2023-05-07 21:45:06,475 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 21:45:06,692 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.217 seconds.
2023-05-07 21:45:07,302 : [2/3] TRAINING : Current maximum residual: 0.21395018, relative Frobenius norm squared: 0.00115479
2023-05-07 21:45:07,303 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 21:45:07,509 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.207 seconds.
2023-05-07 21:45:08,111 : [2/3] TRAINING : Current maximum residual: 0.21394816, relative Frobenius norm squared: 0.00115408
2023-05-07 21:45:08,174 : [2/3] TRAINING : Execution of ainv_L took at 106.849 seconds.
2023-05-07 21:45:08,174 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:45:08,174 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:45:08,203 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:45:08,224 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:45:08,743 : [2/3] TRAINING : Execution of _construct_weights took at 226.255 seconds.
2023-05-07 21:45:08,744 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:45:08,744 : [2/3] TRAINING : Execution of _get_model took at 228.321 seconds.
2023-05-07 21:45:08,744 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:45:08,816 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:45:09,689 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:45:10,984 : [3/3] EVALUATION : Execution of _predict took at 2.184 seconds.
2023-05-07 21:45:12,035 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:45:12,098 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:12,958 : [3/3] EVALUATION : Execution of _matmat took at 0.860 seconds.
2023-05-07 21:45:14,225 : [3/3] EVALUATION : Execution of _predict took at 2.135 seconds.
2023-05-07 21:45:15,261 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:45:15,332 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:45:16,211 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:45:17,556 : [3/3] EVALUATION : Execution of _predict took at 2.240 seconds.
2023-05-07 21:45:18,608 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:45:18,671 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:45:19,546 : [3/3] EVALUATION : Execution of _matmat took at 0.875 seconds.
2023-05-07 21:45:20,873 : [3/3] EVALUATION : Execution of _predict took at 2.211 seconds.
2023-05-07 21:45:21,923 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:45:21,986 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:22,866 : [3/3] EVALUATION : Execution of _matmat took at 0.880 seconds.
2023-05-07 21:45:24,187 : [3/3] EVALUATION : Execution of _predict took at 2.209 seconds.
2023-05-07 21:45:25,226 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:45:25,289 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:45:26,159 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 21:45:27,472 : [3/3] EVALUATION : Execution of _predict took at 2.191 seconds.
2023-05-07 21:45:28,516 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:45:28,579 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:29,471 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:45:30,773 : [3/3] EVALUATION : Execution of _predict took at 2.202 seconds.
2023-05-07 21:45:31,818 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:45:31,880 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:32,737 : [3/3] EVALUATION : Execution of _matmat took at 0.858 seconds.
2023-05-07 21:45:34,023 : [3/3] EVALUATION : Execution of _predict took at 2.151 seconds.
2023-05-07 21:45:35,069 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:45:35,133 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:45:36,018 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:45:37,330 : [3/3] EVALUATION : Execution of _predict took at 2.206 seconds.
2023-05-07 21:45:38,380 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:45:38,441 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:39,321 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:45:40,592 : [3/3] EVALUATION : Execution of _predict took at 2.159 seconds.
2023-05-07 21:45:41,643 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:45:41,706 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:42,592 : [3/3] EVALUATION : Execution of _matmat took at 0.886 seconds.
2023-05-07 21:45:43,865 : [3/3] EVALUATION : Execution of _predict took at 2.168 seconds.
2023-05-07 21:45:44,902 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:45:44,973 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:45:45,843 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:45:47,203 : [3/3] EVALUATION : Execution of _predict took at 2.246 seconds.
2023-05-07 21:45:48,247 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:45:48,318 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:45:49,200 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:45:50,528 : [3/3] EVALUATION : Execution of _predict took at 2.226 seconds.
2023-05-07 21:45:51,575 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:45:51,637 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:52,509 : [3/3] EVALUATION : Execution of _matmat took at 0.872 seconds.
2023-05-07 21:45:53,800 : [3/3] EVALUATION : Execution of _predict took at 2.171 seconds.
2023-05-07 21:45:54,854 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:45:54,917 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:45:55,774 : [3/3] EVALUATION : Execution of _matmat took at 0.857 seconds.
2023-05-07 21:45:57,049 : [3/3] EVALUATION : Execution of _predict took at 2.140 seconds.
2023-05-07 21:45:58,089 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:45:58,150 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:45:59,027 : [3/3] EVALUATION : Execution of _matmat took at 0.877 seconds.
2023-05-07 21:46:00,339 : [3/3] EVALUATION : Execution of _predict took at 2.197 seconds.
2023-05-07 21:46:01,388 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:46:01,452 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:46:02,316 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 21:46:03,661 : [3/3] EVALUATION : Execution of _predict took at 2.218 seconds.
2023-05-07 21:46:04,723 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:46:04,793 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:46:05,672 : [3/3] EVALUATION : Execution of _matmat took at 0.878 seconds.
2023-05-07 21:46:06,995 : [3/3] EVALUATION : Execution of _predict took at 2.219 seconds.
2023-05-07 21:46:08,038 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:46:08,100 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:46:08,984 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:46:10,284 : [3/3] EVALUATION : Execution of _predict took at 2.192 seconds.
2023-05-07 21:46:11,328 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:46:11,390 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:46:12,269 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:46:13,541 : [3/3] EVALUATION : Execution of _predict took at 2.160 seconds.
2023-05-07 21:46:14,582 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:46:14,653 : [3/3] EVALUATION : Execution of _matmat took at 0.016 seconds.
2023-05-07 21:46:15,604 : [3/3] EVALUATION : Execution of _matmat took at 0.951 seconds.
2023-05-07 21:46:16,930 : [3/3] EVALUATION : Execution of _predict took at 2.294 seconds.
2023-05-07 21:46:17,980 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:46:18,041 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:46:18,905 : [3/3] EVALUATION : Execution of _matmat took at 0.864 seconds.
2023-05-07 21:46:20,203 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 21:46:21,257 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:46:21,320 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:46:22,179 : [3/3] EVALUATION : Execution of _matmat took at 0.859 seconds.
2023-05-07 21:46:23,465 : [3/3] EVALUATION : Execution of _predict took at 2.153 seconds.
2023-05-07 21:46:24,515 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:46:24,577 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:46:25,444 : [3/3] EVALUATION : Execution of _matmat took at 0.867 seconds.
2023-05-07 21:46:26,727 : [3/3] EVALUATION : Execution of _predict took at 2.159 seconds.
2023-05-07 21:46:27,765 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:46:27,828 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:46:28,703 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 21:46:30,047 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 21:46:31,313 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.570 seconds.
2023-05-07 21:46:31,314 : PIPELINE END : Execution of run took at 312.902 seconds.
d=0.0025, ns=4, nf=20


2023-05-07 21:46:31,347 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:46:31,347 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:46:32,519 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.172 seconds.
2023-05-07 21:46:32,843 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:46:33,294 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:46:33,306 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.959 seconds.
2023-05-07 21:46:33,306 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:46:33,306 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:46:33,306 : [2/3] TRAINING : Training SANSA with L2=200, target density=0.250000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:46:33,306 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:46:35,394 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:46:35,394 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:48:22,223 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:48:22,223 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:48:30,635 : [2/3] TRAINING : sparsified L info | nnz: 4231249, size: 50.940 MB, density: 0.250000%
2023-05-07 21:48:30,636 : [2/3] TRAINING : Execution of ldlt took at 115.241 seconds.
2023-05-07 21:48:30,636 : [2/3] TRAINING : nnz of L: 4231249, size: 50.940 MB
2023-05-07 21:48:30,636 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:48:30,636 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:48:30,654 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:48:31,253 : [2/3] TRAINING : Current maximum residual: 8.19402804, relative Frobenius norm squared: 0.13654023
2023-05-07 21:48:31,253 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 21:48:34,347 : [2/3] TRAINING : Execution of _umr_scan took at 3.094 seconds.
2023-05-07 21:48:34,948 : [2/3] TRAINING : Current maximum residual: 2.02750949, relative Frobenius norm squared: 0.08401546
2023-05-07 21:48:34,949 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 21:48:57,878 : [2/3] TRAINING : Execution of _umr_scan took at 22.929 seconds.
2023-05-07 21:48:58,482 : [2/3] TRAINING : Current maximum residual: 0.85055184, relative Frobenius norm squared: 0.00641166
2023-05-07 21:48:58,482 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 21:49:28,909 : [2/3] TRAINING : Execution of _umr_scan took at 30.427 seconds.
2023-05-07 21:49:29,540 : [2/3] TRAINING : Current maximum residual: 0.78943157, relative Frobenius norm squared: 0.00185556
2023-05-07 21:49:29,541 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 21:50:06,237 : [2/3] TRAINING : Execution of _umr_scan took at 36.696 seconds.
2023-05-07 21:50:06,869 : [2/3] TRAINING : Current maximum residual: 0.65249825, relative Frobenius norm squared: 0.00127518
2023-05-07 21:50:06,869 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:50:07,078 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.208 seconds.
2023-05-07 21:50:07,718 : [2/3] TRAINING : Current maximum residual: 0.29719472, relative Frobenius norm squared: 0.00118895
2023-05-07 21:50:07,718 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:50:07,945 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.227 seconds.
2023-05-07 21:50:08,576 : [2/3] TRAINING : Current maximum residual: 0.21830640, relative Frobenius norm squared: 0.00117481
2023-05-07 21:50:08,576 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:50:08,763 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.187 seconds.
2023-05-07 21:50:09,397 : [2/3] TRAINING : Current maximum residual: 0.21486974, relative Frobenius norm squared: 0.00116755
2023-05-07 21:50:09,397 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:50:09,618 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.221 seconds.
2023-05-07 21:50:10,254 : [2/3] TRAINING : Current maximum residual: 0.21413998, relative Frobenius norm squared: 0.00116392
2023-05-07 21:50:10,254 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:50:10,464 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.210 seconds.
2023-05-07 21:50:11,088 : [2/3] TRAINING : Current maximum residual: 0.21404043, relative Frobenius norm squared: 0.00116084
2023-05-07 21:50:11,088 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 21:50:11,321 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.233 seconds.
2023-05-07 21:50:11,941 : [2/3] TRAINING : Current maximum residual: 0.21398808, relative Frobenius norm squared: 0.00115874
2023-05-07 21:50:11,941 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 21:50:12,178 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.237 seconds.
2023-05-07 21:50:12,814 : [2/3] TRAINING : Current maximum residual: 0.21396507, relative Frobenius norm squared: 0.00115734
2023-05-07 21:50:12,814 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 21:50:13,034 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.220 seconds.
2023-05-07 21:50:13,657 : [2/3] TRAINING : Current maximum residual: 0.21395478, relative Frobenius norm squared: 0.00115573
2023-05-07 21:50:13,657 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 21:50:13,868 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.211 seconds.
2023-05-07 21:50:14,502 : [2/3] TRAINING : Current maximum residual: 0.21395018, relative Frobenius norm squared: 0.00115479
2023-05-07 21:50:14,502 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 21:50:14,708 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.206 seconds.
2023-05-07 21:50:15,329 : [2/3] TRAINING : Current maximum residual: 0.21394816, relative Frobenius norm squared: 0.00115408
2023-05-07 21:50:15,329 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 21:50:15,530 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.201 seconds.
2023-05-07 21:50:16,152 : [2/3] TRAINING : Current maximum residual: 0.21394730, relative Frobenius norm squared: 0.00115342
2023-05-07 21:50:16,152 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 21:50:16,375 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.223 seconds.
2023-05-07 21:50:17,003 : [2/3] TRAINING : Current maximum residual: 0.21394695, relative Frobenius norm squared: 0.00115308
2023-05-07 21:50:17,003 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 21:50:17,218 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.216 seconds.
2023-05-07 21:50:17,847 : [2/3] TRAINING : Current maximum residual: 0.21394683, relative Frobenius norm squared: 0.00115291
2023-05-07 21:50:17,847 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 21:50:18,048 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.201 seconds.
2023-05-07 21:50:18,680 : [2/3] TRAINING : Current maximum residual: 0.21394679, relative Frobenius norm squared: 0.00115259
2023-05-07 21:50:18,680 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 21:50:18,904 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.223 seconds.
2023-05-07 21:50:19,536 : [2/3] TRAINING : Current maximum residual: 0.21394679, relative Frobenius norm squared: 0.00115236
2023-05-07 21:50:19,536 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 21:50:19,754 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.217 seconds.
2023-05-07 21:50:20,378 : [2/3] TRAINING : Current maximum residual: 0.21394679, relative Frobenius norm squared: 0.00115230
2023-05-07 21:50:20,378 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 21:50:20,609 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.231 seconds.
2023-05-07 21:50:21,241 : [2/3] TRAINING : Current maximum residual: 0.21394680, relative Frobenius norm squared: 0.00115218
2023-05-07 21:50:21,241 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 21:50:21,461 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.220 seconds.
2023-05-07 21:50:22,084 : [2/3] TRAINING : Current maximum residual: 0.21394680, relative Frobenius norm squared: 0.00115216
2023-05-07 21:50:22,084 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 21:50:22,302 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.217 seconds.
2023-05-07 21:50:22,934 : [2/3] TRAINING : Current maximum residual: 0.21394681, relative Frobenius norm squared: 0.00115210
2023-05-07 21:50:22,934 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 21:50:23,148 : [2/3] TRAINING : Execution of _umr_finetune_step took at 0.214 seconds.
2023-05-07 21:50:23,777 : [2/3] TRAINING : Current maximum residual: 0.21394681, relative Frobenius norm squared: 0.00115188
2023-05-07 21:50:23,850 : [2/3] TRAINING : Execution of ainv_L took at 113.214 seconds.
2023-05-07 21:50:23,850 : [2/3] TRAINING : nnz of L_inv: 4231249, size: 50.940 MB
2023-05-07 21:50:23,850 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:50:23,880 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:50:23,901 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:50:24,437 : [2/3] TRAINING : Execution of _construct_weights took at 229.043 seconds.
2023-05-07 21:50:24,438 : [2/3] TRAINING : Model: SANSA, number of weights: 8462498, weights size: 97.159 MB
2023-05-07 21:50:24,438 : [2/3] TRAINING : Execution of _get_model took at 231.132 seconds.
2023-05-07 21:50:24,438 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:50:24,512 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:50:25,398 : [3/3] EVALUATION : Execution of _matmat took at 0.887 seconds.
2023-05-07 21:50:26,696 : [3/3] EVALUATION : Execution of _predict took at 2.201 seconds.
2023-05-07 21:50:27,749 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:50:27,819 : [3/3] EVALUATION : Execution of _matmat took at 0.014 seconds.
2023-05-07 21:50:28,689 : [3/3] EVALUATION : Execution of _matmat took at 0.870 seconds.
2023-05-07 21:50:29,955 : [3/3] EVALUATION : Execution of _predict took at 2.150 seconds.
2023-05-07 21:50:30,994 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:50:31,067 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:50:31,956 : [3/3] EVALUATION : Execution of _matmat took at 0.889 seconds.
2023-05-07 21:50:33,302 : [3/3] EVALUATION : Execution of _predict took at 2.252 seconds.
2023-05-07 21:50:34,359 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:50:34,423 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:50:35,305 : [3/3] EVALUATION : Execution of _matmat took at 0.882 seconds.
2023-05-07 21:50:36,631 : [3/3] EVALUATION : Execution of _predict took at 2.217 seconds.
2023-05-07 21:50:37,680 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:50:37,744 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:50:38,637 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:50:39,958 : [3/3] EVALUATION : Execution of _predict took at 2.223 seconds.
2023-05-07 21:50:41,001 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:50:41,065 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:50:41,944 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:50:43,255 : [3/3] EVALUATION : Execution of _predict took at 2.199 seconds.
2023-05-07 21:50:44,305 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:50:44,368 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:50:45,270 : [3/3] EVALUATION : Execution of _matmat took at 0.901 seconds.
2023-05-07 21:50:46,572 : [3/3] EVALUATION : Execution of _predict took at 2.212 seconds.
2023-05-07 21:50:47,617 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:50:47,680 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:50:48,550 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 21:50:49,833 : [3/3] EVALUATION : Execution of _predict took at 2.162 seconds.
2023-05-07 21:50:50,881 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:50:50,946 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:50:51,840 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:50:53,151 : [3/3] EVALUATION : Execution of _predict took at 2.214 seconds.
2023-05-07 21:50:54,206 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:50:54,268 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:50:55,153 : [3/3] EVALUATION : Execution of _matmat took at 0.885 seconds.
2023-05-07 21:50:56,422 : [3/3] EVALUATION : Execution of _predict took at 2.163 seconds.
2023-05-07 21:50:57,479 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:50:57,542 : [3/3] EVALUATION : Execution of _matmat took at 0.008 seconds.
2023-05-07 21:50:58,440 : [3/3] EVALUATION : Execution of _matmat took at 0.898 seconds.
2023-05-07 21:50:59,715 : [3/3] EVALUATION : Execution of _predict took at 2.181 seconds.
2023-05-07 21:51:00,757 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:51:00,828 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:51:01,710 : [3/3] EVALUATION : Execution of _matmat took at 0.881 seconds.
2023-05-07 21:51:03,070 : [3/3] EVALUATION : Execution of _predict took at 2.258 seconds.
2023-05-07 21:51:04,114 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:51:04,186 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:51:05,082 : [3/3] EVALUATION : Execution of _matmat took at 0.895 seconds.
2023-05-07 21:51:06,409 : [3/3] EVALUATION : Execution of _predict took at 2.240 seconds.
2023-05-07 21:51:07,464 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:51:07,527 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:08,411 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:51:09,701 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 21:51:10,753 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:51:10,817 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:11,686 : [3/3] EVALUATION : Execution of _matmat took at 0.869 seconds.
2023-05-07 21:51:12,962 : [3/3] EVALUATION : Execution of _predict took at 2.154 seconds.
2023-05-07 21:51:14,002 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:51:14,065 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:14,948 : [3/3] EVALUATION : Execution of _matmat took at 0.883 seconds.
2023-05-07 21:51:16,259 : [3/3] EVALUATION : Execution of _predict took at 2.203 seconds.
2023-05-07 21:51:17,308 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:51:17,372 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:18,245 : [3/3] EVALUATION : Execution of _matmat took at 0.873 seconds.
2023-05-07 21:51:19,591 : [3/3] EVALUATION : Execution of _predict took at 2.228 seconds.
2023-05-07 21:51:20,654 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:51:20,725 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:51:21,618 : [3/3] EVALUATION : Execution of _matmat took at 0.892 seconds.
2023-05-07 21:51:22,940 : [3/3] EVALUATION : Execution of _predict took at 2.232 seconds.
2023-05-07 21:51:23,989 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:51:24,052 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:24,946 : [3/3] EVALUATION : Execution of _matmat took at 0.893 seconds.
2023-05-07 21:51:26,244 : [3/3] EVALUATION : Execution of _predict took at 2.201 seconds.
2023-05-07 21:51:27,292 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:51:27,355 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:28,249 : [3/3] EVALUATION : Execution of _matmat took at 0.894 seconds.
2023-05-07 21:51:29,522 : [3/3] EVALUATION : Execution of _predict took at 2.176 seconds.
2023-05-07 21:51:30,562 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:51:30,634 : [3/3] EVALUATION : Execution of _matmat took at 0.017 seconds.
2023-05-07 21:51:31,546 : [3/3] EVALUATION : Execution of _matmat took at 0.911 seconds.
2023-05-07 21:51:32,874 : [3/3] EVALUATION : Execution of _predict took at 2.256 seconds.
2023-05-07 21:51:33,927 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:51:33,990 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:34,863 : [3/3] EVALUATION : Execution of _matmat took at 0.874 seconds.
2023-05-07 21:51:36,163 : [3/3] EVALUATION : Execution of _predict took at 2.183 seconds.
2023-05-07 21:51:37,216 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:51:37,280 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:38,151 : [3/3] EVALUATION : Execution of _matmat took at 0.871 seconds.
2023-05-07 21:51:39,440 : [3/3] EVALUATION : Execution of _predict took at 2.169 seconds.
2023-05-07 21:51:40,489 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:51:40,552 : [3/3] EVALUATION : Execution of _matmat took at 0.009 seconds.
2023-05-07 21:51:41,431 : [3/3] EVALUATION : Execution of _matmat took at 0.879 seconds.
2023-05-07 21:51:42,713 : [3/3] EVALUATION : Execution of _predict took at 2.170 seconds.
2023-05-07 21:51:43,754 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:51:43,818 : [3/3] EVALUATION : Execution of _matmat took at 0.010 seconds.
2023-05-07 21:51:44,702 : [3/3] EVALUATION : Execution of _matmat took at 0.884 seconds.
2023-05-07 21:51:46,046 : [3/3] EVALUATION : Execution of _predict took at 2.237 seconds.
2023-05-07 21:51:47,326 : [3/3] EVALUATION : Execution of _evaluate_model took at 82.888 seconds.
2023-05-07 21:51:47,327 : PIPELINE END : Execution of run took at 315.980 seconds.
d=0.01, ns=0, nf=0


2023-05-07 21:51:47,360 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:51:47,360 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:51:48,561 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.201 seconds.
2023-05-07 21:51:48,901 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:51:49,361 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:51:49,374 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.014 seconds.
2023-05-07 21:51:49,374 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:51:49,374 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:51:49,374 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:51:49,374 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:51:51,470 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:51:51,470 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:53:41,772 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:53:41,772 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:53:50,883 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 21:53:50,883 : [2/3] TRAINING : Execution of ldlt took at 119.412 seconds.
2023-05-07 21:53:50,883 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 21:53:50,883 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:53:50,883 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:53:51,030 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:53:55,120 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 21:53:55,452 : [2/3] TRAINING : Execution of ainv_L took at 4.569 seconds.
2023-05-07 21:53:55,453 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 21:53:55,453 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:53:55,656 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:53:55,807 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:53:56,661 : [2/3] TRAINING : Execution of _construct_weights took at 125.191 seconds.
2023-05-07 21:53:56,662 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 21:53:56,662 : [2/3] TRAINING : Execution of _get_model took at 127.288 seconds.
2023-05-07 21:53:56,662 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:53:56,769 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:54:00,597 : [3/3] EVALUATION : Execution of _matmat took at 3.828 seconds.
2023-05-07 21:54:01,946 : [3/3] EVALUATION : Execution of _predict took at 5.227 seconds.
2023-05-07 21:54:03,130 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:54:03,234 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:54:07,016 : [3/3] EVALUATION : Execution of _matmat took at 3.782 seconds.
2023-05-07 21:54:08,334 : [3/3] EVALUATION : Execution of _predict took at 5.149 seconds.
2023-05-07 21:54:09,507 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:54:09,614 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 21:54:13,400 : [3/3] EVALUATION : Execution of _matmat took at 3.786 seconds.
2023-05-07 21:54:14,798 : [3/3] EVALUATION : Execution of _predict took at 5.235 seconds.
2023-05-07 21:54:15,973 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:54:16,078 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:54:19,875 : [3/3] EVALUATION : Execution of _matmat took at 3.798 seconds.
2023-05-07 21:54:21,255 : [3/3] EVALUATION : Execution of _predict took at 5.227 seconds.
2023-05-07 21:54:22,425 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:54:22,530 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:54:26,373 : [3/3] EVALUATION : Execution of _matmat took at 3.842 seconds.
2023-05-07 21:54:27,746 : [3/3] EVALUATION : Execution of _predict took at 5.265 seconds.
2023-05-07 21:54:28,923 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:54:29,028 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:54:32,798 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 21:54:34,163 : [3/3] EVALUATION : Execution of _predict took at 5.185 seconds.
2023-05-07 21:54:35,347 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:54:35,451 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:54:39,333 : [3/3] EVALUATION : Execution of _matmat took at 3.882 seconds.
2023-05-07 21:54:40,687 : [3/3] EVALUATION : Execution of _predict took at 5.286 seconds.
2023-05-07 21:54:41,864 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:54:41,968 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:54:45,728 : [3/3] EVALUATION : Execution of _matmat took at 3.759 seconds.
2023-05-07 21:54:47,062 : [3/3] EVALUATION : Execution of _predict took at 5.144 seconds.
2023-05-07 21:54:48,230 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 21:54:48,334 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:54:52,173 : [3/3] EVALUATION : Execution of _matmat took at 3.839 seconds.
2023-05-07 21:54:53,538 : [3/3] EVALUATION : Execution of _predict took at 5.253 seconds.
2023-05-07 21:54:54,717 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 21:54:54,817 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 21:54:58,610 : [3/3] EVALUATION : Execution of _matmat took at 3.792 seconds.
2023-05-07 21:54:59,932 : [3/3] EVALUATION : Execution of _predict took at 5.162 seconds.
2023-05-07 21:55:01,108 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 21:55:01,211 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 21:55:05,092 : [3/3] EVALUATION : Execution of _matmat took at 3.881 seconds.
2023-05-07 21:55:06,417 : [3/3] EVALUATION : Execution of _predict took at 5.254 seconds.
2023-05-07 21:55:07,583 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 21:55:07,687 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:55:11,479 : [3/3] EVALUATION : Execution of _matmat took at 3.792 seconds.
2023-05-07 21:55:12,893 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 21:55:14,067 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 21:55:14,170 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:55:18,015 : [3/3] EVALUATION : Execution of _matmat took at 3.844 seconds.
2023-05-07 21:55:19,394 : [3/3] EVALUATION : Execution of _predict took at 5.273 seconds.
2023-05-07 21:55:20,576 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 21:55:20,679 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 21:55:24,549 : [3/3] EVALUATION : Execution of _matmat took at 3.870 seconds.
2023-05-07 21:55:25,892 : [3/3] EVALUATION : Execution of _predict took at 5.262 seconds.
2023-05-07 21:55:27,068 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 21:55:27,172 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:55:30,951 : [3/3] EVALUATION : Execution of _matmat took at 3.778 seconds.
2023-05-07 21:55:32,278 : [3/3] EVALUATION : Execution of _predict took at 5.155 seconds.
2023-05-07 21:55:33,453 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 21:55:33,555 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:55:37,289 : [3/3] EVALUATION : Execution of _matmat took at 3.734 seconds.
2023-05-07 21:55:38,654 : [3/3] EVALUATION : Execution of _predict took at 5.148 seconds.
2023-05-07 21:55:39,830 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 21:55:39,933 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 21:55:43,705 : [3/3] EVALUATION : Execution of _matmat took at 3.772 seconds.
2023-05-07 21:55:45,100 : [3/3] EVALUATION : Execution of _predict took at 5.216 seconds.
2023-05-07 21:55:46,285 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 21:55:46,388 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:55:50,149 : [3/3] EVALUATION : Execution of _matmat took at 3.760 seconds.
2023-05-07 21:55:51,523 : [3/3] EVALUATION : Execution of _predict took at 5.184 seconds.
2023-05-07 21:55:52,696 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 21:55:52,799 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 21:55:56,588 : [3/3] EVALUATION : Execution of _matmat took at 3.789 seconds.
2023-05-07 21:55:57,939 : [3/3] EVALUATION : Execution of _predict took at 5.188 seconds.
2023-05-07 21:55:59,124 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 21:55:59,227 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:56:03,105 : [3/3] EVALUATION : Execution of _matmat took at 3.878 seconds.
2023-05-07 21:56:04,430 : [3/3] EVALUATION : Execution of _predict took at 5.252 seconds.
2023-05-07 21:56:05,596 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 21:56:05,702 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 21:56:09,638 : [3/3] EVALUATION : Execution of _matmat took at 3.936 seconds.
2023-05-07 21:56:11,018 : [3/3] EVALUATION : Execution of _predict took at 5.368 seconds.
2023-05-07 21:56:12,202 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 21:56:12,303 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 21:56:16,080 : [3/3] EVALUATION : Execution of _matmat took at 3.776 seconds.
2023-05-07 21:56:17,429 : [3/3] EVALUATION : Execution of _predict took at 5.174 seconds.
2023-05-07 21:56:18,608 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 21:56:18,712 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:56:22,459 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-07 21:56:23,798 : [3/3] EVALUATION : Execution of _predict took at 5.135 seconds.
2023-05-07 21:56:24,982 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 21:56:25,084 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:56:28,794 : [3/3] EVALUATION : Execution of _matmat took at 3.710 seconds.
2023-05-07 21:56:30,128 : [3/3] EVALUATION : Execution of _predict took at 5.093 seconds.
2023-05-07 21:56:31,298 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 21:56:31,404 : [3/3] EVALUATION : Execution of _matmat took at 0.052 seconds.
2023-05-07 21:56:35,207 : [3/3] EVALUATION : Execution of _matmat took at 3.803 seconds.
2023-05-07 21:56:36,609 : [3/3] EVALUATION : Execution of _predict took at 5.257 seconds.
2023-05-07 21:56:38,012 : [3/3] EVALUATION : Execution of _evaluate_model took at 161.350 seconds.
2023-05-07 21:56:38,013 : PIPELINE END : Execution of run took at 290.653 seconds.
d=0.01, ns=0, nf=5


2023-05-07 21:56:38,047 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 21:56:38,047 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 21:56:39,225 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.177 seconds.
2023-05-07 21:56:39,548 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 21:56:39,999 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 21:56:40,011 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.964 seconds.
2023-05-07 21:56:40,011 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 21:56:40,011 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 21:56:40,011 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 21:56:40,011 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 21:56:42,031 : [2/3] TRAINING : Constructing weights:
2023-05-07 21:56:42,031 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 21:58:28,789 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 21:58:28,789 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 21:58:37,785 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 21:58:37,786 : [2/3] TRAINING : Execution of ldlt took at 115.754 seconds.
2023-05-07 21:58:37,786 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 21:58:37,786 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 21:58:37,786 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 21:58:37,926 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 21:58:41,896 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 21:58:41,896 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 21:58:44,064 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.168 seconds.
2023-05-07 21:58:48,041 : [2/3] TRAINING : Current maximum residual: 1.79579463, relative Frobenius norm squared: 0.08552273
2023-05-07 21:58:48,041 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 21:58:49,940 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.898 seconds.
2023-05-07 21:58:53,887 : [2/3] TRAINING : Current maximum residual: 1.32643557, relative Frobenius norm squared: 0.06336875
2023-05-07 21:58:53,888 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 21:58:55,767 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.880 seconds.
2023-05-07 21:58:59,700 : [2/3] TRAINING : Current maximum residual: 1.09177905, relative Frobenius norm squared: 0.05003443
2023-05-07 21:58:59,700 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 21:59:01,430 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.730 seconds.
2023-05-07 21:59:05,411 : [2/3] TRAINING : Current maximum residual: 0.92356422, relative Frobenius norm squared: 0.04103116
2023-05-07 21:59:05,411 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 21:59:07,031 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.620 seconds.
2023-05-07 21:59:10,996 : [2/3] TRAINING : Current maximum residual: 0.87550243, relative Frobenius norm squared: 0.03460155
2023-05-07 21:59:11,329 : [2/3] TRAINING : Execution of ainv_L took at 33.543 seconds.
2023-05-07 21:59:11,329 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 21:59:11,329 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 21:59:11,527 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 21:59:11,674 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 21:59:12,506 : [2/3] TRAINING : Execution of _construct_weights took at 150.475 seconds.
2023-05-07 21:59:12,507 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 21:59:12,507 : [2/3] TRAINING : Execution of _get_model took at 152.496 seconds.
2023-05-07 21:59:12,507 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 21:59:12,614 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 21:59:16,435 : [3/3] EVALUATION : Execution of _matmat took at 3.820 seconds.
2023-05-07 21:59:17,784 : [3/3] EVALUATION : Execution of _predict took at 5.221 seconds.
2023-05-07 21:59:18,831 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 21:59:18,933 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 21:59:22,674 : [3/3] EVALUATION : Execution of _matmat took at 3.741 seconds.
2023-05-07 21:59:23,992 : [3/3] EVALUATION : Execution of _predict took at 5.106 seconds.
2023-05-07 21:59:25,014 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 21:59:25,118 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 21:59:28,917 : [3/3] EVALUATION : Execution of _matmat took at 3.799 seconds.
2023-05-07 21:59:30,315 : [3/3] EVALUATION : Execution of _predict took at 5.246 seconds.
2023-05-07 21:59:31,344 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 21:59:31,447 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 21:59:35,272 : [3/3] EVALUATION : Execution of _matmat took at 3.825 seconds.
2023-05-07 21:59:36,653 : [3/3] EVALUATION : Execution of _predict took at 5.254 seconds.
2023-05-07 21:59:37,687 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 21:59:37,790 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 21:59:41,604 : [3/3] EVALUATION : Execution of _matmat took at 3.814 seconds.
2023-05-07 21:59:42,978 : [3/3] EVALUATION : Execution of _predict took at 5.236 seconds.
2023-05-07 21:59:44,006 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 21:59:44,109 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 21:59:47,878 : [3/3] EVALUATION : Execution of _matmat took at 3.768 seconds.
2023-05-07 21:59:49,241 : [3/3] EVALUATION : Execution of _predict took at 5.180 seconds.
2023-05-07 21:59:50,278 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 21:59:50,379 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 21:59:54,251 : [3/3] EVALUATION : Execution of _matmat took at 3.872 seconds.
2023-05-07 21:59:55,605 : [3/3] EVALUATION : Execution of _predict took at 5.274 seconds.
2023-05-07 21:59:56,639 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 21:59:56,740 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:00:00,513 : [3/3] EVALUATION : Execution of _matmat took at 3.773 seconds.
2023-05-07 22:00:01,851 : [3/3] EVALUATION : Execution of _predict took at 5.157 seconds.
2023-05-07 22:00:02,884 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:00:02,988 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:00:06,774 : [3/3] EVALUATION : Execution of _matmat took at 3.785 seconds.
2023-05-07 22:00:08,139 : [3/3] EVALUATION : Execution of _predict took at 5.199 seconds.
2023-05-07 22:00:09,169 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:00:09,269 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:00:13,091 : [3/3] EVALUATION : Execution of _matmat took at 3.821 seconds.
2023-05-07 22:00:14,413 : [3/3] EVALUATION : Execution of _predict took at 5.191 seconds.
2023-05-07 22:00:15,449 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:00:15,550 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:00:19,426 : [3/3] EVALUATION : Execution of _matmat took at 3.876 seconds.
2023-05-07 22:00:20,753 : [3/3] EVALUATION : Execution of _predict took at 5.250 seconds.
2023-05-07 22:00:21,781 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:00:21,885 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:00:25,680 : [3/3] EVALUATION : Execution of _matmat took at 3.795 seconds.
2023-05-07 22:00:27,093 : [3/3] EVALUATION : Execution of _predict took at 5.257 seconds.
2023-05-07 22:00:28,123 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:00:28,227 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:00:32,097 : [3/3] EVALUATION : Execution of _matmat took at 3.870 seconds.
2023-05-07 22:00:33,477 : [3/3] EVALUATION : Execution of _predict took at 5.299 seconds.
2023-05-07 22:00:34,508 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:00:34,609 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:00:38,446 : [3/3] EVALUATION : Execution of _matmat took at 3.837 seconds.
2023-05-07 22:00:39,791 : [3/3] EVALUATION : Execution of _predict took at 5.229 seconds.
2023-05-07 22:00:40,823 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:00:40,924 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:00:44,674 : [3/3] EVALUATION : Execution of _matmat took at 3.749 seconds.
2023-05-07 22:00:46,001 : [3/3] EVALUATION : Execution of _predict took at 5.124 seconds.
2023-05-07 22:00:47,031 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:00:47,132 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:00:50,880 : [3/3] EVALUATION : Execution of _matmat took at 3.748 seconds.
2023-05-07 22:00:52,246 : [3/3] EVALUATION : Execution of _predict took at 5.162 seconds.
2023-05-07 22:00:53,283 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:00:53,385 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:00:57,168 : [3/3] EVALUATION : Execution of _matmat took at 3.783 seconds.
2023-05-07 22:00:58,564 : [3/3] EVALUATION : Execution of _predict took at 5.226 seconds.
2023-05-07 22:00:59,608 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:00:59,709 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:01:03,442 : [3/3] EVALUATION : Execution of _matmat took at 3.733 seconds.
2023-05-07 22:01:04,818 : [3/3] EVALUATION : Execution of _predict took at 5.156 seconds.
2023-05-07 22:01:05,843 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:01:05,944 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:01:09,719 : [3/3] EVALUATION : Execution of _matmat took at 3.775 seconds.
2023-05-07 22:01:11,071 : [3/3] EVALUATION : Execution of _predict took at 5.175 seconds.
2023-05-07 22:01:12,104 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:01:12,205 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:01:16,072 : [3/3] EVALUATION : Execution of _matmat took at 3.867 seconds.
2023-05-07 22:01:17,397 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 22:01:18,421 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:01:18,525 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:01:22,432 : [3/3] EVALUATION : Execution of _matmat took at 3.907 seconds.
2023-05-07 22:01:23,813 : [3/3] EVALUATION : Execution of _predict took at 5.338 seconds.
2023-05-07 22:01:24,858 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:01:24,959 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:01:28,747 : [3/3] EVALUATION : Execution of _matmat took at 3.788 seconds.
2023-05-07 22:01:30,097 : [3/3] EVALUATION : Execution of _predict took at 5.186 seconds.
2023-05-07 22:01:31,130 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:01:31,232 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:01:34,996 : [3/3] EVALUATION : Execution of _matmat took at 3.763 seconds.
2023-05-07 22:01:36,337 : [3/3] EVALUATION : Execution of _predict took at 5.152 seconds.
2023-05-07 22:01:37,373 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:01:37,474 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:01:41,206 : [3/3] EVALUATION : Execution of _matmat took at 3.732 seconds.
2023-05-07 22:01:42,542 : [3/3] EVALUATION : Execution of _predict took at 5.115 seconds.
2023-05-07 22:01:43,568 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:01:43,671 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:01:47,475 : [3/3] EVALUATION : Execution of _matmat took at 3.804 seconds.
2023-05-07 22:01:48,870 : [3/3] EVALUATION : Execution of _predict took at 5.247 seconds.
2023-05-07 22:01:50,123 : [3/3] EVALUATION : Execution of _evaluate_model took at 157.616 seconds.
2023-05-07 22:01:50,124 : PIPELINE END : Execution of run took at 312.077 seconds.
d=0.01, ns=0, nf=10


2023-05-07 22:01:50,158 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:01:50,158 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:01:51,331 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.173 seconds.
2023-05-07 22:01:51,658 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:01:52,110 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:01:52,122 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.964 seconds.
2023-05-07 22:01:52,122 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:01:52,122 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:01:52,123 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:01:52,123 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:01:54,167 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:01:54,167 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:03:40,944 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:03:40,944 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:03:49,947 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:03:49,948 : [2/3] TRAINING : Execution of ldlt took at 115.780 seconds.
2023-05-07 22:03:49,948 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:03:49,948 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:03:49,948 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:03:50,089 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:03:54,068 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:03:54,068 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:03:56,212 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.144 seconds.
2023-05-07 22:04:00,326 : [2/3] TRAINING : Current maximum residual: 1.79579463, relative Frobenius norm squared: 0.08552273
2023-05-07 22:04:00,326 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:04:02,246 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.920 seconds.
2023-05-07 22:04:06,330 : [2/3] TRAINING : Current maximum residual: 1.32643557, relative Frobenius norm squared: 0.06336875
2023-05-07 22:04:06,330 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:04:08,236 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.906 seconds.
2023-05-07 22:04:12,298 : [2/3] TRAINING : Current maximum residual: 1.09177905, relative Frobenius norm squared: 0.05003443
2023-05-07 22:04:12,298 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:04:14,052 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.754 seconds.
2023-05-07 22:04:18,157 : [2/3] TRAINING : Current maximum residual: 0.92356422, relative Frobenius norm squared: 0.04103116
2023-05-07 22:04:18,157 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:04:19,810 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.653 seconds.
2023-05-07 22:04:23,901 : [2/3] TRAINING : Current maximum residual: 0.87550243, relative Frobenius norm squared: 0.03460155
2023-05-07 22:04:23,901 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 22:04:25,482 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.582 seconds.
2023-05-07 22:04:29,548 : [2/3] TRAINING : Current maximum residual: 0.80426583, relative Frobenius norm squared: 0.02979893
2023-05-07 22:04:29,548 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 22:04:31,181 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.633 seconds.
2023-05-07 22:04:35,308 : [2/3] TRAINING : Current maximum residual: 0.63732176, relative Frobenius norm squared: 0.02600836
2023-05-07 22:04:35,308 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 22:04:36,807 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.499 seconds.
2023-05-07 22:04:40,889 : [2/3] TRAINING : Current maximum residual: 0.60389228, relative Frobenius norm squared: 0.02302290
2023-05-07 22:04:40,889 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 22:04:42,500 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.611 seconds.
2023-05-07 22:04:46,582 : [2/3] TRAINING : Current maximum residual: 0.52713367, relative Frobenius norm squared: 0.02060465
2023-05-07 22:04:46,582 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 22:04:48,174 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.592 seconds.
2023-05-07 22:04:52,227 : [2/3] TRAINING : Current maximum residual: 0.48518286, relative Frobenius norm squared: 0.01856165
2023-05-07 22:04:52,568 : [2/3] TRAINING : Execution of ainv_L took at 62.620 seconds.
2023-05-07 22:04:52,568 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:04:52,569 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:04:52,772 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:04:52,922 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:04:53,777 : [2/3] TRAINING : Execution of _construct_weights took at 179.610 seconds.
2023-05-07 22:04:53,778 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:04:53,779 : [2/3] TRAINING : Execution of _get_model took at 181.656 seconds.
2023-05-07 22:04:53,779 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:04:53,886 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:04:57,706 : [3/3] EVALUATION : Execution of _matmat took at 3.820 seconds.
2023-05-07 22:04:59,056 : [3/3] EVALUATION : Execution of _predict took at 5.220 seconds.
2023-05-07 22:05:00,115 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:05:00,218 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:05:03,936 : [3/3] EVALUATION : Execution of _matmat took at 3.718 seconds.
2023-05-07 22:05:05,256 : [3/3] EVALUATION : Execution of _predict took at 5.086 seconds.
2023-05-07 22:05:06,297 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:05:06,401 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:05:10,211 : [3/3] EVALUATION : Execution of _matmat took at 3.810 seconds.
2023-05-07 22:05:11,609 : [3/3] EVALUATION : Execution of _predict took at 5.257 seconds.
2023-05-07 22:05:12,649 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:05:12,751 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:05:16,520 : [3/3] EVALUATION : Execution of _matmat took at 3.769 seconds.
2023-05-07 22:05:17,900 : [3/3] EVALUATION : Execution of _predict took at 5.197 seconds.
2023-05-07 22:05:18,948 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:05:19,051 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:05:22,841 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:05:24,215 : [3/3] EVALUATION : Execution of _predict took at 5.212 seconds.
2023-05-07 22:05:25,257 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:05:25,359 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:05:29,086 : [3/3] EVALUATION : Execution of _matmat took at 3.726 seconds.
2023-05-07 22:05:30,451 : [3/3] EVALUATION : Execution of _predict took at 5.140 seconds.
2023-05-07 22:05:31,500 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:05:31,601 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:05:35,439 : [3/3] EVALUATION : Execution of _matmat took at 3.838 seconds.
2023-05-07 22:05:36,794 : [3/3] EVALUATION : Execution of _predict took at 5.240 seconds.
2023-05-07 22:05:37,839 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:05:37,940 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:05:41,681 : [3/3] EVALUATION : Execution of _matmat took at 3.742 seconds.
2023-05-07 22:05:43,018 : [3/3] EVALUATION : Execution of _predict took at 5.126 seconds.
2023-05-07 22:05:44,065 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:05:44,168 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:05:47,933 : [3/3] EVALUATION : Execution of _matmat took at 3.764 seconds.
2023-05-07 22:05:49,298 : [3/3] EVALUATION : Execution of _predict took at 5.178 seconds.
2023-05-07 22:05:50,350 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:05:50,452 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:05:54,260 : [3/3] EVALUATION : Execution of _matmat took at 3.807 seconds.
2023-05-07 22:05:55,583 : [3/3] EVALUATION : Execution of _predict took at 5.180 seconds.
2023-05-07 22:05:56,627 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:05:56,728 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:06:00,594 : [3/3] EVALUATION : Execution of _matmat took at 3.866 seconds.
2023-05-07 22:06:01,920 : [3/3] EVALUATION : Execution of _predict took at 5.238 seconds.
2023-05-07 22:06:02,965 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:06:03,067 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:06:06,844 : [3/3] EVALUATION : Execution of _matmat took at 3.776 seconds.
2023-05-07 22:06:08,257 : [3/3] EVALUATION : Execution of _predict took at 5.238 seconds.
2023-05-07 22:06:09,303 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:06:09,405 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:06:13,233 : [3/3] EVALUATION : Execution of _matmat took at 3.828 seconds.
2023-05-07 22:06:14,612 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 22:06:15,664 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:06:15,765 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:06:19,554 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:06:20,898 : [3/3] EVALUATION : Execution of _predict took at 5.180 seconds.
2023-05-07 22:06:21,940 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:06:22,041 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:06:25,775 : [3/3] EVALUATION : Execution of _matmat took at 3.733 seconds.
2023-05-07 22:06:27,102 : [3/3] EVALUATION : Execution of _predict took at 5.107 seconds.
2023-05-07 22:06:28,139 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:06:28,239 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:06:31,976 : [3/3] EVALUATION : Execution of _matmat took at 3.737 seconds.
2023-05-07 22:06:33,343 : [3/3] EVALUATION : Execution of _predict took at 5.151 seconds.
2023-05-07 22:06:34,388 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:06:34,490 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:06:38,244 : [3/3] EVALUATION : Execution of _matmat took at 3.754 seconds.
2023-05-07 22:06:39,639 : [3/3] EVALUATION : Execution of _predict took at 5.196 seconds.
2023-05-07 22:06:40,693 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:06:40,794 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:06:44,514 : [3/3] EVALUATION : Execution of _matmat took at 3.720 seconds.
2023-05-07 22:06:45,890 : [3/3] EVALUATION : Execution of _predict took at 5.143 seconds.
2023-05-07 22:06:46,932 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:06:47,032 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:06:50,773 : [3/3] EVALUATION : Execution of _matmat took at 3.740 seconds.
2023-05-07 22:06:52,125 : [3/3] EVALUATION : Execution of _predict took at 5.139 seconds.
2023-05-07 22:06:53,174 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:06:53,274 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:06:57,129 : [3/3] EVALUATION : Execution of _matmat took at 3.855 seconds.
2023-05-07 22:06:58,452 : [3/3] EVALUATION : Execution of _predict took at 5.225 seconds.
2023-05-07 22:06:59,487 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:06:59,589 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:07:03,482 : [3/3] EVALUATION : Execution of _matmat took at 3.893 seconds.
2023-05-07 22:07:04,862 : [3/3] EVALUATION : Execution of _predict took at 5.321 seconds.
2023-05-07 22:07:05,912 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:07:06,013 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:07:09,760 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-07 22:07:11,110 : [3/3] EVALUATION : Execution of _predict took at 5.144 seconds.
2023-05-07 22:07:12,158 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:07:12,259 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:07:15,982 : [3/3] EVALUATION : Execution of _matmat took at 3.724 seconds.
2023-05-07 22:07:17,321 : [3/3] EVALUATION : Execution of _predict took at 5.109 seconds.
2023-05-07 22:07:18,366 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:07:18,466 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:07:22,139 : [3/3] EVALUATION : Execution of _matmat took at 3.673 seconds.
2023-05-07 22:07:23,474 : [3/3] EVALUATION : Execution of _predict took at 5.054 seconds.
2023-05-07 22:07:24,509 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:07:24,611 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:07:28,385 : [3/3] EVALUATION : Execution of _matmat took at 3.775 seconds.
2023-05-07 22:07:29,781 : [3/3] EVALUATION : Execution of _predict took at 5.218 seconds.
2023-05-07 22:07:31,046 : [3/3] EVALUATION : Execution of _evaluate_model took at 157.267 seconds.
2023-05-07 22:07:31,047 : PIPELINE END : Execution of run took at 340.889 seconds.
d=0.01, ns=0, nf=20


2023-05-07 22:07:31,081 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:07:31,081 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:07:32,249 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.168 seconds.
2023-05-07 22:07:32,570 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:07:33,019 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:07:33,031 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.950 seconds.
2023-05-07 22:07:33,031 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:07:33,031 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:07:33,031 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:07:33,032 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:07:35,065 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:07:35,065 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:09:20,941 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:09:20,941 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:09:29,893 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:09:29,893 : [2/3] TRAINING : Execution of ldlt took at 114.828 seconds.
2023-05-07 22:09:29,893 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:09:29,893 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:09:29,893 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:09:30,034 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:09:33,978 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:09:33,978 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:09:36,114 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.136 seconds.
2023-05-07 22:09:40,072 : [2/3] TRAINING : Current maximum residual: 1.79579463, relative Frobenius norm squared: 0.08552273
2023-05-07 22:09:40,072 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:09:41,981 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.909 seconds.
2023-05-07 22:09:45,900 : [2/3] TRAINING : Current maximum residual: 1.32643557, relative Frobenius norm squared: 0.06336875
2023-05-07 22:09:45,901 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:09:47,779 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.879 seconds.
2023-05-07 22:09:51,682 : [2/3] TRAINING : Current maximum residual: 1.09177905, relative Frobenius norm squared: 0.05003443
2023-05-07 22:09:51,682 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:09:53,413 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.730 seconds.
2023-05-07 22:09:57,361 : [2/3] TRAINING : Current maximum residual: 0.92356422, relative Frobenius norm squared: 0.04103116
2023-05-07 22:09:57,361 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:09:58,980 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.619 seconds.
2023-05-07 22:10:02,914 : [2/3] TRAINING : Current maximum residual: 0.87550243, relative Frobenius norm squared: 0.03460155
2023-05-07 22:10:02,914 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 22:10:04,473 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.559 seconds.
2023-05-07 22:10:08,371 : [2/3] TRAINING : Current maximum residual: 0.80426583, relative Frobenius norm squared: 0.02979893
2023-05-07 22:10:08,371 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 22:10:09,982 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.611 seconds.
2023-05-07 22:10:13,943 : [2/3] TRAINING : Current maximum residual: 0.63732176, relative Frobenius norm squared: 0.02600836
2023-05-07 22:10:13,943 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 22:10:15,437 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.494 seconds.
2023-05-07 22:10:19,360 : [2/3] TRAINING : Current maximum residual: 0.60389228, relative Frobenius norm squared: 0.02302290
2023-05-07 22:10:19,360 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 22:10:20,931 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.571 seconds.
2023-05-07 22:10:24,824 : [2/3] TRAINING : Current maximum residual: 0.52713367, relative Frobenius norm squared: 0.02060465
2023-05-07 22:10:24,824 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 22:10:26,400 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.575 seconds.
2023-05-07 22:10:30,302 : [2/3] TRAINING : Current maximum residual: 0.48518286, relative Frobenius norm squared: 0.01856165
2023-05-07 22:10:30,302 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 22:10:31,670 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.368 seconds.
2023-05-07 22:10:35,561 : [2/3] TRAINING : Current maximum residual: 0.45625898, relative Frobenius norm squared: 0.01683168
2023-05-07 22:10:35,561 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 22:10:37,083 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.522 seconds.
2023-05-07 22:10:41,003 : [2/3] TRAINING : Current maximum residual: 0.42724687, relative Frobenius norm squared: 0.01536107
2023-05-07 22:10:41,003 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 22:10:42,497 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.494 seconds.
2023-05-07 22:10:46,438 : [2/3] TRAINING : Current maximum residual: 0.39832038, relative Frobenius norm squared: 0.01409569
2023-05-07 22:10:46,438 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 22:10:47,910 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.471 seconds.
2023-05-07 22:10:51,801 : [2/3] TRAINING : Current maximum residual: 0.37360172, relative Frobenius norm squared: 0.01300307
2023-05-07 22:10:51,801 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 22:10:53,166 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.365 seconds.
2023-05-07 22:10:57,064 : [2/3] TRAINING : Current maximum residual: 0.35538550, relative Frobenius norm squared: 0.01203580
2023-05-07 22:10:57,064 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 22:10:58,405 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.341 seconds.
2023-05-07 22:11:02,324 : [2/3] TRAINING : Current maximum residual: 0.33640725, relative Frobenius norm squared: 0.01117610
2023-05-07 22:11:02,324 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 22:11:03,864 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.540 seconds.
2023-05-07 22:11:07,761 : [2/3] TRAINING : Current maximum residual: 0.31846689, relative Frobenius norm squared: 0.01044957
2023-05-07 22:11:07,761 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 22:11:09,239 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.478 seconds.
2023-05-07 22:11:13,173 : [2/3] TRAINING : Current maximum residual: 0.30262612, relative Frobenius norm squared: 0.00978718
2023-05-07 22:11:13,174 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 22:11:14,651 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.477 seconds.
2023-05-07 22:11:18,548 : [2/3] TRAINING : Current maximum residual: 0.28902552, relative Frobenius norm squared: 0.00920114
2023-05-07 22:11:18,548 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 22:11:20,036 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.489 seconds.
2023-05-07 22:11:23,946 : [2/3] TRAINING : Current maximum residual: 0.27575365, relative Frobenius norm squared: 0.00867173
2023-05-07 22:11:24,272 : [2/3] TRAINING : Execution of ainv_L took at 114.379 seconds.
2023-05-07 22:11:24,273 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:11:24,273 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:11:24,470 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:11:24,616 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:11:25,450 : [2/3] TRAINING : Execution of _construct_weights took at 230.384 seconds.
2023-05-07 22:11:25,451 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:11:25,451 : [2/3] TRAINING : Execution of _get_model took at 232.419 seconds.
2023-05-07 22:11:25,451 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:11:25,554 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:11:29,360 : [3/3] EVALUATION : Execution of _matmat took at 3.806 seconds.
2023-05-07 22:11:30,708 : [3/3] EVALUATION : Execution of _predict took at 5.201 seconds.
2023-05-07 22:11:31,785 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:11:31,886 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:11:35,603 : [3/3] EVALUATION : Execution of _matmat took at 3.718 seconds.
2023-05-07 22:11:36,921 : [3/3] EVALUATION : Execution of _predict took at 5.081 seconds.
2023-05-07 22:11:37,986 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:11:38,089 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:11:41,860 : [3/3] EVALUATION : Execution of _matmat took at 3.771 seconds.
2023-05-07 22:11:43,258 : [3/3] EVALUATION : Execution of _predict took at 5.217 seconds.
2023-05-07 22:11:44,328 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:11:44,430 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:11:48,205 : [3/3] EVALUATION : Execution of _matmat took at 3.776 seconds.
2023-05-07 22:11:49,584 : [3/3] EVALUATION : Execution of _predict took at 5.201 seconds.
2023-05-07 22:11:50,654 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:11:50,756 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:11:54,539 : [3/3] EVALUATION : Execution of _matmat took at 3.784 seconds.
2023-05-07 22:11:55,896 : [3/3] EVALUATION : Execution of _predict took at 5.187 seconds.
2023-05-07 22:11:56,960 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:11:57,062 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:12:00,812 : [3/3] EVALUATION : Execution of _matmat took at 3.750 seconds.
2023-05-07 22:12:02,176 : [3/3] EVALUATION : Execution of _predict took at 5.161 seconds.
2023-05-07 22:12:03,256 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:12:03,359 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:12:07,179 : [3/3] EVALUATION : Execution of _matmat took at 3.819 seconds.
2023-05-07 22:12:08,532 : [3/3] EVALUATION : Execution of _predict took at 5.222 seconds.
2023-05-07 22:12:09,603 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:12:09,703 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:12:13,459 : [3/3] EVALUATION : Execution of _matmat took at 3.756 seconds.
2023-05-07 22:12:14,795 : [3/3] EVALUATION : Execution of _predict took at 5.138 seconds.
2023-05-07 22:12:15,865 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:12:15,968 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:12:19,776 : [3/3] EVALUATION : Execution of _matmat took at 3.808 seconds.
2023-05-07 22:12:21,140 : [3/3] EVALUATION : Execution of _predict took at 5.220 seconds.
2023-05-07 22:12:22,218 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:12:22,317 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:12:26,130 : [3/3] EVALUATION : Execution of _matmat took at 3.813 seconds.
2023-05-07 22:12:27,452 : [3/3] EVALUATION : Execution of _predict took at 5.181 seconds.
2023-05-07 22:12:28,522 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:12:28,623 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:12:32,493 : [3/3] EVALUATION : Execution of _matmat took at 3.870 seconds.
2023-05-07 22:12:33,819 : [3/3] EVALUATION : Execution of _predict took at 5.242 seconds.
2023-05-07 22:12:34,892 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:12:34,995 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:12:38,785 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:12:40,198 : [3/3] EVALUATION : Execution of _predict took at 5.251 seconds.
2023-05-07 22:12:41,263 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:12:41,365 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:12:45,208 : [3/3] EVALUATION : Execution of _matmat took at 3.843 seconds.
2023-05-07 22:12:46,588 : [3/3] EVALUATION : Execution of _predict took at 5.271 seconds.
2023-05-07 22:12:47,664 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:12:47,765 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:12:51,573 : [3/3] EVALUATION : Execution of _matmat took at 3.808 seconds.
2023-05-07 22:12:52,917 : [3/3] EVALUATION : Execution of _predict took at 5.199 seconds.
2023-05-07 22:12:53,991 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:12:54,091 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:12:57,835 : [3/3] EVALUATION : Execution of _matmat took at 3.744 seconds.
2023-05-07 22:12:59,164 : [3/3] EVALUATION : Execution of _predict took at 5.118 seconds.
2023-05-07 22:13:00,231 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:13:00,331 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:13:04,086 : [3/3] EVALUATION : Execution of _matmat took at 3.755 seconds.
2023-05-07 22:13:05,452 : [3/3] EVALUATION : Execution of _predict took at 5.168 seconds.
2023-05-07 22:13:06,527 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:13:06,630 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:13:10,403 : [3/3] EVALUATION : Execution of _matmat took at 3.773 seconds.
2023-05-07 22:13:11,798 : [3/3] EVALUATION : Execution of _predict took at 5.216 seconds.
2023-05-07 22:13:12,881 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:13:12,982 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:13:16,696 : [3/3] EVALUATION : Execution of _matmat took at 3.714 seconds.
2023-05-07 22:13:18,072 : [3/3] EVALUATION : Execution of _predict took at 5.137 seconds.
2023-05-07 22:13:19,139 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:13:19,239 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:13:23,029 : [3/3] EVALUATION : Execution of _matmat took at 3.789 seconds.
2023-05-07 22:13:24,381 : [3/3] EVALUATION : Execution of _predict took at 5.188 seconds.
2023-05-07 22:13:25,452 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:13:25,552 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:13:29,402 : [3/3] EVALUATION : Execution of _matmat took at 3.850 seconds.
2023-05-07 22:13:30,725 : [3/3] EVALUATION : Execution of _predict took at 5.220 seconds.
2023-05-07 22:13:31,783 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:13:31,887 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:13:35,790 : [3/3] EVALUATION : Execution of _matmat took at 3.903 seconds.
2023-05-07 22:13:37,171 : [3/3] EVALUATION : Execution of _predict took at 5.333 seconds.
2023-05-07 22:13:38,254 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:13:38,354 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:13:42,131 : [3/3] EVALUATION : Execution of _matmat took at 3.777 seconds.
2023-05-07 22:13:43,481 : [3/3] EVALUATION : Execution of _predict took at 5.174 seconds.
2023-05-07 22:13:44,558 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:13:44,658 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:13:48,360 : [3/3] EVALUATION : Execution of _matmat took at 3.702 seconds.
2023-05-07 22:13:49,701 : [3/3] EVALUATION : Execution of _predict took at 5.090 seconds.
2023-05-07 22:13:50,768 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:13:50,867 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:13:54,597 : [3/3] EVALUATION : Execution of _matmat took at 3.730 seconds.
2023-05-07 22:13:55,932 : [3/3] EVALUATION : Execution of _predict took at 5.111 seconds.
2023-05-07 22:13:56,996 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:13:57,098 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:14:00,887 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:14:02,284 : [3/3] EVALUATION : Execution of _predict took at 5.234 seconds.
2023-05-07 22:14:03,575 : [3/3] EVALUATION : Execution of _evaluate_model took at 158.125 seconds.
2023-05-07 22:14:03,576 : PIPELINE END : Execution of run took at 392.495 seconds.
d=0.01, ns=1, nf=0


2023-05-07 22:14:03,610 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:14:03,610 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:14:04,779 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.169 seconds.
2023-05-07 22:14:05,100 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:14:05,549 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:14:05,562 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.951 seconds.
2023-05-07 22:14:05,562 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:14:05,562 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:14:05,562 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:14:05,562 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:14:07,569 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:14:07,569 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:15:54,097 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:15:54,097 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:16:03,089 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:16:03,089 : [2/3] TRAINING : Execution of ldlt took at 115.520 seconds.
2023-05-07 22:16:03,089 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:16:03,089 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:16:03,089 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:16:03,230 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:16:07,186 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:16:07,186 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:16:12,962 : [2/3] TRAINING : Execution of _umr_scan took at 5.776 seconds.
2023-05-07 22:16:16,879 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:16:17,205 : [2/3] TRAINING : Execution of ainv_L took at 14.115 seconds.
2023-05-07 22:16:17,205 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:16:17,205 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:16:17,403 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:16:17,548 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:16:18,380 : [2/3] TRAINING : Execution of _construct_weights took at 130.811 seconds.
2023-05-07 22:16:18,381 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:16:18,381 : [2/3] TRAINING : Execution of _get_model took at 132.819 seconds.
2023-05-07 22:16:18,381 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:16:18,485 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:16:22,321 : [3/3] EVALUATION : Execution of _matmat took at 3.836 seconds.
2023-05-07 22:16:23,670 : [3/3] EVALUATION : Execution of _predict took at 5.234 seconds.
2023-05-07 22:16:24,679 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:16:24,781 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:16:28,529 : [3/3] EVALUATION : Execution of _matmat took at 3.748 seconds.
2023-05-07 22:16:29,848 : [3/3] EVALUATION : Execution of _predict took at 5.114 seconds.
2023-05-07 22:16:30,838 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:16:30,943 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:16:34,724 : [3/3] EVALUATION : Execution of _matmat took at 3.781 seconds.
2023-05-07 22:16:36,122 : [3/3] EVALUATION : Execution of _predict took at 5.229 seconds.
2023-05-07 22:16:37,127 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:16:37,229 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:16:41,017 : [3/3] EVALUATION : Execution of _matmat took at 3.788 seconds.
2023-05-07 22:16:42,398 : [3/3] EVALUATION : Execution of _predict took at 5.217 seconds.
2023-05-07 22:16:43,393 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:16:43,497 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:16:47,331 : [3/3] EVALUATION : Execution of _matmat took at 3.834 seconds.
2023-05-07 22:16:48,704 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 22:16:49,704 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:16:49,807 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:16:53,605 : [3/3] EVALUATION : Execution of _matmat took at 3.798 seconds.
2023-05-07 22:16:54,971 : [3/3] EVALUATION : Execution of _predict took at 5.212 seconds.
2023-05-07 22:16:55,978 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:16:56,080 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:16:59,957 : [3/3] EVALUATION : Execution of _matmat took at 3.877 seconds.
2023-05-07 22:17:01,312 : [3/3] EVALUATION : Execution of _predict took at 5.280 seconds.
2023-05-07 22:17:02,314 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:17:02,415 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:17:06,180 : [3/3] EVALUATION : Execution of _matmat took at 3.765 seconds.
2023-05-07 22:17:07,517 : [3/3] EVALUATION : Execution of _predict took at 5.149 seconds.
2023-05-07 22:17:08,521 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:17:08,625 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:17:12,449 : [3/3] EVALUATION : Execution of _matmat took at 3.824 seconds.
2023-05-07 22:17:13,815 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 22:17:14,825 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:17:14,925 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:17:18,730 : [3/3] EVALUATION : Execution of _matmat took at 3.805 seconds.
2023-05-07 22:17:20,054 : [3/3] EVALUATION : Execution of _predict took at 5.176 seconds.
2023-05-07 22:17:21,058 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:17:21,159 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:17:25,052 : [3/3] EVALUATION : Execution of _matmat took at 3.892 seconds.
2023-05-07 22:17:26,378 : [3/3] EVALUATION : Execution of _predict took at 5.266 seconds.
2023-05-07 22:17:27,376 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:17:27,479 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:17:31,281 : [3/3] EVALUATION : Execution of _matmat took at 3.802 seconds.
2023-05-07 22:17:32,694 : [3/3] EVALUATION : Execution of _predict took at 5.264 seconds.
2023-05-07 22:17:33,697 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:17:33,801 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:17:37,661 : [3/3] EVALUATION : Execution of _matmat took at 3.860 seconds.
2023-05-07 22:17:39,041 : [3/3] EVALUATION : Execution of _predict took at 5.290 seconds.
2023-05-07 22:17:40,043 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:17:40,145 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:17:43,983 : [3/3] EVALUATION : Execution of _matmat took at 3.838 seconds.
2023-05-07 22:17:45,325 : [3/3] EVALUATION : Execution of _predict took at 5.228 seconds.
2023-05-07 22:17:46,326 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:17:46,428 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:17:50,183 : [3/3] EVALUATION : Execution of _matmat took at 3.754 seconds.
2023-05-07 22:17:51,510 : [3/3] EVALUATION : Execution of _predict took at 5.130 seconds.
2023-05-07 22:17:52,510 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:17:52,611 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:17:56,382 : [3/3] EVALUATION : Execution of _matmat took at 3.771 seconds.
2023-05-07 22:17:57,746 : [3/3] EVALUATION : Execution of _predict took at 5.183 seconds.
2023-05-07 22:17:58,752 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:17:58,856 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:18:02,614 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 22:18:04,010 : [3/3] EVALUATION : Execution of _predict took at 5.203 seconds.
2023-05-07 22:18:05,027 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:18:05,130 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:18:08,900 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 22:18:10,276 : [3/3] EVALUATION : Execution of _predict took at 5.194 seconds.
2023-05-07 22:18:11,278 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:18:11,381 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:18:15,185 : [3/3] EVALUATION : Execution of _matmat took at 3.804 seconds.
2023-05-07 22:18:16,536 : [3/3] EVALUATION : Execution of _predict took at 5.204 seconds.
2023-05-07 22:18:17,543 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:18:17,644 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:18:21,524 : [3/3] EVALUATION : Execution of _matmat took at 3.880 seconds.
2023-05-07 22:18:22,847 : [3/3] EVALUATION : Execution of _predict took at 5.251 seconds.
2023-05-07 22:18:23,842 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:18:23,947 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:18:27,883 : [3/3] EVALUATION : Execution of _matmat took at 3.936 seconds.
2023-05-07 22:18:29,262 : [3/3] EVALUATION : Execution of _predict took at 5.365 seconds.
2023-05-07 22:18:30,273 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:18:30,374 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:18:34,161 : [3/3] EVALUATION : Execution of _matmat took at 3.787 seconds.
2023-05-07 22:18:35,509 : [3/3] EVALUATION : Execution of _predict took at 5.183 seconds.
2023-05-07 22:18:36,515 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:18:36,616 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:18:40,352 : [3/3] EVALUATION : Execution of _matmat took at 3.736 seconds.
2023-05-07 22:18:41,691 : [3/3] EVALUATION : Execution of _predict took at 5.122 seconds.
2023-05-07 22:18:42,694 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:18:42,795 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:18:46,501 : [3/3] EVALUATION : Execution of _matmat took at 3.706 seconds.
2023-05-07 22:18:47,835 : [3/3] EVALUATION : Execution of _predict took at 5.088 seconds.
2023-05-07 22:18:48,836 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:18:48,938 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:18:52,747 : [3/3] EVALUATION : Execution of _matmat took at 3.809 seconds.
2023-05-07 22:18:54,142 : [3/3] EVALUATION : Execution of _predict took at 5.252 seconds.
2023-05-07 22:18:55,364 : [3/3] EVALUATION : Execution of _evaluate_model took at 156.983 seconds.
2023-05-07 22:18:55,364 : PIPELINE END : Execution of run took at 291.754 seconds.
d=0.01, ns=1, nf=5


2023-05-07 22:18:55,399 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:18:55,399 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:18:56,570 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.171 seconds.
2023-05-07 22:18:56,894 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:18:57,344 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:18:57,357 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.958 seconds.
2023-05-07 22:18:57,357 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:18:57,357 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:18:57,357 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:18:57,357 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:18:59,364 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:18:59,364 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:20:45,775 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:20:45,775 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:20:54,767 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:20:54,767 : [2/3] TRAINING : Execution of ldlt took at 115.403 seconds.
2023-05-07 22:20:54,767 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:20:54,767 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:20:54,767 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:20:54,908 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:20:58,872 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:20:58,872 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:21:04,661 : [2/3] TRAINING : Execution of _umr_scan took at 5.789 seconds.
2023-05-07 22:21:08,579 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:21:08,579 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:21:10,456 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.877 seconds.
2023-05-07 22:21:14,462 : [2/3] TRAINING : Current maximum residual: 1.44548222, relative Frobenius norm squared: 0.06897550
2023-05-07 22:21:14,462 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:21:16,283 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.821 seconds.
2023-05-07 22:21:20,314 : [2/3] TRAINING : Current maximum residual: 1.15877812, relative Frobenius norm squared: 0.05363643
2023-05-07 22:21:20,314 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:21:22,041 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.727 seconds.
2023-05-07 22:21:26,034 : [2/3] TRAINING : Current maximum residual: 0.96807814, relative Frobenius norm squared: 0.04351673
2023-05-07 22:21:26,034 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:21:27,625 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.591 seconds.
2023-05-07 22:21:31,705 : [2/3] TRAINING : Current maximum residual: 0.87554008, relative Frobenius norm squared: 0.03642839
2023-05-07 22:21:31,705 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:21:33,260 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.555 seconds.
2023-05-07 22:21:37,316 : [2/3] TRAINING : Current maximum residual: 0.80421418, relative Frobenius norm squared: 0.03118567
2023-05-07 22:21:37,659 : [2/3] TRAINING : Execution of ainv_L took at 42.892 seconds.
2023-05-07 22:21:37,660 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:21:37,660 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:21:37,863 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:21:38,013 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:21:38,879 : [2/3] TRAINING : Execution of _construct_weights took at 159.515 seconds.
2023-05-07 22:21:38,880 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:21:38,880 : [2/3] TRAINING : Execution of _get_model took at 161.523 seconds.
2023-05-07 22:21:38,880 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:21:38,986 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:21:42,815 : [3/3] EVALUATION : Execution of _matmat took at 3.829 seconds.
2023-05-07 22:21:44,165 : [3/3] EVALUATION : Execution of _predict took at 5.228 seconds.
2023-05-07 22:21:45,220 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:21:45,323 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:21:49,073 : [3/3] EVALUATION : Execution of _matmat took at 3.749 seconds.
2023-05-07 22:21:50,393 : [3/3] EVALUATION : Execution of _predict took at 5.117 seconds.
2023-05-07 22:21:51,424 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:21:51,530 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 22:21:55,342 : [3/3] EVALUATION : Execution of _matmat took at 3.812 seconds.
2023-05-07 22:21:56,741 : [3/3] EVALUATION : Execution of _predict took at 5.262 seconds.
2023-05-07 22:21:57,777 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:21:57,881 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:22:01,683 : [3/3] EVALUATION : Execution of _matmat took at 3.802 seconds.
2023-05-07 22:22:03,064 : [3/3] EVALUATION : Execution of _predict took at 5.233 seconds.
2023-05-07 22:22:04,106 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:22:04,212 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:22:08,066 : [3/3] EVALUATION : Execution of _matmat took at 3.854 seconds.
2023-05-07 22:22:09,440 : [3/3] EVALUATION : Execution of _predict took at 5.277 seconds.
2023-05-07 22:22:10,475 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:22:10,579 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:22:14,352 : [3/3] EVALUATION : Execution of _matmat took at 3.773 seconds.
2023-05-07 22:22:15,718 : [3/3] EVALUATION : Execution of _predict took at 5.188 seconds.
2023-05-07 22:22:16,763 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:22:16,866 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:22:20,731 : [3/3] EVALUATION : Execution of _matmat took at 3.865 seconds.
2023-05-07 22:22:22,087 : [3/3] EVALUATION : Execution of _predict took at 5.270 seconds.
2023-05-07 22:22:23,123 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:22:23,226 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:22:27,009 : [3/3] EVALUATION : Execution of _matmat took at 3.783 seconds.
2023-05-07 22:22:28,346 : [3/3] EVALUATION : Execution of _predict took at 5.168 seconds.
2023-05-07 22:22:29,384 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:22:29,489 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:22:33,296 : [3/3] EVALUATION : Execution of _matmat took at 3.807 seconds.
2023-05-07 22:22:34,664 : [3/3] EVALUATION : Execution of _predict took at 5.225 seconds.
2023-05-07 22:22:35,707 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:22:35,809 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:22:39,639 : [3/3] EVALUATION : Execution of _matmat took at 3.830 seconds.
2023-05-07 22:22:40,962 : [3/3] EVALUATION : Execution of _predict took at 5.202 seconds.
2023-05-07 22:22:42,006 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:22:42,109 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:22:46,009 : [3/3] EVALUATION : Execution of _matmat took at 3.900 seconds.
2023-05-07 22:22:47,337 : [3/3] EVALUATION : Execution of _predict took at 5.276 seconds.
2023-05-07 22:22:48,376 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:22:48,481 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:22:52,275 : [3/3] EVALUATION : Execution of _matmat took at 3.794 seconds.
2023-05-07 22:22:53,689 : [3/3] EVALUATION : Execution of _predict took at 5.259 seconds.
2023-05-07 22:22:54,727 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:22:54,831 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:22:58,676 : [3/3] EVALUATION : Execution of _matmat took at 3.844 seconds.
2023-05-07 22:23:00,056 : [3/3] EVALUATION : Execution of _predict took at 5.275 seconds.
2023-05-07 22:23:01,096 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:23:01,200 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:23:05,029 : [3/3] EVALUATION : Execution of _matmat took at 3.829 seconds.
2023-05-07 22:23:06,374 : [3/3] EVALUATION : Execution of _predict took at 5.223 seconds.
2023-05-07 22:23:07,414 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:23:07,519 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:23:11,298 : [3/3] EVALUATION : Execution of _matmat took at 3.779 seconds.
2023-05-07 22:23:12,628 : [3/3] EVALUATION : Execution of _predict took at 5.158 seconds.
2023-05-07 22:23:13,665 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:23:13,769 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:23:17,532 : [3/3] EVALUATION : Execution of _matmat took at 3.764 seconds.
2023-05-07 22:23:18,899 : [3/3] EVALUATION : Execution of _predict took at 5.180 seconds.
2023-05-07 22:23:19,940 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:23:20,045 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:23:23,829 : [3/3] EVALUATION : Execution of _matmat took at 3.784 seconds.
2023-05-07 22:23:25,224 : [3/3] EVALUATION : Execution of _predict took at 5.228 seconds.
2023-05-07 22:23:26,275 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:23:26,378 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:23:30,120 : [3/3] EVALUATION : Execution of _matmat took at 3.742 seconds.
2023-05-07 22:23:31,497 : [3/3] EVALUATION : Execution of _predict took at 5.167 seconds.
2023-05-07 22:23:32,528 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:23:32,631 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:23:36,411 : [3/3] EVALUATION : Execution of _matmat took at 3.779 seconds.
2023-05-07 22:23:37,763 : [3/3] EVALUATION : Execution of _predict took at 5.180 seconds.
2023-05-07 22:23:38,803 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:23:38,906 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:23:42,764 : [3/3] EVALUATION : Execution of _matmat took at 3.858 seconds.
2023-05-07 22:23:44,089 : [3/3] EVALUATION : Execution of _predict took at 5.232 seconds.
2023-05-07 22:23:45,120 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:23:45,225 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 22:23:49,119 : [3/3] EVALUATION : Execution of _matmat took at 3.894 seconds.
2023-05-07 22:23:50,502 : [3/3] EVALUATION : Execution of _predict took at 5.327 seconds.
2023-05-07 22:23:51,550 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:23:51,652 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:23:55,428 : [3/3] EVALUATION : Execution of _matmat took at 3.776 seconds.
2023-05-07 22:23:56,780 : [3/3] EVALUATION : Execution of _predict took at 5.177 seconds.
2023-05-07 22:23:57,818 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:23:57,922 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:24:01,681 : [3/3] EVALUATION : Execution of _matmat took at 3.759 seconds.
2023-05-07 22:24:03,023 : [3/3] EVALUATION : Execution of _predict took at 5.150 seconds.
2023-05-07 22:24:04,066 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:24:04,168 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:24:07,906 : [3/3] EVALUATION : Execution of _matmat took at 3.739 seconds.
2023-05-07 22:24:09,243 : [3/3] EVALUATION : Execution of _predict took at 5.124 seconds.
2023-05-07 22:24:10,280 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:24:10,384 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:24:14,205 : [3/3] EVALUATION : Execution of _matmat took at 3.821 seconds.
2023-05-07 22:24:15,603 : [3/3] EVALUATION : Execution of _predict took at 5.269 seconds.
2023-05-07 22:24:16,872 : [3/3] EVALUATION : Execution of _evaluate_model took at 157.992 seconds.
2023-05-07 22:24:16,873 : PIPELINE END : Execution of run took at 321.474 seconds.
d=0.01, ns=1, nf=10


2023-05-07 22:24:16,907 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:24:16,907 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:24:18,106 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.198 seconds.
2023-05-07 22:24:18,446 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:24:18,907 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:24:18,920 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.013 seconds.
2023-05-07 22:24:18,920 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:24:18,920 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:24:18,920 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:24:18,920 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:24:20,971 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:24:20,971 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:26:11,052 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:26:11,052 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:26:20,178 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:26:20,178 : [2/3] TRAINING : Execution of ldlt took at 119.207 seconds.
2023-05-07 22:26:20,178 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:26:20,178 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:26:20,178 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:26:20,324 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:26:24,415 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:26:24,416 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:26:30,278 : [2/3] TRAINING : Execution of _umr_scan took at 5.862 seconds.
2023-05-07 22:26:34,332 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:26:34,332 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:26:36,234 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.902 seconds.
2023-05-07 22:26:40,366 : [2/3] TRAINING : Current maximum residual: 1.44548222, relative Frobenius norm squared: 0.06897550
2023-05-07 22:26:40,366 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:26:42,228 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.862 seconds.
2023-05-07 22:26:46,362 : [2/3] TRAINING : Current maximum residual: 1.15877812, relative Frobenius norm squared: 0.05363643
2023-05-07 22:26:46,362 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:26:48,119 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.757 seconds.
2023-05-07 22:26:52,247 : [2/3] TRAINING : Current maximum residual: 0.96807814, relative Frobenius norm squared: 0.04351673
2023-05-07 22:26:52,247 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:26:53,867 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.620 seconds.
2023-05-07 22:26:57,931 : [2/3] TRAINING : Current maximum residual: 0.87554008, relative Frobenius norm squared: 0.03642839
2023-05-07 22:26:57,931 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:26:59,489 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.557 seconds.
2023-05-07 22:27:03,564 : [2/3] TRAINING : Current maximum residual: 0.80421418, relative Frobenius norm squared: 0.03118567
2023-05-07 22:27:03,564 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 22:27:05,106 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.542 seconds.
2023-05-07 22:27:09,177 : [2/3] TRAINING : Current maximum residual: 0.67853179, relative Frobenius norm squared: 0.02713244
2023-05-07 22:27:09,177 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 22:27:10,895 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.719 seconds.
2023-05-07 22:27:14,950 : [2/3] TRAINING : Current maximum residual: 0.62669022, relative Frobenius norm squared: 0.02389442
2023-05-07 22:27:14,950 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 22:27:16,577 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.627 seconds.
2023-05-07 22:27:20,582 : [2/3] TRAINING : Current maximum residual: 0.55268894, relative Frobenius norm squared: 0.02132918
2023-05-07 22:27:20,582 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 22:27:22,110 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.528 seconds.
2023-05-07 22:27:26,166 : [2/3] TRAINING : Current maximum residual: 0.51230481, relative Frobenius norm squared: 0.01916238
2023-05-07 22:27:26,166 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 22:27:27,698 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.532 seconds.
2023-05-07 22:27:31,738 : [2/3] TRAINING : Current maximum residual: 0.46552908, relative Frobenius norm squared: 0.01734605
2023-05-07 22:27:32,076 : [2/3] TRAINING : Execution of ainv_L took at 71.898 seconds.
2023-05-07 22:27:32,077 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:27:32,077 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:27:32,278 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:27:32,428 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:27:33,285 : [2/3] TRAINING : Execution of _construct_weights took at 192.314 seconds.
2023-05-07 22:27:33,286 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:27:33,286 : [2/3] TRAINING : Execution of _get_model took at 194.366 seconds.
2023-05-07 22:27:33,286 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:27:33,391 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:27:37,199 : [3/3] EVALUATION : Execution of _matmat took at 3.808 seconds.
2023-05-07 22:27:38,548 : [3/3] EVALUATION : Execution of _predict took at 5.205 seconds.
2023-05-07 22:27:39,607 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:27:39,709 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:27:43,470 : [3/3] EVALUATION : Execution of _matmat took at 3.760 seconds.
2023-05-07 22:27:44,788 : [3/3] EVALUATION : Execution of _predict took at 5.126 seconds.
2023-05-07 22:27:45,834 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:27:45,939 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:27:49,756 : [3/3] EVALUATION : Execution of _matmat took at 3.817 seconds.
2023-05-07 22:27:51,153 : [3/3] EVALUATION : Execution of _predict took at 5.264 seconds.
2023-05-07 22:27:52,200 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:27:52,303 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:27:56,087 : [3/3] EVALUATION : Execution of _matmat took at 3.784 seconds.
2023-05-07 22:27:57,467 : [3/3] EVALUATION : Execution of _predict took at 5.212 seconds.
2023-05-07 22:27:58,522 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:27:58,626 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:28:02,442 : [3/3] EVALUATION : Execution of _matmat took at 3.816 seconds.
2023-05-07 22:28:03,814 : [3/3] EVALUATION : Execution of _predict took at 5.237 seconds.
2023-05-07 22:28:04,861 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:28:04,966 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:28:08,773 : [3/3] EVALUATION : Execution of _matmat took at 3.807 seconds.
2023-05-07 22:28:10,137 : [3/3] EVALUATION : Execution of _predict took at 5.221 seconds.
2023-05-07 22:28:11,192 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:28:11,296 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:28:15,178 : [3/3] EVALUATION : Execution of _matmat took at 3.882 seconds.
2023-05-07 22:28:16,533 : [3/3] EVALUATION : Execution of _predict took at 5.286 seconds.
2023-05-07 22:28:17,581 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:28:17,684 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:28:21,445 : [3/3] EVALUATION : Execution of _matmat took at 3.761 seconds.
2023-05-07 22:28:22,782 : [3/3] EVALUATION : Execution of _predict took at 5.146 seconds.
2023-05-07 22:28:23,831 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:28:23,936 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:28:27,713 : [3/3] EVALUATION : Execution of _matmat took at 3.778 seconds.
2023-05-07 22:28:29,080 : [3/3] EVALUATION : Execution of _predict took at 5.193 seconds.
2023-05-07 22:28:30,133 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:28:30,234 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:28:34,063 : [3/3] EVALUATION : Execution of _matmat took at 3.828 seconds.
2023-05-07 22:28:35,386 : [3/3] EVALUATION : Execution of _predict took at 5.199 seconds.
2023-05-07 22:28:36,439 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:28:36,541 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:28:40,435 : [3/3] EVALUATION : Execution of _matmat took at 3.893 seconds.
2023-05-07 22:28:41,761 : [3/3] EVALUATION : Execution of _predict took at 5.267 seconds.
2023-05-07 22:28:42,813 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:28:42,917 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:28:46,700 : [3/3] EVALUATION : Execution of _matmat took at 3.783 seconds.
2023-05-07 22:28:48,112 : [3/3] EVALUATION : Execution of _predict took at 5.245 seconds.
2023-05-07 22:28:49,166 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:28:49,270 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:28:53,108 : [3/3] EVALUATION : Execution of _matmat took at 3.837 seconds.
2023-05-07 22:28:54,487 : [3/3] EVALUATION : Execution of _predict took at 5.266 seconds.
2023-05-07 22:28:55,542 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:28:55,645 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:28:59,457 : [3/3] EVALUATION : Execution of _matmat took at 3.812 seconds.
2023-05-07 22:29:00,801 : [3/3] EVALUATION : Execution of _predict took at 5.204 seconds.
2023-05-07 22:29:01,855 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:29:01,958 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:29:05,720 : [3/3] EVALUATION : Execution of _matmat took at 3.761 seconds.
2023-05-07 22:29:07,048 : [3/3] EVALUATION : Execution of _predict took at 5.137 seconds.
2023-05-07 22:29:08,088 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:29:08,190 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:29:11,944 : [3/3] EVALUATION : Execution of _matmat took at 3.754 seconds.
2023-05-07 22:29:13,308 : [3/3] EVALUATION : Execution of _predict took at 5.167 seconds.
2023-05-07 22:29:14,359 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:29:14,462 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:29:18,206 : [3/3] EVALUATION : Execution of _matmat took at 3.744 seconds.
2023-05-07 22:29:19,602 : [3/3] EVALUATION : Execution of _predict took at 5.189 seconds.
2023-05-07 22:29:20,666 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:29:20,768 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:29:24,488 : [3/3] EVALUATION : Execution of _matmat took at 3.720 seconds.
2023-05-07 22:29:25,864 : [3/3] EVALUATION : Execution of _predict took at 5.144 seconds.
2023-05-07 22:29:26,911 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:29:27,012 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:29:30,760 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-07 22:29:32,112 : [3/3] EVALUATION : Execution of _predict took at 5.147 seconds.
2023-05-07 22:29:33,165 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:29:33,267 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:29:37,130 : [3/3] EVALUATION : Execution of _matmat took at 3.863 seconds.
2023-05-07 22:29:38,453 : [3/3] EVALUATION : Execution of _predict took at 5.234 seconds.
2023-05-07 22:29:39,500 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:29:39,605 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:29:43,475 : [3/3] EVALUATION : Execution of _matmat took at 3.870 seconds.
2023-05-07 22:29:44,854 : [3/3] EVALUATION : Execution of _predict took at 5.299 seconds.
2023-05-07 22:29:45,911 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:29:46,012 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:29:49,772 : [3/3] EVALUATION : Execution of _matmat took at 3.759 seconds.
2023-05-07 22:29:51,121 : [3/3] EVALUATION : Execution of _predict took at 5.156 seconds.
2023-05-07 22:29:52,174 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:29:52,276 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:29:56,005 : [3/3] EVALUATION : Execution of _matmat took at 3.729 seconds.
2023-05-07 22:29:57,345 : [3/3] EVALUATION : Execution of _predict took at 5.117 seconds.
2023-05-07 22:29:58,393 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:29:58,495 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:30:02,230 : [3/3] EVALUATION : Execution of _matmat took at 3.735 seconds.
2023-05-07 22:30:03,566 : [3/3] EVALUATION : Execution of _predict took at 5.119 seconds.
2023-05-07 22:30:04,611 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:30:04,715 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:30:08,525 : [3/3] EVALUATION : Execution of _matmat took at 3.810 seconds.
2023-05-07 22:30:09,920 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 22:30:11,203 : [3/3] EVALUATION : Execution of _evaluate_model took at 157.916 seconds.
2023-05-07 22:30:11,203 : PIPELINE END : Execution of run took at 354.296 seconds.
d=0.01, ns=1, nf=20


2023-05-07 22:30:11,238 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:30:11,238 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:30:12,428 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.190 seconds.
2023-05-07 22:30:12,762 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:30:13,219 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:30:13,232 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.994 seconds.
2023-05-07 22:30:13,232 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:30:13,232 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:30:13,232 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:30:13,232 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:30:15,302 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:30:15,302 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:32:04,154 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:32:04,154 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:32:13,230 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:32:13,231 : [2/3] TRAINING : Execution of ldlt took at 117.929 seconds.
2023-05-07 22:32:13,231 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:32:13,231 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:32:13,231 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:32:13,375 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:32:17,427 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:32:17,427 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:32:23,258 : [2/3] TRAINING : Execution of _umr_scan took at 5.830 seconds.
2023-05-07 22:32:27,271 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:32:27,271 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:32:29,162 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.891 seconds.
2023-05-07 22:32:33,248 : [2/3] TRAINING : Current maximum residual: 1.44548222, relative Frobenius norm squared: 0.06897550
2023-05-07 22:32:33,248 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:32:35,072 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.824 seconds.
2023-05-07 22:32:39,141 : [2/3] TRAINING : Current maximum residual: 1.15877812, relative Frobenius norm squared: 0.05363643
2023-05-07 22:32:39,141 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:32:40,882 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.741 seconds.
2023-05-07 22:32:44,965 : [2/3] TRAINING : Current maximum residual: 0.96807814, relative Frobenius norm squared: 0.04351673
2023-05-07 22:32:44,965 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:32:46,569 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.604 seconds.
2023-05-07 22:32:50,573 : [2/3] TRAINING : Current maximum residual: 0.87554008, relative Frobenius norm squared: 0.03642839
2023-05-07 22:32:50,573 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:32:52,117 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.544 seconds.
2023-05-07 22:32:56,126 : [2/3] TRAINING : Current maximum residual: 0.80421418, relative Frobenius norm squared: 0.03118567
2023-05-07 22:32:56,126 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 22:32:57,652 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.525 seconds.
2023-05-07 22:33:01,677 : [2/3] TRAINING : Current maximum residual: 0.67853179, relative Frobenius norm squared: 0.02713244
2023-05-07 22:33:01,677 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 22:33:03,375 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.698 seconds.
2023-05-07 22:33:07,476 : [2/3] TRAINING : Current maximum residual: 0.62669022, relative Frobenius norm squared: 0.02389442
2023-05-07 22:33:07,477 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 22:33:09,118 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.641 seconds.
2023-05-07 22:33:13,196 : [2/3] TRAINING : Current maximum residual: 0.55268894, relative Frobenius norm squared: 0.02132918
2023-05-07 22:33:13,197 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 22:33:14,731 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.534 seconds.
2023-05-07 22:33:18,801 : [2/3] TRAINING : Current maximum residual: 0.51230481, relative Frobenius norm squared: 0.01916238
2023-05-07 22:33:18,801 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 22:33:20,324 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.523 seconds.
2023-05-07 22:33:24,371 : [2/3] TRAINING : Current maximum residual: 0.46552908, relative Frobenius norm squared: 0.01734605
2023-05-07 22:33:24,371 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 22:33:25,877 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.506 seconds.
2023-05-07 22:33:29,901 : [2/3] TRAINING : Current maximum residual: 0.43514550, relative Frobenius norm squared: 0.01580393
2023-05-07 22:33:29,902 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 22:33:31,447 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.545 seconds.
2023-05-07 22:33:35,486 : [2/3] TRAINING : Current maximum residual: 0.40611854, relative Frobenius norm squared: 0.01447830
2023-05-07 22:33:35,486 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 22:33:36,973 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.487 seconds.
2023-05-07 22:33:40,967 : [2/3] TRAINING : Current maximum residual: 0.38049554, relative Frobenius norm squared: 0.01333807
2023-05-07 22:33:40,967 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 22:33:42,509 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.541 seconds.
2023-05-07 22:33:46,521 : [2/3] TRAINING : Current maximum residual: 0.36086914, relative Frobenius norm squared: 0.01233593
2023-05-07 22:33:46,521 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 22:33:47,928 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.407 seconds.
2023-05-07 22:33:51,979 : [2/3] TRAINING : Current maximum residual: 0.34225972, relative Frobenius norm squared: 0.01143524
2023-05-07 22:33:51,979 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 22:33:53,506 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.527 seconds.
2023-05-07 22:33:57,551 : [2/3] TRAINING : Current maximum residual: 0.32447630, relative Frobenius norm squared: 0.01066597
2023-05-07 22:33:57,552 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 22:33:59,046 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.494 seconds.
2023-05-07 22:34:03,063 : [2/3] TRAINING : Current maximum residual: 0.30873194, relative Frobenius norm squared: 0.00998975
2023-05-07 22:34:03,063 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 22:34:04,602 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.539 seconds.
2023-05-07 22:34:08,637 : [2/3] TRAINING : Current maximum residual: 0.29330708, relative Frobenius norm squared: 0.00938230
2023-05-07 22:34:08,637 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 22:34:10,022 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.385 seconds.
2023-05-07 22:34:14,053 : [2/3] TRAINING : Current maximum residual: 0.27974174, relative Frobenius norm squared: 0.00882932
2023-05-07 22:34:14,053 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 22:34:15,489 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.436 seconds.
2023-05-07 22:34:19,470 : [2/3] TRAINING : Current maximum residual: 0.26701874, relative Frobenius norm squared: 0.00833511
2023-05-07 22:34:19,807 : [2/3] TRAINING : Execution of ainv_L took at 126.576 seconds.
2023-05-07 22:34:19,808 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:34:19,808 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:34:20,008 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:34:20,158 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:34:21,014 : [2/3] TRAINING : Execution of _construct_weights took at 245.712 seconds.
2023-05-07 22:34:21,015 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:34:21,015 : [2/3] TRAINING : Execution of _get_model took at 247.783 seconds.
2023-05-07 22:34:21,015 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:34:21,120 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:34:24,942 : [3/3] EVALUATION : Execution of _matmat took at 3.823 seconds.
2023-05-07 22:34:26,291 : [3/3] EVALUATION : Execution of _predict took at 5.220 seconds.
2023-05-07 22:34:27,373 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:34:27,475 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:34:31,240 : [3/3] EVALUATION : Execution of _matmat took at 3.765 seconds.
2023-05-07 22:34:32,558 : [3/3] EVALUATION : Execution of _predict took at 5.130 seconds.
2023-05-07 22:34:33,628 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:34:33,733 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:34:37,516 : [3/3] EVALUATION : Execution of _matmat took at 3.783 seconds.
2023-05-07 22:34:38,898 : [3/3] EVALUATION : Execution of _predict took at 5.215 seconds.
2023-05-07 22:34:39,968 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:34:40,071 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:34:43,861 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:34:45,243 : [3/3] EVALUATION : Execution of _predict took at 5.220 seconds.
2023-05-07 22:34:46,312 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:34:46,415 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:34:50,240 : [3/3] EVALUATION : Execution of _matmat took at 3.825 seconds.
2023-05-07 22:34:51,614 : [3/3] EVALUATION : Execution of _predict took at 5.247 seconds.
2023-05-07 22:34:52,677 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:34:52,780 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:34:56,563 : [3/3] EVALUATION : Execution of _matmat took at 3.783 seconds.
2023-05-07 22:34:57,929 : [3/3] EVALUATION : Execution of _predict took at 5.197 seconds.
2023-05-07 22:34:59,009 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:34:59,111 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:35:02,958 : [3/3] EVALUATION : Execution of _matmat took at 3.847 seconds.
2023-05-07 22:35:04,314 : [3/3] EVALUATION : Execution of _predict took at 5.251 seconds.
2023-05-07 22:35:05,384 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:35:05,486 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:35:09,259 : [3/3] EVALUATION : Execution of _matmat took at 3.773 seconds.
2023-05-07 22:35:10,594 : [3/3] EVALUATION : Execution of _predict took at 5.156 seconds.
2023-05-07 22:35:11,667 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:35:11,771 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:35:15,557 : [3/3] EVALUATION : Execution of _matmat took at 3.786 seconds.
2023-05-07 22:35:16,923 : [3/3] EVALUATION : Execution of _predict took at 5.201 seconds.
2023-05-07 22:35:18,002 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:35:18,103 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:35:21,940 : [3/3] EVALUATION : Execution of _matmat took at 3.837 seconds.
2023-05-07 22:35:23,262 : [3/3] EVALUATION : Execution of _predict took at 5.206 seconds.
2023-05-07 22:35:24,334 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:35:24,436 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:35:28,331 : [3/3] EVALUATION : Execution of _matmat took at 3.895 seconds.
2023-05-07 22:35:29,658 : [3/3] EVALUATION : Execution of _predict took at 5.269 seconds.
2023-05-07 22:35:30,729 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:35:30,833 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:35:34,630 : [3/3] EVALUATION : Execution of _matmat took at 3.797 seconds.
2023-05-07 22:35:36,044 : [3/3] EVALUATION : Execution of _predict took at 5.260 seconds.
2023-05-07 22:35:37,113 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:35:37,217 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:35:41,076 : [3/3] EVALUATION : Execution of _matmat took at 3.860 seconds.
2023-05-07 22:35:42,456 : [3/3] EVALUATION : Execution of _predict took at 5.289 seconds.
2023-05-07 22:35:43,530 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:35:43,632 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:35:47,459 : [3/3] EVALUATION : Execution of _matmat took at 3.826 seconds.
2023-05-07 22:35:48,800 : [3/3] EVALUATION : Execution of _predict took at 5.216 seconds.
2023-05-07 22:35:49,872 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:35:49,977 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:35:53,724 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-07 22:35:55,052 : [3/3] EVALUATION : Execution of _predict took at 5.125 seconds.
2023-05-07 22:35:56,122 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:35:56,223 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:35:59,958 : [3/3] EVALUATION : Execution of _matmat took at 3.735 seconds.
2023-05-07 22:36:01,323 : [3/3] EVALUATION : Execution of _predict took at 5.148 seconds.
2023-05-07 22:36:02,397 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:36:02,500 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:36:06,246 : [3/3] EVALUATION : Execution of _matmat took at 3.746 seconds.
2023-05-07 22:36:07,642 : [3/3] EVALUATION : Execution of _predict took at 5.190 seconds.
2023-05-07 22:36:08,728 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:36:08,830 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:36:12,557 : [3/3] EVALUATION : Execution of _matmat took at 3.727 seconds.
2023-05-07 22:36:13,934 : [3/3] EVALUATION : Execution of _predict took at 5.151 seconds.
2023-05-07 22:36:15,002 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:36:15,103 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:36:18,845 : [3/3] EVALUATION : Execution of _matmat took at 3.742 seconds.
2023-05-07 22:36:20,199 : [3/3] EVALUATION : Execution of _predict took at 5.143 seconds.
2023-05-07 22:36:21,268 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:36:21,368 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:36:25,318 : [3/3] EVALUATION : Execution of _matmat took at 3.950 seconds.
2023-05-07 22:36:26,642 : [3/3] EVALUATION : Execution of _predict took at 5.321 seconds.
2023-05-07 22:36:27,700 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:36:27,803 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:36:31,709 : [3/3] EVALUATION : Execution of _matmat took at 3.905 seconds.
2023-05-07 22:36:33,090 : [3/3] EVALUATION : Execution of _predict took at 5.336 seconds.
2023-05-07 22:36:34,172 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:36:34,272 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:36:38,046 : [3/3] EVALUATION : Execution of _matmat took at 3.774 seconds.
2023-05-07 22:36:39,396 : [3/3] EVALUATION : Execution of _predict took at 5.171 seconds.
2023-05-07 22:36:40,470 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:36:40,572 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:36:44,310 : [3/3] EVALUATION : Execution of _matmat took at 3.738 seconds.
2023-05-07 22:36:45,649 : [3/3] EVALUATION : Execution of _predict took at 5.124 seconds.
2023-05-07 22:36:46,719 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:36:46,819 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:36:50,560 : [3/3] EVALUATION : Execution of _matmat took at 3.741 seconds.
2023-05-07 22:36:51,894 : [3/3] EVALUATION : Execution of _predict took at 5.121 seconds.
2023-05-07 22:36:52,958 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:36:53,059 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:36:56,859 : [3/3] EVALUATION : Execution of _matmat took at 3.799 seconds.
2023-05-07 22:36:58,254 : [3/3] EVALUATION : Execution of _predict took at 5.242 seconds.
2023-05-07 22:36:59,549 : [3/3] EVALUATION : Execution of _evaluate_model took at 158.533 seconds.
2023-05-07 22:36:59,549 : PIPELINE END : Execution of run took at 408.311 seconds.
d=0.01, ns=2, nf=0


2023-05-07 22:36:59,583 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:36:59,583 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:37:00,757 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.174 seconds.
2023-05-07 22:37:01,081 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:37:01,535 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:37:01,547 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.964 seconds.
2023-05-07 22:37:01,548 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:37:01,548 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:37:01,548 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:37:01,548 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:37:03,712 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:37:03,712 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:38:50,549 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:38:50,549 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:38:59,533 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:38:59,533 : [2/3] TRAINING : Execution of ldlt took at 115.821 seconds.
2023-05-07 22:38:59,534 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:38:59,534 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:38:59,534 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:38:59,674 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:39:03,660 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:39:03,660 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:39:09,458 : [2/3] TRAINING : Execution of _umr_scan took at 5.798 seconds.
2023-05-07 22:39:13,397 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:39:13,397 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 22:39:59,982 : [2/3] TRAINING : Execution of _umr_scan took at 46.585 seconds.
2023-05-07 22:40:03,986 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 22:40:04,313 : [2/3] TRAINING : Execution of ainv_L took at 64.779 seconds.
2023-05-07 22:40:04,313 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:40:04,313 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:40:04,511 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:40:04,657 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:40:05,509 : [2/3] TRAINING : Execution of _construct_weights took at 181.796 seconds.
2023-05-07 22:40:05,510 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:40:05,510 : [2/3] TRAINING : Execution of _get_model took at 183.962 seconds.
2023-05-07 22:40:05,510 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:40:05,614 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:40:09,422 : [3/3] EVALUATION : Execution of _matmat took at 3.808 seconds.
2023-05-07 22:40:10,769 : [3/3] EVALUATION : Execution of _predict took at 5.203 seconds.
2023-05-07 22:40:11,877 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:40:11,977 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:40:15,707 : [3/3] EVALUATION : Execution of _matmat took at 3.729 seconds.
2023-05-07 22:40:17,023 : [3/3] EVALUATION : Execution of _predict took at 5.092 seconds.
2023-05-07 22:40:18,111 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:40:18,216 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:40:21,986 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 22:40:23,383 : [3/3] EVALUATION : Execution of _predict took at 5.216 seconds.
2023-05-07 22:40:24,482 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:40:24,583 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:40:28,354 : [3/3] EVALUATION : Execution of _matmat took at 3.771 seconds.
2023-05-07 22:40:29,733 : [3/3] EVALUATION : Execution of _predict took at 5.197 seconds.
2023-05-07 22:40:30,823 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:40:30,926 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:40:34,743 : [3/3] EVALUATION : Execution of _matmat took at 3.817 seconds.
2023-05-07 22:40:36,117 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 22:40:37,195 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:40:37,297 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:40:41,055 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 22:40:42,418 : [3/3] EVALUATION : Execution of _predict took at 5.169 seconds.
2023-05-07 22:40:43,512 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:40:43,614 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:40:47,466 : [3/3] EVALUATION : Execution of _matmat took at 3.852 seconds.
2023-05-07 22:40:48,820 : [3/3] EVALUATION : Execution of _predict took at 5.253 seconds.
2023-05-07 22:40:49,908 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:40:50,008 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:40:53,763 : [3/3] EVALUATION : Execution of _matmat took at 3.754 seconds.
2023-05-07 22:40:55,099 : [3/3] EVALUATION : Execution of _predict took at 5.138 seconds.
2023-05-07 22:40:56,190 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:40:56,293 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:41:00,053 : [3/3] EVALUATION : Execution of _matmat took at 3.760 seconds.
2023-05-07 22:41:01,417 : [3/3] EVALUATION : Execution of _predict took at 5.172 seconds.
2023-05-07 22:41:02,516 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:41:02,616 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:41:06,434 : [3/3] EVALUATION : Execution of _matmat took at 3.817 seconds.
2023-05-07 22:41:07,756 : [3/3] EVALUATION : Execution of _predict took at 5.187 seconds.
2023-05-07 22:41:08,848 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:41:08,949 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:41:12,831 : [3/3] EVALUATION : Execution of _matmat took at 3.881 seconds.
2023-05-07 22:41:14,156 : [3/3] EVALUATION : Execution of _predict took at 5.254 seconds.
2023-05-07 22:41:15,241 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:41:15,343 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:41:19,134 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:41:20,546 : [3/3] EVALUATION : Execution of _predict took at 5.251 seconds.
2023-05-07 22:41:21,640 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:41:21,742 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:41:25,572 : [3/3] EVALUATION : Execution of _matmat took at 3.830 seconds.
2023-05-07 22:41:26,952 : [3/3] EVALUATION : Execution of _predict took at 5.258 seconds.
2023-05-07 22:41:28,051 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:41:28,153 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:41:31,970 : [3/3] EVALUATION : Execution of _matmat took at 3.817 seconds.
2023-05-07 22:41:33,311 : [3/3] EVALUATION : Execution of _predict took at 5.207 seconds.
2023-05-07 22:41:34,404 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:41:34,505 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:41:38,244 : [3/3] EVALUATION : Execution of _matmat took at 3.739 seconds.
2023-05-07 22:41:39,572 : [3/3] EVALUATION : Execution of _predict took at 5.113 seconds.
2023-05-07 22:41:40,654 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:41:40,755 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:41:44,493 : [3/3] EVALUATION : Execution of _matmat took at 3.738 seconds.
2023-05-07 22:41:45,857 : [3/3] EVALUATION : Execution of _predict took at 5.150 seconds.
2023-05-07 22:41:46,953 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:41:47,055 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:41:50,790 : [3/3] EVALUATION : Execution of _matmat took at 3.734 seconds.
2023-05-07 22:41:52,184 : [3/3] EVALUATION : Execution of _predict took at 5.177 seconds.
2023-05-07 22:41:53,291 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:41:53,392 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:41:57,118 : [3/3] EVALUATION : Execution of _matmat took at 3.726 seconds.
2023-05-07 22:41:58,493 : [3/3] EVALUATION : Execution of _predict took at 5.148 seconds.
2023-05-07 22:41:59,584 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:41:59,685 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 22:42:03,443 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 22:42:04,795 : [3/3] EVALUATION : Execution of _predict took at 5.157 seconds.
2023-05-07 22:42:05,884 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:42:05,985 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:42:09,844 : [3/3] EVALUATION : Execution of _matmat took at 3.859 seconds.
2023-05-07 22:42:11,168 : [3/3] EVALUATION : Execution of _predict took at 5.230 seconds.
2023-05-07 22:42:12,252 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:42:12,357 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:42:16,293 : [3/3] EVALUATION : Execution of _matmat took at 3.936 seconds.
2023-05-07 22:42:17,674 : [3/3] EVALUATION : Execution of _predict took at 5.366 seconds.
2023-05-07 22:42:18,773 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:42:18,874 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:42:22,618 : [3/3] EVALUATION : Execution of _matmat took at 3.745 seconds.
2023-05-07 22:42:23,969 : [3/3] EVALUATION : Execution of _predict took at 5.142 seconds.
2023-05-07 22:42:25,063 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:42:25,164 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:42:28,898 : [3/3] EVALUATION : Execution of _matmat took at 3.734 seconds.
2023-05-07 22:42:30,238 : [3/3] EVALUATION : Execution of _predict took at 5.121 seconds.
2023-05-07 22:42:31,327 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:42:31,427 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:42:35,162 : [3/3] EVALUATION : Execution of _matmat took at 3.735 seconds.
2023-05-07 22:42:36,496 : [3/3] EVALUATION : Execution of _predict took at 5.116 seconds.
2023-05-07 22:42:37,585 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:42:37,687 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:42:41,479 : [3/3] EVALUATION : Execution of _matmat took at 3.792 seconds.
2023-05-07 22:42:42,875 : [3/3] EVALUATION : Execution of _predict took at 5.236 seconds.
2023-05-07 22:42:44,194 : [3/3] EVALUATION : Execution of _evaluate_model took at 158.684 seconds.
2023-05-07 22:42:44,194 : PIPELINE END : Execution of run took at 344.611 seconds.
d=0.01, ns=2, nf=5


2023-05-07 22:42:44,228 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:42:44,229 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:42:45,403 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.174 seconds.
2023-05-07 22:42:45,726 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:42:46,178 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:42:46,191 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.962 seconds.
2023-05-07 22:42:46,191 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:42:46,191 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:42:46,191 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:42:46,191 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:42:48,200 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:42:48,200 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:44:35,185 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:44:35,186 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:44:44,172 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:44:44,172 : [2/3] TRAINING : Execution of ldlt took at 115.972 seconds.
2023-05-07 22:44:44,172 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:44:44,172 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:44:44,172 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:44:44,314 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:44:48,286 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:44:48,286 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:44:54,060 : [2/3] TRAINING : Execution of _umr_scan took at 5.774 seconds.
2023-05-07 22:44:58,002 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:44:58,002 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 22:45:44,605 : [2/3] TRAINING : Execution of _umr_scan took at 46.603 seconds.
2023-05-07 22:45:48,586 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 22:45:48,586 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:45:51,005 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.419 seconds.
2023-05-07 22:45:55,001 : [2/3] TRAINING : Current maximum residual: 0.87434340, relative Frobenius norm squared: 0.00759962
2023-05-07 22:45:55,001 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:45:56,934 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.933 seconds.
2023-05-07 22:46:01,013 : [2/3] TRAINING : Current maximum residual: 0.80812791, relative Frobenius norm squared: 0.00716703
2023-05-07 22:46:01,013 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:46:02,686 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.672 seconds.
2023-05-07 22:46:06,801 : [2/3] TRAINING : Current maximum residual: 0.49528971, relative Frobenius norm squared: 0.00679284
2023-05-07 22:46:06,801 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:46:08,451 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.650 seconds.
2023-05-07 22:46:12,570 : [2/3] TRAINING : Current maximum residual: 0.23269910, relative Frobenius norm squared: 0.00651196
2023-05-07 22:46:12,570 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:46:14,139 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.570 seconds.
2023-05-07 22:46:18,206 : [2/3] TRAINING : Current maximum residual: 0.22601967, relative Frobenius norm squared: 0.00624679
2023-05-07 22:46:18,549 : [2/3] TRAINING : Execution of ainv_L took at 94.377 seconds.
2023-05-07 22:46:18,550 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:46:18,550 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:46:18,753 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:46:18,906 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:46:19,778 : [2/3] TRAINING : Execution of _construct_weights took at 211.579 seconds.
2023-05-07 22:46:19,780 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:46:19,780 : [2/3] TRAINING : Execution of _get_model took at 213.589 seconds.
2023-05-07 22:46:19,780 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:46:19,885 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:46:23,711 : [3/3] EVALUATION : Execution of _matmat took at 3.826 seconds.
2023-05-07 22:46:25,037 : [3/3] EVALUATION : Execution of _predict took at 5.201 seconds.
2023-05-07 22:46:26,134 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:46:26,236 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:46:29,985 : [3/3] EVALUATION : Execution of _matmat took at 3.749 seconds.
2023-05-07 22:46:31,303 : [3/3] EVALUATION : Execution of _predict took at 5.115 seconds.
2023-05-07 22:46:32,391 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:46:32,496 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:46:36,275 : [3/3] EVALUATION : Execution of _matmat took at 3.779 seconds.
2023-05-07 22:46:37,672 : [3/3] EVALUATION : Execution of _predict took at 5.227 seconds.
2023-05-07 22:46:38,761 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:46:38,866 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:46:42,649 : [3/3] EVALUATION : Execution of _matmat took at 3.783 seconds.
2023-05-07 22:46:44,029 : [3/3] EVALUATION : Execution of _predict took at 5.212 seconds.
2023-05-07 22:46:45,115 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:46:45,220 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:46:49,040 : [3/3] EVALUATION : Execution of _matmat took at 3.820 seconds.
2023-05-07 22:46:50,413 : [3/3] EVALUATION : Execution of _predict took at 5.243 seconds.
2023-05-07 22:46:51,494 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:46:51,598 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:46:55,380 : [3/3] EVALUATION : Execution of _matmat took at 3.782 seconds.
2023-05-07 22:46:56,745 : [3/3] EVALUATION : Execution of _predict took at 5.197 seconds.
2023-05-07 22:46:57,840 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:46:57,943 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:47:01,814 : [3/3] EVALUATION : Execution of _matmat took at 3.871 seconds.
2023-05-07 22:47:03,168 : [3/3] EVALUATION : Execution of _predict took at 5.274 seconds.
2023-05-07 22:47:04,262 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:47:04,365 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:47:08,129 : [3/3] EVALUATION : Execution of _matmat took at 3.764 seconds.
2023-05-07 22:47:09,465 : [3/3] EVALUATION : Execution of _predict took at 5.148 seconds.
2023-05-07 22:47:10,550 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:47:10,655 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:47:14,445 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:47:15,810 : [3/3] EVALUATION : Execution of _predict took at 5.204 seconds.
2023-05-07 22:47:16,901 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:47:17,002 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:47:20,831 : [3/3] EVALUATION : Execution of _matmat took at 3.828 seconds.
2023-05-07 22:47:22,154 : [3/3] EVALUATION : Execution of _predict took at 5.200 seconds.
2023-05-07 22:47:23,247 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:47:23,349 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:47:27,238 : [3/3] EVALUATION : Execution of _matmat took at 3.889 seconds.
2023-05-07 22:47:28,564 : [3/3] EVALUATION : Execution of _predict took at 5.262 seconds.
2023-05-07 22:47:29,648 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:47:29,753 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:47:33,541 : [3/3] EVALUATION : Execution of _matmat took at 3.788 seconds.
2023-05-07 22:47:34,953 : [3/3] EVALUATION : Execution of _predict took at 5.250 seconds.
2023-05-07 22:47:36,048 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:47:36,152 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:47:39,983 : [3/3] EVALUATION : Execution of _matmat took at 3.830 seconds.
2023-05-07 22:47:41,363 : [3/3] EVALUATION : Execution of _predict took at 5.260 seconds.
2023-05-07 22:47:42,452 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:47:42,554 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:47:46,369 : [3/3] EVALUATION : Execution of _matmat took at 3.814 seconds.
2023-05-07 22:47:47,711 : [3/3] EVALUATION : Execution of _predict took at 5.205 seconds.
2023-05-07 22:47:48,802 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:47:48,905 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:47:52,652 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-07 22:47:53,981 : [3/3] EVALUATION : Execution of _predict took at 5.124 seconds.
2023-05-07 22:47:55,061 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:47:55,163 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:47:58,922 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 22:48:00,287 : [3/3] EVALUATION : Execution of _predict took at 5.173 seconds.
2023-05-07 22:48:01,371 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:48:01,474 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:48:05,234 : [3/3] EVALUATION : Execution of _matmat took at 3.760 seconds.
2023-05-07 22:48:06,631 : [3/3] EVALUATION : Execution of _predict took at 5.205 seconds.
2023-05-07 22:48:07,731 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:48:07,835 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:48:11,578 : [3/3] EVALUATION : Execution of _matmat took at 3.743 seconds.
2023-05-07 22:48:12,954 : [3/3] EVALUATION : Execution of _predict took at 5.168 seconds.
2023-05-07 22:48:14,034 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:48:14,136 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:48:17,896 : [3/3] EVALUATION : Execution of _matmat took at 3.760 seconds.
2023-05-07 22:48:19,250 : [3/3] EVALUATION : Execution of _predict took at 5.162 seconds.
2023-05-07 22:48:20,333 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:48:20,434 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:48:24,298 : [3/3] EVALUATION : Execution of _matmat took at 3.864 seconds.
2023-05-07 22:48:25,622 : [3/3] EVALUATION : Execution of _predict took at 5.235 seconds.
2023-05-07 22:48:26,688 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:48:26,792 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:48:30,705 : [3/3] EVALUATION : Execution of _matmat took at 3.912 seconds.
2023-05-07 22:48:32,085 : [3/3] EVALUATION : Execution of _predict took at 5.343 seconds.
2023-05-07 22:48:33,181 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:48:33,282 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:48:37,041 : [3/3] EVALUATION : Execution of _matmat took at 3.759 seconds.
2023-05-07 22:48:38,391 : [3/3] EVALUATION : Execution of _predict took at 5.157 seconds.
2023-05-07 22:48:39,483 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:48:39,585 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:48:43,318 : [3/3] EVALUATION : Execution of _matmat took at 3.733 seconds.
2023-05-07 22:48:44,656 : [3/3] EVALUATION : Execution of _predict took at 5.119 seconds.
2023-05-07 22:48:45,738 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:48:45,840 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:48:49,594 : [3/3] EVALUATION : Execution of _matmat took at 3.754 seconds.
2023-05-07 22:48:50,927 : [3/3] EVALUATION : Execution of _predict took at 5.136 seconds.
2023-05-07 22:48:52,007 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:48:52,109 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:48:55,905 : [3/3] EVALUATION : Execution of _matmat took at 3.795 seconds.
2023-05-07 22:48:57,302 : [3/3] EVALUATION : Execution of _predict took at 5.241 seconds.
2023-05-07 22:48:58,623 : [3/3] EVALUATION : Execution of _evaluate_model took at 158.844 seconds.
2023-05-07 22:48:58,624 : PIPELINE END : Execution of run took at 374.396 seconds.
d=0.01, ns=2, nf=10


2023-05-07 22:48:58,658 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:48:58,659 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:48:59,851 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.193 seconds.
2023-05-07 22:49:00,185 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:49:00,642 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:49:00,655 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.996 seconds.
2023-05-07 22:49:00,655 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:49:00,655 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:49:00,655 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:49:00,655 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:49:02,757 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:49:02,757 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:50:51,616 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:50:51,616 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:51:00,713 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:51:00,713 : [2/3] TRAINING : Execution of ldlt took at 117.956 seconds.
2023-05-07 22:51:00,713 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:51:00,713 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:51:00,713 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:51:00,858 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:51:04,928 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:51:04,928 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:51:10,768 : [2/3] TRAINING : Execution of _umr_scan took at 5.840 seconds.
2023-05-07 22:51:14,784 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:51:14,784 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 22:52:01,840 : [2/3] TRAINING : Execution of _umr_scan took at 47.057 seconds.
2023-05-07 22:52:05,920 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 22:52:05,920 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:52:08,309 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.388 seconds.
2023-05-07 22:52:12,392 : [2/3] TRAINING : Current maximum residual: 0.87434340, relative Frobenius norm squared: 0.00759962
2023-05-07 22:52:12,392 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:52:14,310 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.918 seconds.
2023-05-07 22:52:18,337 : [2/3] TRAINING : Current maximum residual: 0.80812791, relative Frobenius norm squared: 0.00716703
2023-05-07 22:52:18,337 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:52:19,970 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.633 seconds.
2023-05-07 22:52:24,030 : [2/3] TRAINING : Current maximum residual: 0.49528971, relative Frobenius norm squared: 0.00679284
2023-05-07 22:52:24,031 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:52:25,695 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.665 seconds.
2023-05-07 22:52:29,785 : [2/3] TRAINING : Current maximum residual: 0.23269910, relative Frobenius norm squared: 0.00651196
2023-05-07 22:52:29,785 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:52:31,386 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.601 seconds.
2023-05-07 22:52:35,455 : [2/3] TRAINING : Current maximum residual: 0.22601967, relative Frobenius norm squared: 0.00624679
2023-05-07 22:52:35,455 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 22:52:37,081 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.626 seconds.
2023-05-07 22:52:41,184 : [2/3] TRAINING : Current maximum residual: 0.22295762, relative Frobenius norm squared: 0.00600102
2023-05-07 22:52:41,184 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 22:52:42,757 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.572 seconds.
2023-05-07 22:52:46,805 : [2/3] TRAINING : Current maximum residual: 0.22153696, relative Frobenius norm squared: 0.00577352
2023-05-07 22:52:46,805 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 22:52:48,604 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.799 seconds.
2023-05-07 22:52:52,730 : [2/3] TRAINING : Current maximum residual: 0.22100874, relative Frobenius norm squared: 0.00557418
2023-05-07 22:52:52,730 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 22:52:54,319 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.589 seconds.
2023-05-07 22:52:58,376 : [2/3] TRAINING : Current maximum residual: 0.22069143, relative Frobenius norm squared: 0.00538766
2023-05-07 22:52:58,376 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 22:53:00,173 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.797 seconds.
2023-05-07 22:53:04,255 : [2/3] TRAINING : Current maximum residual: 0.22056444, relative Frobenius norm squared: 0.00522094
2023-05-07 22:53:04,593 : [2/3] TRAINING : Execution of ainv_L took at 123.880 seconds.
2023-05-07 22:53:04,594 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 22:53:04,594 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 22:53:04,798 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 22:53:04,950 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 22:53:05,836 : [2/3] TRAINING : Execution of _construct_weights took at 243.078 seconds.
2023-05-07 22:53:05,837 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 22:53:05,837 : [2/3] TRAINING : Execution of _get_model took at 245.182 seconds.
2023-05-07 22:53:05,837 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 22:53:05,943 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:53:09,797 : [3/3] EVALUATION : Execution of _matmat took at 3.854 seconds.
2023-05-07 22:53:11,146 : [3/3] EVALUATION : Execution of _predict took at 5.252 seconds.
2023-05-07 22:53:12,259 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 22:53:12,362 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:53:16,104 : [3/3] EVALUATION : Execution of _matmat took at 3.741 seconds.
2023-05-07 22:53:17,421 : [3/3] EVALUATION : Execution of _predict took at 5.107 seconds.
2023-05-07 22:53:18,517 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 22:53:18,622 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:53:22,410 : [3/3] EVALUATION : Execution of _matmat took at 3.787 seconds.
2023-05-07 22:53:23,809 : [3/3] EVALUATION : Execution of _predict took at 5.236 seconds.
2023-05-07 22:53:24,909 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 22:53:25,012 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:53:28,802 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:53:30,184 : [3/3] EVALUATION : Execution of _predict took at 5.220 seconds.
2023-05-07 22:53:31,278 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 22:53:31,382 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:53:35,216 : [3/3] EVALUATION : Execution of _matmat took at 3.834 seconds.
2023-05-07 22:53:36,588 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 22:53:37,683 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 22:53:37,787 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:53:41,577 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 22:53:42,942 : [3/3] EVALUATION : Execution of _predict took at 5.204 seconds.
2023-05-07 22:53:44,045 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 22:53:44,149 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:53:48,022 : [3/3] EVALUATION : Execution of _matmat took at 3.873 seconds.
2023-05-07 22:53:49,377 : [3/3] EVALUATION : Execution of _predict took at 5.277 seconds.
2023-05-07 22:53:50,481 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 22:53:50,583 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:53:54,353 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 22:53:55,689 : [3/3] EVALUATION : Execution of _predict took at 5.154 seconds.
2023-05-07 22:53:56,789 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 22:53:56,894 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:54:00,721 : [3/3] EVALUATION : Execution of _matmat took at 3.828 seconds.
2023-05-07 22:54:02,087 : [3/3] EVALUATION : Execution of _predict took at 5.242 seconds.
2023-05-07 22:54:03,185 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 22:54:03,287 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:54:07,114 : [3/3] EVALUATION : Execution of _matmat took at 3.827 seconds.
2023-05-07 22:54:08,437 : [3/3] EVALUATION : Execution of _predict took at 5.198 seconds.
2023-05-07 22:54:09,536 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 22:54:09,638 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 22:54:13,525 : [3/3] EVALUATION : Execution of _matmat took at 3.887 seconds.
2023-05-07 22:54:14,852 : [3/3] EVALUATION : Execution of _predict took at 5.261 seconds.
2023-05-07 22:54:15,951 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 22:54:16,056 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:54:19,868 : [3/3] EVALUATION : Execution of _matmat took at 3.812 seconds.
2023-05-07 22:54:21,280 : [3/3] EVALUATION : Execution of _predict took at 5.274 seconds.
2023-05-07 22:54:22,384 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 22:54:22,489 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:54:26,334 : [3/3] EVALUATION : Execution of _matmat took at 3.845 seconds.
2023-05-07 22:54:27,715 : [3/3] EVALUATION : Execution of _predict took at 5.276 seconds.
2023-05-07 22:54:28,819 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 22:54:28,922 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:54:32,738 : [3/3] EVALUATION : Execution of _matmat took at 3.816 seconds.
2023-05-07 22:54:34,080 : [3/3] EVALUATION : Execution of _predict took at 5.206 seconds.
2023-05-07 22:54:35,179 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 22:54:35,282 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:54:39,041 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 22:54:40,370 : [3/3] EVALUATION : Execution of _predict took at 5.135 seconds.
2023-05-07 22:54:41,458 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 22:54:41,560 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:54:45,319 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 22:54:46,683 : [3/3] EVALUATION : Execution of _predict took at 5.172 seconds.
2023-05-07 22:54:47,782 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 22:54:47,886 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:54:51,637 : [3/3] EVALUATION : Execution of _matmat took at 3.751 seconds.
2023-05-07 22:54:53,032 : [3/3] EVALUATION : Execution of _predict took at 5.195 seconds.
2023-05-07 22:54:54,148 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 22:54:54,252 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:54:58,024 : [3/3] EVALUATION : Execution of _matmat took at 3.772 seconds.
2023-05-07 22:54:59,399 : [3/3] EVALUATION : Execution of _predict took at 5.196 seconds.
2023-05-07 22:55:00,493 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 22:55:00,595 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:55:04,353 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 22:55:05,704 : [3/3] EVALUATION : Execution of _predict took at 5.157 seconds.
2023-05-07 22:55:06,806 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 22:55:06,909 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:55:10,773 : [3/3] EVALUATION : Execution of _matmat took at 3.864 seconds.
2023-05-07 22:55:12,098 : [3/3] EVALUATION : Execution of _predict took at 5.237 seconds.
2023-05-07 22:55:13,179 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 22:55:13,284 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 22:55:17,213 : [3/3] EVALUATION : Execution of _matmat took at 3.929 seconds.
2023-05-07 22:55:18,593 : [3/3] EVALUATION : Execution of _predict took at 5.359 seconds.
2023-05-07 22:55:19,701 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 22:55:19,803 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:55:23,569 : [3/3] EVALUATION : Execution of _matmat took at 3.766 seconds.
2023-05-07 22:55:24,919 : [3/3] EVALUATION : Execution of _predict took at 5.165 seconds.
2023-05-07 22:55:26,020 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 22:55:26,123 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:55:29,883 : [3/3] EVALUATION : Execution of _matmat took at 3.760 seconds.
2023-05-07 22:55:31,223 : [3/3] EVALUATION : Execution of _predict took at 5.148 seconds.
2023-05-07 22:55:32,316 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 22:55:32,418 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 22:55:36,194 : [3/3] EVALUATION : Execution of _matmat took at 3.776 seconds.
2023-05-07 22:55:37,529 : [3/3] EVALUATION : Execution of _predict took at 5.159 seconds.
2023-05-07 22:55:38,621 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 22:55:38,724 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 22:55:42,519 : [3/3] EVALUATION : Execution of _matmat took at 3.794 seconds.
2023-05-07 22:55:43,914 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 22:55:45,232 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.395 seconds.
2023-05-07 22:55:45,233 : PIPELINE END : Execution of run took at 406.574 seconds.
d=0.01, ns=2, nf=20


2023-05-07 22:55:45,267 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 22:55:45,267 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 22:55:46,443 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.176 seconds.
2023-05-07 22:55:46,767 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 22:55:47,219 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 22:55:47,231 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.964 seconds.
2023-05-07 22:55:47,232 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 22:55:47,232 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 22:55:47,232 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 22:55:47,232 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 22:55:49,236 : [2/3] TRAINING : Constructing weights:
2023-05-07 22:55:49,236 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 22:57:35,964 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 22:57:35,964 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 22:57:44,964 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 22:57:44,964 : [2/3] TRAINING : Execution of ldlt took at 115.728 seconds.
2023-05-07 22:57:44,964 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 22:57:44,964 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 22:57:44,964 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 22:57:45,106 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 22:57:49,096 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 22:57:49,096 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 22:57:54,882 : [2/3] TRAINING : Execution of _umr_scan took at 5.786 seconds.
2023-05-07 22:57:58,827 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 22:57:58,828 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 22:58:45,486 : [2/3] TRAINING : Execution of _umr_scan took at 46.658 seconds.
2023-05-07 22:58:49,485 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 22:58:49,485 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 22:58:51,907 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.422 seconds.
2023-05-07 22:58:55,897 : [2/3] TRAINING : Current maximum residual: 0.87434340, relative Frobenius norm squared: 0.00759962
2023-05-07 22:58:55,898 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 22:58:57,802 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.904 seconds.
2023-05-07 22:59:01,757 : [2/3] TRAINING : Current maximum residual: 0.80812791, relative Frobenius norm squared: 0.00716703
2023-05-07 22:59:01,757 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 22:59:03,410 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.653 seconds.
2023-05-07 22:59:07,402 : [2/3] TRAINING : Current maximum residual: 0.49528971, relative Frobenius norm squared: 0.00679284
2023-05-07 22:59:07,402 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 22:59:09,035 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.633 seconds.
2023-05-07 22:59:13,024 : [2/3] TRAINING : Current maximum residual: 0.23269910, relative Frobenius norm squared: 0.00651196
2023-05-07 22:59:13,025 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 22:59:14,581 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.557 seconds.
2023-05-07 22:59:18,523 : [2/3] TRAINING : Current maximum residual: 0.22601967, relative Frobenius norm squared: 0.00624679
2023-05-07 22:59:18,523 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 22:59:20,127 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.603 seconds.
2023-05-07 22:59:24,098 : [2/3] TRAINING : Current maximum residual: 0.22295762, relative Frobenius norm squared: 0.00600102
2023-05-07 22:59:24,098 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 22:59:25,642 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.544 seconds.
2023-05-07 22:59:29,576 : [2/3] TRAINING : Current maximum residual: 0.22153696, relative Frobenius norm squared: 0.00577352
2023-05-07 22:59:29,576 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 22:59:31,331 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.755 seconds.
2023-05-07 22:59:35,323 : [2/3] TRAINING : Current maximum residual: 0.22100874, relative Frobenius norm squared: 0.00557418
2023-05-07 22:59:35,324 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 22:59:36,887 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.563 seconds.
2023-05-07 22:59:40,839 : [2/3] TRAINING : Current maximum residual: 0.22069143, relative Frobenius norm squared: 0.00538766
2023-05-07 22:59:40,839 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 22:59:42,590 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.750 seconds.
2023-05-07 22:59:46,528 : [2/3] TRAINING : Current maximum residual: 0.22056444, relative Frobenius norm squared: 0.00522094
2023-05-07 22:59:46,528 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 22:59:48,306 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.778 seconds.
2023-05-07 22:59:52,283 : [2/3] TRAINING : Current maximum residual: 0.22051222, relative Frobenius norm squared: 0.00506149
2023-05-07 22:59:52,283 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 22:59:54,084 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.801 seconds.
2023-05-07 22:59:58,016 : [2/3] TRAINING : Current maximum residual: 0.22047417, relative Frobenius norm squared: 0.00491863
2023-05-07 22:59:58,016 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 22:59:59,794 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.778 seconds.
2023-05-07 23:00:03,748 : [2/3] TRAINING : Current maximum residual: 0.22044201, relative Frobenius norm squared: 0.00479619
2023-05-07 23:00:03,748 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 23:00:05,546 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.798 seconds.
2023-05-07 23:00:09,483 : [2/3] TRAINING : Current maximum residual: 0.22043154, relative Frobenius norm squared: 0.00468712
2023-05-07 23:00:09,483 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 23:00:11,400 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.916 seconds.
2023-05-07 23:00:15,378 : [2/3] TRAINING : Current maximum residual: 0.22041124, relative Frobenius norm squared: 0.00458426
2023-05-07 23:00:15,378 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 23:00:17,295 : [2/3] TRAINING : Execution of _umr_finetune_step took at 1.917 seconds.
2023-05-07 23:00:21,210 : [2/3] TRAINING : Current maximum residual: 0.22040255, relative Frobenius norm squared: 0.00449791
2023-05-07 23:00:21,210 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 23:00:23,324 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.114 seconds.
2023-05-07 23:00:27,305 : [2/3] TRAINING : Current maximum residual: 0.22039789, relative Frobenius norm squared: 0.00441800
2023-05-07 23:00:27,305 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 23:00:29,448 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.143 seconds.
2023-05-07 23:00:33,395 : [2/3] TRAINING : Current maximum residual: 0.22039549, relative Frobenius norm squared: 0.00435134
2023-05-07 23:00:33,395 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 23:00:35,546 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.151 seconds.
2023-05-07 23:00:39,460 : [2/3] TRAINING : Current maximum residual: 0.22039435, relative Frobenius norm squared: 0.00428322
2023-05-07 23:00:39,461 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 23:00:41,625 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.165 seconds.
2023-05-07 23:00:45,540 : [2/3] TRAINING : Current maximum residual: 0.22039388, relative Frobenius norm squared: 0.00422824
2023-05-07 23:00:45,873 : [2/3] TRAINING : Execution of ainv_L took at 180.909 seconds.
2023-05-07 23:00:45,873 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:00:45,873 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:00:46,071 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:00:46,218 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:00:47,072 : [2/3] TRAINING : Execution of _construct_weights took at 297.836 seconds.
2023-05-07 23:00:47,073 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:00:47,073 : [2/3] TRAINING : Execution of _get_model took at 299.842 seconds.
2023-05-07 23:00:47,073 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:00:47,178 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:00:51,005 : [3/3] EVALUATION : Execution of _matmat took at 3.828 seconds.
2023-05-07 23:00:52,353 : [3/3] EVALUATION : Execution of _predict took at 5.224 seconds.
2023-05-07 23:00:53,466 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:00:53,566 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:00:57,313 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-07 23:00:58,630 : [3/3] EVALUATION : Execution of _predict took at 5.110 seconds.
2023-05-07 23:00:59,733 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:00:59,837 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:01:03,623 : [3/3] EVALUATION : Execution of _matmat took at 3.786 seconds.
2023-05-07 23:01:05,020 : [3/3] EVALUATION : Execution of _predict took at 5.232 seconds.
2023-05-07 23:01:06,123 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:01:06,226 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:01:10,006 : [3/3] EVALUATION : Execution of _matmat took at 3.780 seconds.
2023-05-07 23:01:11,384 : [3/3] EVALUATION : Execution of _predict took at 5.206 seconds.
2023-05-07 23:01:12,487 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:01:12,589 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:01:16,392 : [3/3] EVALUATION : Execution of _matmat took at 3.803 seconds.
2023-05-07 23:01:17,764 : [3/3] EVALUATION : Execution of _predict took at 5.222 seconds.
2023-05-07 23:01:18,859 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 23:01:18,962 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:01:22,717 : [3/3] EVALUATION : Execution of _matmat took at 3.755 seconds.
2023-05-07 23:01:24,082 : [3/3] EVALUATION : Execution of _predict took at 5.168 seconds.
2023-05-07 23:01:25,191 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 23:01:25,293 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:01:29,159 : [3/3] EVALUATION : Execution of _matmat took at 3.866 seconds.
2023-05-07 23:01:30,514 : [3/3] EVALUATION : Execution of _predict took at 5.268 seconds.
2023-05-07 23:01:31,616 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 23:01:31,718 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:01:35,488 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 23:01:36,822 : [3/3] EVALUATION : Execution of _predict took at 5.152 seconds.
2023-05-07 23:01:37,921 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 23:01:38,024 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:01:41,836 : [3/3] EVALUATION : Execution of _matmat took at 3.812 seconds.
2023-05-07 23:01:43,203 : [3/3] EVALUATION : Execution of _predict took at 5.227 seconds.
2023-05-07 23:01:44,304 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 23:01:44,404 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:01:48,236 : [3/3] EVALUATION : Execution of _matmat took at 3.831 seconds.
2023-05-07 23:01:49,557 : [3/3] EVALUATION : Execution of _predict took at 5.200 seconds.
2023-05-07 23:01:50,658 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 23:01:50,759 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:01:54,626 : [3/3] EVALUATION : Execution of _matmat took at 3.867 seconds.
2023-05-07 23:01:55,951 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 23:01:57,055 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 23:01:57,158 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:02:00,964 : [3/3] EVALUATION : Execution of _matmat took at 3.806 seconds.
2023-05-07 23:02:02,376 : [3/3] EVALUATION : Execution of _predict took at 5.267 seconds.
2023-05-07 23:02:03,477 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 23:02:03,580 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:02:07,418 : [3/3] EVALUATION : Execution of _matmat took at 3.837 seconds.
2023-05-07 23:02:08,797 : [3/3] EVALUATION : Execution of _predict took at 5.266 seconds.
2023-05-07 23:02:09,905 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 23:02:10,007 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:02:13,851 : [3/3] EVALUATION : Execution of _matmat took at 3.843 seconds.
2023-05-07 23:02:15,193 : [3/3] EVALUATION : Execution of _predict took at 5.233 seconds.
2023-05-07 23:02:16,295 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 23:02:16,398 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:02:20,143 : [3/3] EVALUATION : Execution of _matmat took at 3.745 seconds.
2023-05-07 23:02:21,471 : [3/3] EVALUATION : Execution of _predict took at 5.121 seconds.
2023-05-07 23:02:22,567 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 23:02:22,668 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:02:26,425 : [3/3] EVALUATION : Execution of _matmat took at 3.757 seconds.
2023-05-07 23:02:27,790 : [3/3] EVALUATION : Execution of _predict took at 5.169 seconds.
2023-05-07 23:02:28,900 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 23:02:29,003 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:02:32,753 : [3/3] EVALUATION : Execution of _matmat took at 3.750 seconds.
2023-05-07 23:02:34,148 : [3/3] EVALUATION : Execution of _predict took at 5.193 seconds.
2023-05-07 23:02:35,267 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 23:02:35,369 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:02:39,093 : [3/3] EVALUATION : Execution of _matmat took at 3.723 seconds.
2023-05-07 23:02:40,467 : [3/3] EVALUATION : Execution of _predict took at 5.146 seconds.
2023-05-07 23:02:41,562 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 23:02:41,663 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:02:45,408 : [3/3] EVALUATION : Execution of _matmat took at 3.745 seconds.
2023-05-07 23:02:46,760 : [3/3] EVALUATION : Execution of _predict took at 5.143 seconds.
2023-05-07 23:02:47,860 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 23:02:47,960 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:02:51,830 : [3/3] EVALUATION : Execution of _matmat took at 3.869 seconds.
2023-05-07 23:02:53,155 : [3/3] EVALUATION : Execution of _predict took at 5.242 seconds.
2023-05-07 23:02:54,245 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 23:02:54,349 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:02:58,270 : [3/3] EVALUATION : Execution of _matmat took at 3.921 seconds.
2023-05-07 23:02:59,651 : [3/3] EVALUATION : Execution of _predict took at 5.351 seconds.
2023-05-07 23:03:00,758 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 23:03:00,859 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:03:04,624 : [3/3] EVALUATION : Execution of _matmat took at 3.765 seconds.
2023-05-07 23:03:05,973 : [3/3] EVALUATION : Execution of _predict took at 5.162 seconds.
2023-05-07 23:03:07,079 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 23:03:07,182 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:03:10,951 : [3/3] EVALUATION : Execution of _matmat took at 3.769 seconds.
2023-05-07 23:03:12,290 : [3/3] EVALUATION : Execution of _predict took at 5.156 seconds.
2023-05-07 23:03:13,386 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 23:03:13,487 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:03:17,259 : [3/3] EVALUATION : Execution of _matmat took at 3.772 seconds.
2023-05-07 23:03:18,594 : [3/3] EVALUATION : Execution of _predict took at 5.154 seconds.
2023-05-07 23:03:19,687 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 23:03:19,791 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:03:23,599 : [3/3] EVALUATION : Execution of _matmat took at 3.808 seconds.
2023-05-07 23:03:24,996 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 23:03:26,334 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.261 seconds.
2023-05-07 23:03:26,335 : PIPELINE END : Execution of run took at 461.068 seconds.
d=0.01, ns=3, nf=0


2023-05-07 23:03:26,370 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 23:03:26,370 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 23:03:27,574 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.204 seconds.
2023-05-07 23:03:27,915 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 23:03:28,377 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 23:03:28,390 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.020 seconds.
2023-05-07 23:03:28,390 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 23:03:28,390 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 23:03:28,390 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 23:03:28,390 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 23:03:30,525 : [2/3] TRAINING : Constructing weights:
2023-05-07 23:03:30,525 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 23:05:21,481 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 23:05:21,481 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 23:05:30,638 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 23:05:30,638 : [2/3] TRAINING : Execution of ldlt took at 120.113 seconds.
2023-05-07 23:05:30,638 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 23:05:30,638 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 23:05:30,638 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 23:05:30,787 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 23:05:34,910 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 23:05:34,910 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 23:05:40,773 : [2/3] TRAINING : Execution of _umr_scan took at 5.863 seconds.
2023-05-07 23:05:44,894 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 23:05:44,894 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 23:06:32,070 : [2/3] TRAINING : Execution of _umr_scan took at 47.176 seconds.
2023-05-07 23:06:36,192 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 23:06:36,192 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 23:07:46,344 : [2/3] TRAINING : Execution of _umr_scan took at 70.151 seconds.
2023-05-07 23:07:50,436 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-07 23:07:50,767 : [2/3] TRAINING : Execution of ainv_L took at 140.129 seconds.
2023-05-07 23:07:50,768 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:07:50,768 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:07:50,969 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:07:51,119 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:07:51,979 : [2/3] TRAINING : Execution of _construct_weights took at 261.454 seconds.
2023-05-07 23:07:51,980 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:07:51,981 : [2/3] TRAINING : Execution of _get_model took at 263.590 seconds.
2023-05-07 23:07:51,981 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:07:52,086 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:07:55,918 : [3/3] EVALUATION : Execution of _matmat took at 3.832 seconds.
2023-05-07 23:07:57,264 : [3/3] EVALUATION : Execution of _predict took at 5.228 seconds.
2023-05-07 23:07:58,384 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:07:58,486 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:08:02,252 : [3/3] EVALUATION : Execution of _matmat took at 3.766 seconds.
2023-05-07 23:08:03,569 : [3/3] EVALUATION : Execution of _predict took at 5.130 seconds.
2023-05-07 23:08:04,679 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:08:04,785 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:08:08,582 : [3/3] EVALUATION : Execution of _matmat took at 3.796 seconds.
2023-05-07 23:08:09,979 : [3/3] EVALUATION : Execution of _predict took at 5.244 seconds.
2023-05-07 23:08:11,090 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:08:11,194 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:08:15,005 : [3/3] EVALUATION : Execution of _matmat took at 3.811 seconds.
2023-05-07 23:08:16,384 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 23:08:17,490 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:08:17,594 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:08:21,434 : [3/3] EVALUATION : Execution of _matmat took at 3.840 seconds.
2023-05-07 23:08:22,807 : [3/3] EVALUATION : Execution of _predict took at 5.262 seconds.
2023-05-07 23:08:23,912 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 23:08:24,015 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:08:27,806 : [3/3] EVALUATION : Execution of _matmat took at 3.791 seconds.
2023-05-07 23:08:29,155 : [3/3] EVALUATION : Execution of _predict took at 5.189 seconds.
2023-05-07 23:08:30,270 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 23:08:30,373 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:08:34,247 : [3/3] EVALUATION : Execution of _matmat took at 3.875 seconds.
2023-05-07 23:08:35,601 : [3/3] EVALUATION : Execution of _predict took at 5.276 seconds.
2023-05-07 23:08:36,709 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 23:08:36,811 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:08:40,581 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 23:08:41,916 : [3/3] EVALUATION : Execution of _predict took at 5.153 seconds.
2023-05-07 23:08:43,026 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 23:08:43,131 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:08:46,924 : [3/3] EVALUATION : Execution of _matmat took at 3.793 seconds.
2023-05-07 23:08:48,290 : [3/3] EVALUATION : Execution of _predict took at 5.208 seconds.
2023-05-07 23:08:49,403 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 23:08:49,504 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:08:53,348 : [3/3] EVALUATION : Execution of _matmat took at 3.843 seconds.
2023-05-07 23:08:54,669 : [3/3] EVALUATION : Execution of _predict took at 5.212 seconds.
2023-05-07 23:08:55,782 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 23:08:55,884 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:08:59,773 : [3/3] EVALUATION : Execution of _matmat took at 3.889 seconds.
2023-05-07 23:09:01,098 : [3/3] EVALUATION : Execution of _predict took at 5.261 seconds.
2023-05-07 23:09:02,204 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 23:09:02,308 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:09:06,116 : [3/3] EVALUATION : Execution of _matmat took at 3.807 seconds.
2023-05-07 23:09:07,528 : [3/3] EVALUATION : Execution of _predict took at 5.270 seconds.
2023-05-07 23:09:08,637 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 23:09:08,741 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:09:12,610 : [3/3] EVALUATION : Execution of _matmat took at 3.868 seconds.
2023-05-07 23:09:13,989 : [3/3] EVALUATION : Execution of _predict took at 5.297 seconds.
2023-05-07 23:09:15,105 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 23:09:15,208 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:09:19,057 : [3/3] EVALUATION : Execution of _matmat took at 3.849 seconds.
2023-05-07 23:09:20,398 : [3/3] EVALUATION : Execution of _predict took at 5.240 seconds.
2023-05-07 23:09:21,501 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 23:09:21,604 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:09:25,371 : [3/3] EVALUATION : Execution of _matmat took at 3.767 seconds.
2023-05-07 23:09:26,698 : [3/3] EVALUATION : Execution of _predict took at 5.142 seconds.
2023-05-07 23:09:27,806 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 23:09:27,908 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:09:31,678 : [3/3] EVALUATION : Execution of _matmat took at 3.769 seconds.
2023-05-07 23:09:33,042 : [3/3] EVALUATION : Execution of _predict took at 5.183 seconds.
2023-05-07 23:09:34,159 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 23:09:34,263 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:09:38,017 : [3/3] EVALUATION : Execution of _matmat took at 3.755 seconds.
2023-05-07 23:09:39,414 : [3/3] EVALUATION : Execution of _predict took at 5.200 seconds.
2023-05-07 23:09:40,539 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 23:09:40,642 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:09:44,383 : [3/3] EVALUATION : Execution of _matmat took at 3.741 seconds.
2023-05-07 23:09:45,759 : [3/3] EVALUATION : Execution of _predict took at 5.165 seconds.
2023-05-07 23:09:46,863 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 23:09:46,964 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:09:50,722 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 23:09:52,074 : [3/3] EVALUATION : Execution of _predict took at 5.157 seconds.
2023-05-07 23:09:53,189 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 23:09:53,290 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:09:57,173 : [3/3] EVALUATION : Execution of _matmat took at 3.883 seconds.
2023-05-07 23:09:58,497 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 23:09:59,597 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 23:09:59,701 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:10:03,653 : [3/3] EVALUATION : Execution of _matmat took at 3.952 seconds.
2023-05-07 23:10:05,034 : [3/3] EVALUATION : Execution of _predict took at 5.383 seconds.
2023-05-07 23:10:06,155 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 23:10:06,256 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:10:10,051 : [3/3] EVALUATION : Execution of _matmat took at 3.795 seconds.
2023-05-07 23:10:11,400 : [3/3] EVALUATION : Execution of _predict took at 5.192 seconds.
2023-05-07 23:10:12,513 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 23:10:12,616 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:10:16,375 : [3/3] EVALUATION : Execution of _matmat took at 3.759 seconds.
2023-05-07 23:10:17,715 : [3/3] EVALUATION : Execution of _predict took at 5.148 seconds.
2023-05-07 23:10:18,825 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 23:10:18,926 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:10:22,677 : [3/3] EVALUATION : Execution of _matmat took at 3.751 seconds.
2023-05-07 23:10:24,012 : [3/3] EVALUATION : Execution of _predict took at 5.134 seconds.
2023-05-07 23:10:25,118 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 23:10:25,221 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:10:29,018 : [3/3] EVALUATION : Execution of _matmat took at 3.797 seconds.
2023-05-07 23:10:30,414 : [3/3] EVALUATION : Execution of _predict took at 5.242 seconds.
2023-05-07 23:10:31,752 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.771 seconds.
2023-05-07 23:10:31,753 : PIPELINE END : Execution of run took at 425.383 seconds.
d=0.01, ns=3, nf=5


2023-05-07 23:10:31,787 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 23:10:31,788 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 23:10:32,981 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.194 seconds.
2023-05-07 23:10:33,317 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 23:10:33,775 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 23:10:33,788 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.001 seconds.
2023-05-07 23:10:33,788 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 23:10:33,789 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 23:10:33,789 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 23:10:33,789 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 23:10:35,843 : [2/3] TRAINING : Constructing weights:
2023-05-07 23:10:35,843 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 23:12:25,232 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 23:12:25,232 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 23:12:34,329 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 23:12:34,329 : [2/3] TRAINING : Execution of ldlt took at 118.486 seconds.
2023-05-07 23:12:34,329 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 23:12:34,329 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 23:12:34,329 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 23:12:34,475 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 23:12:38,545 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 23:12:38,545 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 23:12:44,382 : [2/3] TRAINING : Execution of _umr_scan took at 5.837 seconds.
2023-05-07 23:12:48,426 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 23:12:48,426 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 23:13:35,548 : [2/3] TRAINING : Execution of _umr_scan took at 47.122 seconds.
2023-05-07 23:13:39,645 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 23:13:39,645 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 23:14:49,634 : [2/3] TRAINING : Execution of _umr_scan took at 69.989 seconds.
2023-05-07 23:14:53,724 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-07 23:14:53,724 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 23:14:56,197 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.473 seconds.
2023-05-07 23:15:00,226 : [2/3] TRAINING : Current maximum residual: 0.80722366, relative Frobenius norm squared: 0.00265230
2023-05-07 23:15:00,226 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 23:15:02,763 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.537 seconds.
2023-05-07 23:15:06,820 : [2/3] TRAINING : Current maximum residual: 0.49424694, relative Frobenius norm squared: 0.00244010
2023-05-07 23:15:06,820 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 23:15:09,355 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.535 seconds.
2023-05-07 23:15:13,428 : [2/3] TRAINING : Current maximum residual: 0.23232097, relative Frobenius norm squared: 0.00235748
2023-05-07 23:15:13,429 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 23:15:15,870 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.441 seconds.
2023-05-07 23:15:19,913 : [2/3] TRAINING : Current maximum residual: 0.22511409, relative Frobenius norm squared: 0.00231221
2023-05-07 23:15:19,914 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 23:15:22,373 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.460 seconds.
2023-05-07 23:15:26,473 : [2/3] TRAINING : Current maximum residual: 0.22186089, relative Frobenius norm squared: 0.00228086
2023-05-07 23:15:26,815 : [2/3] TRAINING : Execution of ainv_L took at 172.485 seconds.
2023-05-07 23:15:26,815 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:15:26,815 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:15:27,017 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:15:27,169 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:15:28,033 : [2/3] TRAINING : Execution of _construct_weights took at 292.189 seconds.
2023-05-07 23:15:28,034 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:15:28,034 : [2/3] TRAINING : Execution of _get_model took at 294.245 seconds.
2023-05-07 23:15:28,034 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:15:28,139 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:15:31,948 : [3/3] EVALUATION : Execution of _matmat took at 3.808 seconds.
2023-05-07 23:15:33,295 : [3/3] EVALUATION : Execution of _predict took at 5.205 seconds.
2023-05-07 23:15:34,416 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:15:34,518 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:15:38,259 : [3/3] EVALUATION : Execution of _matmat took at 3.741 seconds.
2023-05-07 23:15:39,577 : [3/3] EVALUATION : Execution of _predict took at 5.106 seconds.
2023-05-07 23:15:40,678 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:15:40,783 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:15:44,549 : [3/3] EVALUATION : Execution of _matmat took at 3.765 seconds.
2023-05-07 23:15:45,947 : [3/3] EVALUATION : Execution of _predict took at 5.213 seconds.
2023-05-07 23:15:47,058 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:15:47,161 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:15:50,927 : [3/3] EVALUATION : Execution of _matmat took at 3.766 seconds.
2023-05-07 23:15:52,307 : [3/3] EVALUATION : Execution of _predict took at 5.194 seconds.
2023-05-07 23:15:53,412 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:15:53,515 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:15:57,336 : [3/3] EVALUATION : Execution of _matmat took at 3.821 seconds.
2023-05-07 23:15:58,710 : [3/3] EVALUATION : Execution of _predict took at 5.244 seconds.
2023-05-07 23:15:59,816 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 23:15:59,919 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:16:03,678 : [3/3] EVALUATION : Execution of _matmat took at 3.759 seconds.
2023-05-07 23:16:05,042 : [3/3] EVALUATION : Execution of _predict took at 5.171 seconds.
2023-05-07 23:16:06,149 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 23:16:06,252 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:16:10,068 : [3/3] EVALUATION : Execution of _matmat took at 3.816 seconds.
2023-05-07 23:16:11,422 : [3/3] EVALUATION : Execution of _predict took at 5.218 seconds.
2023-05-07 23:16:12,531 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 23:16:12,634 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:16:16,374 : [3/3] EVALUATION : Execution of _matmat took at 3.740 seconds.
2023-05-07 23:16:17,709 : [3/3] EVALUATION : Execution of _predict took at 5.123 seconds.
2023-05-07 23:16:18,816 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 23:16:18,921 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:16:22,676 : [3/3] EVALUATION : Execution of _matmat took at 3.755 seconds.
2023-05-07 23:16:24,041 : [3/3] EVALUATION : Execution of _predict took at 5.170 seconds.
2023-05-07 23:16:25,153 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 23:16:25,253 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:16:29,063 : [3/3] EVALUATION : Execution of _matmat took at 3.809 seconds.
2023-05-07 23:16:30,385 : [3/3] EVALUATION : Execution of _predict took at 5.179 seconds.
2023-05-07 23:16:31,493 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 23:16:31,595 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:16:35,463 : [3/3] EVALUATION : Execution of _matmat took at 3.868 seconds.
2023-05-07 23:16:36,788 : [3/3] EVALUATION : Execution of _predict took at 5.240 seconds.
2023-05-07 23:16:37,893 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 23:16:37,998 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:16:41,780 : [3/3] EVALUATION : Execution of _matmat took at 3.782 seconds.
2023-05-07 23:16:43,191 : [3/3] EVALUATION : Execution of _predict took at 5.243 seconds.
2023-05-07 23:16:44,296 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 23:16:44,402 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 23:16:48,240 : [3/3] EVALUATION : Execution of _matmat took at 3.839 seconds.
2023-05-07 23:16:49,619 : [3/3] EVALUATION : Execution of _predict took at 5.269 seconds.
2023-05-07 23:16:50,735 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 23:16:50,837 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:16:54,629 : [3/3] EVALUATION : Execution of _matmat took at 3.791 seconds.
2023-05-07 23:16:55,970 : [3/3] EVALUATION : Execution of _predict took at 5.181 seconds.
2023-05-07 23:16:57,079 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 23:16:57,182 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:17:00,916 : [3/3] EVALUATION : Execution of _matmat took at 3.734 seconds.
2023-05-07 23:17:02,243 : [3/3] EVALUATION : Execution of _predict took at 5.108 seconds.
2023-05-07 23:17:03,349 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 23:17:03,451 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:17:07,197 : [3/3] EVALUATION : Execution of _matmat took at 3.746 seconds.
2023-05-07 23:17:08,561 : [3/3] EVALUATION : Execution of _predict took at 5.159 seconds.
2023-05-07 23:17:09,673 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 23:17:09,777 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:17:13,512 : [3/3] EVALUATION : Execution of _matmat took at 3.735 seconds.
2023-05-07 23:17:14,907 : [3/3] EVALUATION : Execution of _predict took at 5.178 seconds.
2023-05-07 23:17:16,028 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 23:17:16,132 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:17:19,853 : [3/3] EVALUATION : Execution of _matmat took at 3.721 seconds.
2023-05-07 23:17:21,227 : [3/3] EVALUATION : Execution of _predict took at 5.144 seconds.
2023-05-07 23:17:22,328 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 23:17:22,431 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:17:26,184 : [3/3] EVALUATION : Execution of _matmat took at 3.753 seconds.
2023-05-07 23:17:27,536 : [3/3] EVALUATION : Execution of _predict took at 5.153 seconds.
2023-05-07 23:17:28,646 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 23:17:28,748 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:17:32,599 : [3/3] EVALUATION : Execution of _matmat took at 3.851 seconds.
2023-05-07 23:17:33,923 : [3/3] EVALUATION : Execution of _predict took at 5.224 seconds.
2023-05-07 23:17:35,018 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 23:17:35,122 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:17:39,036 : [3/3] EVALUATION : Execution of _matmat took at 3.914 seconds.
2023-05-07 23:17:40,418 : [3/3] EVALUATION : Execution of _predict took at 5.345 seconds.
2023-05-07 23:17:41,533 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 23:17:41,634 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:17:45,387 : [3/3] EVALUATION : Execution of _matmat took at 3.753 seconds.
2023-05-07 23:17:46,737 : [3/3] EVALUATION : Execution of _predict took at 5.152 seconds.
2023-05-07 23:17:47,852 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 23:17:47,955 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:17:51,719 : [3/3] EVALUATION : Execution of _matmat took at 3.764 seconds.
2023-05-07 23:17:53,057 : [3/3] EVALUATION : Execution of _predict took at 5.150 seconds.
2023-05-07 23:17:54,161 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 23:17:54,262 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:17:57,991 : [3/3] EVALUATION : Execution of _matmat took at 3.729 seconds.
2023-05-07 23:17:59,326 : [3/3] EVALUATION : Execution of _predict took at 5.111 seconds.
2023-05-07 23:18:00,423 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 23:18:00,526 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:18:04,318 : [3/3] EVALUATION : Execution of _matmat took at 3.792 seconds.
2023-05-07 23:18:05,713 : [3/3] EVALUATION : Execution of _predict took at 5.236 seconds.
2023-05-07 23:18:07,051 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.017 seconds.
2023-05-07 23:18:07,052 : PIPELINE END : Execution of run took at 455.264 seconds.
d=0.01, ns=3, nf=10


2023-05-07 23:18:07,087 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 23:18:07,087 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 23:18:08,297 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.210 seconds.
2023-05-07 23:18:08,634 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 23:18:09,096 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 23:18:09,109 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.022 seconds.
2023-05-07 23:18:09,109 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 23:18:09,109 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 23:18:09,109 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 23:18:09,109 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 23:18:11,320 : [2/3] TRAINING : Constructing weights:
2023-05-07 23:18:11,320 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 23:20:00,805 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 23:20:00,805 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 23:20:09,895 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 23:20:09,895 : [2/3] TRAINING : Execution of ldlt took at 118.575 seconds.
2023-05-07 23:20:09,895 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 23:20:09,895 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 23:20:09,896 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 23:20:10,041 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 23:20:14,117 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 23:20:14,117 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 23:20:19,960 : [2/3] TRAINING : Execution of _umr_scan took at 5.843 seconds.
2023-05-07 23:20:24,006 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 23:20:24,006 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 23:21:11,214 : [2/3] TRAINING : Execution of _umr_scan took at 47.208 seconds.
2023-05-07 23:21:15,263 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 23:21:15,263 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 23:22:24,828 : [2/3] TRAINING : Execution of _umr_scan took at 69.565 seconds.
2023-05-07 23:22:28,884 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-07 23:22:28,884 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 23:22:31,371 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.487 seconds.
2023-05-07 23:22:35,353 : [2/3] TRAINING : Current maximum residual: 0.80722366, relative Frobenius norm squared: 0.00265230
2023-05-07 23:22:35,353 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 23:22:37,870 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.517 seconds.
2023-05-07 23:22:41,886 : [2/3] TRAINING : Current maximum residual: 0.49424694, relative Frobenius norm squared: 0.00244010
2023-05-07 23:22:41,887 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 23:22:44,430 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.544 seconds.
2023-05-07 23:22:48,464 : [2/3] TRAINING : Current maximum residual: 0.23232097, relative Frobenius norm squared: 0.00235748
2023-05-07 23:22:48,465 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 23:22:50,897 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.433 seconds.
2023-05-07 23:22:54,889 : [2/3] TRAINING : Current maximum residual: 0.22511409, relative Frobenius norm squared: 0.00231221
2023-05-07 23:22:54,889 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 23:22:57,359 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.470 seconds.
2023-05-07 23:23:01,410 : [2/3] TRAINING : Current maximum residual: 0.22186089, relative Frobenius norm squared: 0.00228086
2023-05-07 23:23:01,410 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 23:23:04,066 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.656 seconds.
2023-05-07 23:23:08,159 : [2/3] TRAINING : Current maximum residual: 0.22000785, relative Frobenius norm squared: 0.00226088
2023-05-07 23:23:08,159 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 23:23:10,656 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.497 seconds.
2023-05-07 23:23:14,762 : [2/3] TRAINING : Current maximum residual: 0.21908110, relative Frobenius norm squared: 0.00224509
2023-05-07 23:23:14,762 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 23:23:17,310 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.548 seconds.
2023-05-07 23:23:21,374 : [2/3] TRAINING : Current maximum residual: 0.21860898, relative Frobenius norm squared: 0.00223247
2023-05-07 23:23:21,374 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 23:23:24,015 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.641 seconds.
2023-05-07 23:23:28,016 : [2/3] TRAINING : Current maximum residual: 0.21833020, relative Frobenius norm squared: 0.00222187
2023-05-07 23:23:28,016 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 23:23:30,584 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.568 seconds.
2023-05-07 23:23:34,577 : [2/3] TRAINING : Current maximum residual: 0.21817548, relative Frobenius norm squared: 0.00221468
2023-05-07 23:23:34,911 : [2/3] TRAINING : Execution of ainv_L took at 205.016 seconds.
2023-05-07 23:23:34,912 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:23:34,912 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:23:35,112 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:23:35,261 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:23:36,118 : [2/3] TRAINING : Execution of _construct_weights took at 324.798 seconds.
2023-05-07 23:23:36,119 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:23:36,119 : [2/3] TRAINING : Execution of _get_model took at 327.010 seconds.
2023-05-07 23:23:36,119 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:23:36,224 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:23:40,054 : [3/3] EVALUATION : Execution of _matmat took at 3.830 seconds.
2023-05-07 23:23:41,403 : [3/3] EVALUATION : Execution of _predict took at 5.227 seconds.
2023-05-07 23:23:42,522 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:23:42,623 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:23:46,387 : [3/3] EVALUATION : Execution of _matmat took at 3.763 seconds.
2023-05-07 23:23:47,704 : [3/3] EVALUATION : Execution of _predict took at 5.127 seconds.
2023-05-07 23:23:48,803 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:23:48,908 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:23:52,701 : [3/3] EVALUATION : Execution of _matmat took at 3.793 seconds.
2023-05-07 23:23:54,098 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 23:23:55,205 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:23:55,308 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:23:59,098 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 23:24:00,477 : [3/3] EVALUATION : Execution of _predict took at 5.218 seconds.
2023-05-07 23:24:01,585 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:24:01,688 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:24:05,527 : [3/3] EVALUATION : Execution of _matmat took at 3.839 seconds.
2023-05-07 23:24:06,899 : [3/3] EVALUATION : Execution of _predict took at 5.259 seconds.
2023-05-07 23:24:08,006 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 23:24:08,109 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:24:11,910 : [3/3] EVALUATION : Execution of _matmat took at 3.800 seconds.
2023-05-07 23:24:13,273 : [3/3] EVALUATION : Execution of _predict took at 5.212 seconds.
2023-05-07 23:24:14,381 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 23:24:14,485 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:24:18,322 : [3/3] EVALUATION : Execution of _matmat took at 3.837 seconds.
2023-05-07 23:24:19,676 : [3/3] EVALUATION : Execution of _predict took at 5.240 seconds.
2023-05-07 23:24:20,787 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 23:24:20,888 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:24:24,658 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 23:24:25,994 : [3/3] EVALUATION : Execution of _predict took at 5.153 seconds.
2023-05-07 23:24:27,105 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 23:24:27,209 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:24:31,052 : [3/3] EVALUATION : Execution of _matmat took at 3.844 seconds.
2023-05-07 23:24:32,417 : [3/3] EVALUATION : Execution of _predict took at 5.257 seconds.
2023-05-07 23:24:33,526 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 23:24:33,626 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:24:37,466 : [3/3] EVALUATION : Execution of _matmat took at 3.839 seconds.
2023-05-07 23:24:38,788 : [3/3] EVALUATION : Execution of _predict took at 5.209 seconds.
2023-05-07 23:24:39,892 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 23:24:39,997 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 23:24:43,893 : [3/3] EVALUATION : Execution of _matmat took at 3.896 seconds.
2023-05-07 23:24:45,218 : [3/3] EVALUATION : Execution of _predict took at 5.272 seconds.
2023-05-07 23:24:46,326 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 23:24:46,429 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:24:50,237 : [3/3] EVALUATION : Execution of _matmat took at 3.808 seconds.
2023-05-07 23:24:51,650 : [3/3] EVALUATION : Execution of _predict took at 5.270 seconds.
2023-05-07 23:24:52,754 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 23:24:52,857 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:24:56,700 : [3/3] EVALUATION : Execution of _matmat took at 3.843 seconds.
2023-05-07 23:24:58,080 : [3/3] EVALUATION : Execution of _predict took at 5.272 seconds.
2023-05-07 23:24:59,194 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 23:24:59,296 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:25:03,127 : [3/3] EVALUATION : Execution of _matmat took at 3.830 seconds.
2023-05-07 23:25:04,469 : [3/3] EVALUATION : Execution of _predict took at 5.221 seconds.
2023-05-07 23:25:05,576 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 23:25:05,679 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:25:09,450 : [3/3] EVALUATION : Execution of _matmat took at 3.771 seconds.
2023-05-07 23:25:10,778 : [3/3] EVALUATION : Execution of _predict took at 5.146 seconds.
2023-05-07 23:25:11,880 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 23:25:11,982 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:25:15,759 : [3/3] EVALUATION : Execution of _matmat took at 3.777 seconds.
2023-05-07 23:25:17,123 : [3/3] EVALUATION : Execution of _predict took at 5.189 seconds.
2023-05-07 23:25:18,234 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 23:25:18,338 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:25:22,095 : [3/3] EVALUATION : Execution of _matmat took at 3.757 seconds.
2023-05-07 23:25:23,491 : [3/3] EVALUATION : Execution of _predict took at 5.202 seconds.
2023-05-07 23:25:24,615 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 23:25:24,717 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:25:28,459 : [3/3] EVALUATION : Execution of _matmat took at 3.742 seconds.
2023-05-07 23:25:29,834 : [3/3] EVALUATION : Execution of _predict took at 5.165 seconds.
2023-05-07 23:25:30,939 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 23:25:31,040 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:25:34,856 : [3/3] EVALUATION : Execution of _matmat took at 3.816 seconds.
2023-05-07 23:25:36,207 : [3/3] EVALUATION : Execution of _predict took at 5.214 seconds.
2023-05-07 23:25:37,313 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 23:25:37,413 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:25:41,297 : [3/3] EVALUATION : Execution of _matmat took at 3.883 seconds.
2023-05-07 23:25:42,621 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 23:25:43,714 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 23:25:43,819 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:25:47,797 : [3/3] EVALUATION : Execution of _matmat took at 3.978 seconds.
2023-05-07 23:25:49,180 : [3/3] EVALUATION : Execution of _predict took at 5.411 seconds.
2023-05-07 23:25:50,292 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 23:25:50,393 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:25:54,178 : [3/3] EVALUATION : Execution of _matmat took at 3.785 seconds.
2023-05-07 23:25:55,527 : [3/3] EVALUATION : Execution of _predict took at 5.182 seconds.
2023-05-07 23:25:56,635 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 23:25:56,737 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:26:00,490 : [3/3] EVALUATION : Execution of _matmat took at 3.752 seconds.
2023-05-07 23:26:01,828 : [3/3] EVALUATION : Execution of _predict took at 5.139 seconds.
2023-05-07 23:26:02,932 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 23:26:03,033 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:26:06,792 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 23:26:08,126 : [3/3] EVALUATION : Execution of _predict took at 5.140 seconds.
2023-05-07 23:26:09,223 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 23:26:09,326 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:26:13,136 : [3/3] EVALUATION : Execution of _matmat took at 3.811 seconds.
2023-05-07 23:26:14,531 : [3/3] EVALUATION : Execution of _predict took at 5.254 seconds.
2023-05-07 23:26:15,866 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.747 seconds.
2023-05-07 23:26:15,867 : PIPELINE END : Execution of run took at 488.780 seconds.
d=0.01, ns=3, nf=20


2023-05-07 23:26:15,902 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 23:26:15,902 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 23:26:17,086 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.184 seconds.
2023-05-07 23:26:17,418 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 23:26:17,875 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 23:26:17,887 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.986 seconds.
2023-05-07 23:26:17,888 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 23:26:17,888 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 23:26:17,888 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 23:26:17,888 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 23:26:19,975 : [2/3] TRAINING : Constructing weights:
2023-05-07 23:26:19,975 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 23:28:08,337 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 23:28:08,337 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 23:28:17,427 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 23:28:17,427 : [2/3] TRAINING : Execution of ldlt took at 117.452 seconds.
2023-05-07 23:28:17,428 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 23:28:17,428 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 23:28:17,428 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 23:28:17,571 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 23:28:21,588 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 23:28:21,588 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 23:28:27,434 : [2/3] TRAINING : Execution of _umr_scan took at 5.846 seconds.
2023-05-07 23:28:31,505 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 23:28:31,505 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 23:29:18,763 : [2/3] TRAINING : Execution of _umr_scan took at 47.258 seconds.
2023-05-07 23:29:22,886 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 23:29:22,886 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 23:30:33,391 : [2/3] TRAINING : Execution of _umr_scan took at 70.505 seconds.
2023-05-07 23:30:37,477 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-07 23:30:37,477 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 23:30:39,964 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.487 seconds.
2023-05-07 23:30:44,002 : [2/3] TRAINING : Current maximum residual: 0.80722366, relative Frobenius norm squared: 0.00265230
2023-05-07 23:30:44,002 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 23:30:46,585 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.583 seconds.
2023-05-07 23:30:50,643 : [2/3] TRAINING : Current maximum residual: 0.49424694, relative Frobenius norm squared: 0.00244010
2023-05-07 23:30:50,643 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 23:30:53,184 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.541 seconds.
2023-05-07 23:30:57,262 : [2/3] TRAINING : Current maximum residual: 0.23232097, relative Frobenius norm squared: 0.00235748
2023-05-07 23:30:57,262 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 23:30:59,756 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.494 seconds.
2023-05-07 23:31:03,799 : [2/3] TRAINING : Current maximum residual: 0.22511409, relative Frobenius norm squared: 0.00231221
2023-05-07 23:31:03,799 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 23:31:06,263 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.463 seconds.
2023-05-07 23:31:10,351 : [2/3] TRAINING : Current maximum residual: 0.22186089, relative Frobenius norm squared: 0.00228086
2023-05-07 23:31:10,351 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 23:31:13,069 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.718 seconds.
2023-05-07 23:31:17,142 : [2/3] TRAINING : Current maximum residual: 0.22000785, relative Frobenius norm squared: 0.00226088
2023-05-07 23:31:17,142 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 23:31:19,608 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.466 seconds.
2023-05-07 23:31:23,673 : [2/3] TRAINING : Current maximum residual: 0.21908110, relative Frobenius norm squared: 0.00224509
2023-05-07 23:31:23,673 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 23:31:26,271 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.598 seconds.
2023-05-07 23:31:30,382 : [2/3] TRAINING : Current maximum residual: 0.21860898, relative Frobenius norm squared: 0.00223247
2023-05-07 23:31:30,382 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 23:31:33,031 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.649 seconds.
2023-05-07 23:31:37,077 : [2/3] TRAINING : Current maximum residual: 0.21833020, relative Frobenius norm squared: 0.00222187
2023-05-07 23:31:37,077 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 23:31:39,700 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.623 seconds.
2023-05-07 23:31:43,728 : [2/3] TRAINING : Current maximum residual: 0.21817548, relative Frobenius norm squared: 0.00221468
2023-05-07 23:31:43,728 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-07 23:31:46,207 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.479 seconds.
2023-05-07 23:31:50,303 : [2/3] TRAINING : Current maximum residual: 0.21809403, relative Frobenius norm squared: 0.00220956
2023-05-07 23:31:50,303 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-07 23:31:52,949 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.646 seconds.
2023-05-07 23:31:57,039 : [2/3] TRAINING : Current maximum residual: 0.21807747, relative Frobenius norm squared: 0.00220490
2023-05-07 23:31:57,039 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-07 23:31:59,608 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.569 seconds.
2023-05-07 23:32:03,713 : [2/3] TRAINING : Current maximum residual: 0.21804339, relative Frobenius norm squared: 0.00220161
2023-05-07 23:32:03,714 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-07 23:32:06,331 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.618 seconds.
2023-05-07 23:32:10,400 : [2/3] TRAINING : Current maximum residual: 0.21802377, relative Frobenius norm squared: 0.00219780
2023-05-07 23:32:10,401 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-07 23:32:13,088 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.687 seconds.
2023-05-07 23:32:17,146 : [2/3] TRAINING : Current maximum residual: 0.21801266, relative Frobenius norm squared: 0.00219561
2023-05-07 23:32:17,146 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-07 23:32:19,795 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.649 seconds.
2023-05-07 23:32:23,871 : [2/3] TRAINING : Current maximum residual: 0.21802366, relative Frobenius norm squared: 0.00219357
2023-05-07 23:32:23,872 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-07 23:32:26,498 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.626 seconds.
2023-05-07 23:32:30,550 : [2/3] TRAINING : Current maximum residual: 0.21802052, relative Frobenius norm squared: 0.00219237
2023-05-07 23:32:30,550 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-07 23:32:33,240 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.691 seconds.
2023-05-07 23:32:37,334 : [2/3] TRAINING : Current maximum residual: 0.21801897, relative Frobenius norm squared: 0.00219140
2023-05-07 23:32:37,334 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-07 23:32:39,833 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.499 seconds.
2023-05-07 23:32:43,913 : [2/3] TRAINING : Current maximum residual: 0.21800552, relative Frobenius norm squared: 0.00219023
2023-05-07 23:32:43,913 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-07 23:32:46,568 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.656 seconds.
2023-05-07 23:32:50,654 : [2/3] TRAINING : Current maximum residual: 0.21800496, relative Frobenius norm squared: 0.00218961
2023-05-07 23:32:50,995 : [2/3] TRAINING : Execution of ainv_L took at 273.567 seconds.
2023-05-07 23:32:50,995 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:32:50,996 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:32:51,198 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:32:51,350 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:32:52,211 : [2/3] TRAINING : Execution of _construct_weights took at 392.236 seconds.
2023-05-07 23:32:52,212 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:32:52,212 : [2/3] TRAINING : Execution of _get_model took at 394.325 seconds.
2023-05-07 23:32:52,212 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:32:52,318 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:32:56,155 : [3/3] EVALUATION : Execution of _matmat took at 3.837 seconds.
2023-05-07 23:32:57,503 : [3/3] EVALUATION : Execution of _predict took at 5.235 seconds.
2023-05-07 23:32:58,628 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:32:58,731 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:33:02,501 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-07 23:33:03,818 : [3/3] EVALUATION : Execution of _predict took at 5.135 seconds.
2023-05-07 23:33:04,922 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:33:05,028 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:33:08,846 : [3/3] EVALUATION : Execution of _matmat took at 3.818 seconds.
2023-05-07 23:33:10,244 : [3/3] EVALUATION : Execution of _predict took at 5.265 seconds.
2023-05-07 23:33:11,357 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:33:11,461 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:33:15,284 : [3/3] EVALUATION : Execution of _matmat took at 3.823 seconds.
2023-05-07 23:33:16,663 : [3/3] EVALUATION : Execution of _predict took at 5.251 seconds.
2023-05-07 23:33:17,772 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:33:17,875 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:33:21,719 : [3/3] EVALUATION : Execution of _matmat took at 3.843 seconds.
2023-05-07 23:33:23,091 : [3/3] EVALUATION : Execution of _predict took at 5.264 seconds.
2023-05-07 23:33:24,203 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 23:33:24,307 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:33:28,097 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 23:33:29,462 : [3/3] EVALUATION : Execution of _predict took at 5.204 seconds.
2023-05-07 23:33:30,571 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 23:33:30,674 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:33:34,547 : [3/3] EVALUATION : Execution of _matmat took at 3.873 seconds.
2023-05-07 23:33:35,903 : [3/3] EVALUATION : Execution of _predict took at 5.277 seconds.
2023-05-07 23:33:37,017 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 23:33:37,119 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:33:40,897 : [3/3] EVALUATION : Execution of _matmat took at 3.778 seconds.
2023-05-07 23:33:42,233 : [3/3] EVALUATION : Execution of _predict took at 5.162 seconds.
2023-05-07 23:33:43,343 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 23:33:43,448 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:33:47,286 : [3/3] EVALUATION : Execution of _matmat took at 3.838 seconds.
2023-05-07 23:33:48,652 : [3/3] EVALUATION : Execution of _predict took at 5.254 seconds.
2023-05-07 23:33:49,765 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 23:33:49,867 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:33:53,695 : [3/3] EVALUATION : Execution of _matmat took at 3.828 seconds.
2023-05-07 23:33:55,016 : [3/3] EVALUATION : Execution of _predict took at 5.197 seconds.
2023-05-07 23:33:56,116 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 23:33:56,218 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:34:00,101 : [3/3] EVALUATION : Execution of _matmat took at 3.883 seconds.
2023-05-07 23:34:01,427 : [3/3] EVALUATION : Execution of _predict took at 5.256 seconds.
2023-05-07 23:34:02,533 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 23:34:02,637 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:34:06,454 : [3/3] EVALUATION : Execution of _matmat took at 3.817 seconds.
2023-05-07 23:34:07,865 : [3/3] EVALUATION : Execution of _predict took at 5.278 seconds.
2023-05-07 23:34:08,974 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 23:34:09,078 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:34:12,938 : [3/3] EVALUATION : Execution of _matmat took at 3.860 seconds.
2023-05-07 23:34:14,319 : [3/3] EVALUATION : Execution of _predict took at 5.290 seconds.
2023-05-07 23:34:15,432 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 23:34:15,534 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:34:19,377 : [3/3] EVALUATION : Execution of _matmat took at 3.843 seconds.
2023-05-07 23:34:20,719 : [3/3] EVALUATION : Execution of _predict took at 5.233 seconds.
2023-05-07 23:34:21,826 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 23:34:21,929 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:34:25,687 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 23:34:27,014 : [3/3] EVALUATION : Execution of _predict took at 5.133 seconds.
2023-05-07 23:34:28,119 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 23:34:28,221 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:34:32,011 : [3/3] EVALUATION : Execution of _matmat took at 3.790 seconds.
2023-05-07 23:34:33,375 : [3/3] EVALUATION : Execution of _predict took at 5.203 seconds.
2023-05-07 23:34:34,490 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 23:34:34,594 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:34:38,352 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 23:34:39,746 : [3/3] EVALUATION : Execution of _predict took at 5.201 seconds.
2023-05-07 23:34:40,874 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 23:34:40,976 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:34:44,721 : [3/3] EVALUATION : Execution of _matmat took at 3.745 seconds.
2023-05-07 23:34:46,098 : [3/3] EVALUATION : Execution of _predict took at 5.170 seconds.
2023-05-07 23:34:47,204 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 23:34:47,306 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:34:51,072 : [3/3] EVALUATION : Execution of _matmat took at 3.766 seconds.
2023-05-07 23:34:52,425 : [3/3] EVALUATION : Execution of _predict took at 5.166 seconds.
2023-05-07 23:34:53,534 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 23:34:53,635 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:34:57,517 : [3/3] EVALUATION : Execution of _matmat took at 3.882 seconds.
2023-05-07 23:34:58,842 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-07 23:34:59,936 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 23:35:00,041 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:35:03,964 : [3/3] EVALUATION : Execution of _matmat took at 3.923 seconds.
2023-05-07 23:35:05,344 : [3/3] EVALUATION : Execution of _predict took at 5.353 seconds.
2023-05-07 23:35:06,463 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 23:35:06,565 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:35:10,358 : [3/3] EVALUATION : Execution of _matmat took at 3.793 seconds.
2023-05-07 23:35:11,709 : [3/3] EVALUATION : Execution of _predict took at 5.193 seconds.
2023-05-07 23:35:12,821 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 23:35:12,924 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:35:16,697 : [3/3] EVALUATION : Execution of _matmat took at 3.773 seconds.
2023-05-07 23:35:18,036 : [3/3] EVALUATION : Execution of _predict took at 5.160 seconds.
2023-05-07 23:35:19,143 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 23:35:19,244 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:35:22,990 : [3/3] EVALUATION : Execution of _matmat took at 3.746 seconds.
2023-05-07 23:35:24,317 : [3/3] EVALUATION : Execution of _predict took at 5.120 seconds.
2023-05-07 23:35:25,417 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 23:35:25,520 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:35:29,351 : [3/3] EVALUATION : Execution of _matmat took at 3.831 seconds.
2023-05-07 23:35:30,748 : [3/3] EVALUATION : Execution of _predict took at 5.277 seconds.
2023-05-07 23:35:32,087 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.874 seconds.
2023-05-07 23:35:32,087 : PIPELINE END : Execution of run took at 556.186 seconds.
d=0.01, ns=4, nf=0


2023-05-07 23:35:32,122 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 23:35:32,122 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 23:35:33,318 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.195 seconds.
2023-05-07 23:35:33,652 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 23:35:34,111 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 23:35:34,124 : [1/3] DATASET : Execution of _create_dataset_splits took at 2.002 seconds.
2023-05-07 23:35:34,124 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 23:35:34,124 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 23:35:34,124 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 23:35:34,124 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 23:35:36,233 : [2/3] TRAINING : Constructing weights:
2023-05-07 23:35:36,233 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 23:37:25,605 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 23:37:25,605 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 23:37:34,698 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 23:37:34,698 : [2/3] TRAINING : Execution of ldlt took at 118.465 seconds.
2023-05-07 23:37:34,698 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 23:37:34,698 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 23:37:34,698 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 23:37:34,843 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 23:37:38,920 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 23:37:38,920 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 23:37:44,753 : [2/3] TRAINING : Execution of _umr_scan took at 5.833 seconds.
2023-05-07 23:37:48,794 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 23:37:48,795 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 23:38:35,994 : [2/3] TRAINING : Execution of _umr_scan took at 47.200 seconds.
2023-05-07 23:38:40,119 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 23:38:40,119 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 23:39:50,198 : [2/3] TRAINING : Execution of _umr_scan took at 70.079 seconds.
2023-05-07 23:39:54,310 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-07 23:39:54,310 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 23:41:12,065 : [2/3] TRAINING : Execution of _umr_scan took at 77.755 seconds.
2023-05-07 23:41:16,167 : [2/3] TRAINING : Current maximum residual: 0.80665452, relative Frobenius norm squared: 0.00220102
2023-05-07 23:41:16,506 : [2/3] TRAINING : Execution of ainv_L took at 221.807 seconds.
2023-05-07 23:41:16,506 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:41:16,506 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:41:16,710 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:41:16,861 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:41:17,738 : [2/3] TRAINING : Execution of _construct_weights took at 341.506 seconds.
2023-05-07 23:41:17,739 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:41:17,740 : [2/3] TRAINING : Execution of _get_model took at 343.615 seconds.
2023-05-07 23:41:17,740 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:41:17,845 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:41:21,655 : [3/3] EVALUATION : Execution of _matmat took at 3.811 seconds.
2023-05-07 23:41:23,003 : [3/3] EVALUATION : Execution of _predict took at 5.208 seconds.
2023-05-07 23:41:24,108 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:41:24,210 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:41:27,929 : [3/3] EVALUATION : Execution of _matmat took at 3.718 seconds.
2023-05-07 23:41:29,247 : [3/3] EVALUATION : Execution of _predict took at 5.084 seconds.
2023-05-07 23:41:30,347 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:41:30,452 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-07 23:41:34,205 : [3/3] EVALUATION : Execution of _matmat took at 3.753 seconds.
2023-05-07 23:41:35,603 : [3/3] EVALUATION : Execution of _predict took at 5.201 seconds.
2023-05-07 23:41:36,702 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:41:36,807 : [3/3] EVALUATION : Execution of _matmat took at 0.051 seconds.
2023-05-07 23:41:40,577 : [3/3] EVALUATION : Execution of _matmat took at 3.769 seconds.
2023-05-07 23:41:41,956 : [3/3] EVALUATION : Execution of _predict took at 5.200 seconds.
2023-05-07 23:41:43,048 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:41:43,151 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:41:46,963 : [3/3] EVALUATION : Execution of _matmat took at 3.812 seconds.
2023-05-07 23:41:48,336 : [3/3] EVALUATION : Execution of _predict took at 5.232 seconds.
2023-05-07 23:41:49,431 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 23:41:49,534 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:41:53,272 : [3/3] EVALUATION : Execution of _matmat took at 3.739 seconds.
2023-05-07 23:41:54,637 : [3/3] EVALUATION : Execution of _predict took at 5.151 seconds.
2023-05-07 23:41:55,738 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 23:41:55,839 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:41:59,652 : [3/3] EVALUATION : Execution of _matmat took at 3.812 seconds.
2023-05-07 23:42:01,007 : [3/3] EVALUATION : Execution of _predict took at 5.215 seconds.
2023-05-07 23:42:02,106 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 23:42:02,207 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:42:05,957 : [3/3] EVALUATION : Execution of _matmat took at 3.750 seconds.
2023-05-07 23:42:07,294 : [3/3] EVALUATION : Execution of _predict took at 5.134 seconds.
2023-05-07 23:42:08,392 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 23:42:08,494 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:42:12,253 : [3/3] EVALUATION : Execution of _matmat took at 3.758 seconds.
2023-05-07 23:42:13,619 : [3/3] EVALUATION : Execution of _predict took at 5.172 seconds.
2023-05-07 23:42:14,718 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 23:42:14,818 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:42:18,583 : [3/3] EVALUATION : Execution of _matmat took at 3.764 seconds.
2023-05-07 23:42:19,905 : [3/3] EVALUATION : Execution of _predict took at 5.133 seconds.
2023-05-07 23:42:21,003 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 23:42:21,104 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:42:24,970 : [3/3] EVALUATION : Execution of _matmat took at 3.866 seconds.
2023-05-07 23:42:26,297 : [3/3] EVALUATION : Execution of _predict took at 5.239 seconds.
2023-05-07 23:42:27,387 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 23:42:27,490 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:42:31,275 : [3/3] EVALUATION : Execution of _matmat took at 3.785 seconds.
2023-05-07 23:42:32,688 : [3/3] EVALUATION : Execution of _predict took at 5.246 seconds.
2023-05-07 23:42:33,783 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 23:42:33,887 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:42:37,731 : [3/3] EVALUATION : Execution of _matmat took at 3.844 seconds.
2023-05-07 23:42:39,112 : [3/3] EVALUATION : Execution of _predict took at 5.273 seconds.
2023-05-07 23:42:40,214 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 23:42:40,315 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:42:44,117 : [3/3] EVALUATION : Execution of _matmat took at 3.801 seconds.
2023-05-07 23:42:45,458 : [3/3] EVALUATION : Execution of _predict took at 5.189 seconds.
2023-05-07 23:42:46,552 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 23:42:46,653 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:42:50,385 : [3/3] EVALUATION : Execution of _matmat took at 3.732 seconds.
2023-05-07 23:42:51,712 : [3/3] EVALUATION : Execution of _predict took at 5.105 seconds.
2023-05-07 23:42:52,806 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 23:42:52,907 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:42:56,629 : [3/3] EVALUATION : Execution of _matmat took at 3.721 seconds.
2023-05-07 23:42:57,994 : [3/3] EVALUATION : Execution of _predict took at 5.135 seconds.
2023-05-07 23:42:59,094 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 23:42:59,196 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:43:02,910 : [3/3] EVALUATION : Execution of _matmat took at 3.714 seconds.
2023-05-07 23:43:04,306 : [3/3] EVALUATION : Execution of _predict took at 5.158 seconds.
2023-05-07 23:43:05,416 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 23:43:05,518 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:43:09,253 : [3/3] EVALUATION : Execution of _matmat took at 3.735 seconds.
2023-05-07 23:43:10,629 : [3/3] EVALUATION : Execution of _predict took at 5.159 seconds.
2023-05-07 23:43:11,725 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 23:43:11,826 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:43:15,611 : [3/3] EVALUATION : Execution of _matmat took at 3.784 seconds.
2023-05-07 23:43:16,964 : [3/3] EVALUATION : Execution of _predict took at 5.184 seconds.
2023-05-07 23:43:18,062 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 23:43:18,161 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:43:22,011 : [3/3] EVALUATION : Execution of _matmat took at 3.849 seconds.
2023-05-07 23:43:23,335 : [3/3] EVALUATION : Execution of _predict took at 5.220 seconds.
2023-05-07 23:43:24,418 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 23:43:24,521 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:43:28,434 : [3/3] EVALUATION : Execution of _matmat took at 3.913 seconds.
2023-05-07 23:43:29,815 : [3/3] EVALUATION : Execution of _predict took at 5.343 seconds.
2023-05-07 23:43:30,916 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 23:43:31,015 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:43:34,771 : [3/3] EVALUATION : Execution of _matmat took at 3.756 seconds.
2023-05-07 23:43:36,123 : [3/3] EVALUATION : Execution of _predict took at 5.154 seconds.
2023-05-07 23:43:37,220 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 23:43:37,321 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:43:41,047 : [3/3] EVALUATION : Execution of _matmat took at 3.726 seconds.
2023-05-07 23:43:42,385 : [3/3] EVALUATION : Execution of _predict took at 5.111 seconds.
2023-05-07 23:43:43,480 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 23:43:43,579 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:43:47,325 : [3/3] EVALUATION : Execution of _matmat took at 3.746 seconds.
2023-05-07 23:43:48,660 : [3/3] EVALUATION : Execution of _predict took at 5.127 seconds.
2023-05-07 23:43:49,749 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 23:43:49,850 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:43:53,638 : [3/3] EVALUATION : Execution of _matmat took at 3.787 seconds.
2023-05-07 23:43:55,034 : [3/3] EVALUATION : Execution of _predict took at 5.232 seconds.
2023-05-07 23:43:56,354 : [3/3] EVALUATION : Execution of _evaluate_model took at 158.615 seconds.
2023-05-07 23:43:56,355 : PIPELINE END : Execution of run took at 504.233 seconds.
d=0.01, ns=4, nf=5


2023-05-07 23:43:56,389 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 23:43:56,389 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 23:43:57,562 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.173 seconds.
2023-05-07 23:43:57,884 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 23:43:58,335 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 23:43:58,348 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.959 seconds.
2023-05-07 23:43:58,348 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 23:43:58,348 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 23:43:58,348 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 23:43:58,348 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 23:44:00,479 : [2/3] TRAINING : Constructing weights:
2023-05-07 23:44:00,479 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 23:45:46,934 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 23:45:46,934 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 23:45:55,915 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 23:45:55,915 : [2/3] TRAINING : Execution of ldlt took at 115.436 seconds.
2023-05-07 23:45:55,915 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 23:45:55,915 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 23:45:55,915 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 23:45:56,056 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 23:46:00,022 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 23:46:00,022 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 23:46:05,792 : [2/3] TRAINING : Execution of _umr_scan took at 5.769 seconds.
2023-05-07 23:46:09,723 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 23:46:09,723 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 23:46:56,260 : [2/3] TRAINING : Execution of _umr_scan took at 46.537 seconds.
2023-05-07 23:47:00,235 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 23:47:00,235 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 23:48:09,396 : [2/3] TRAINING : Execution of _umr_scan took at 69.161 seconds.
2023-05-07 23:48:13,433 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-07 23:48:13,433 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 23:49:30,036 : [2/3] TRAINING : Execution of _umr_scan took at 76.603 seconds.
2023-05-07 23:49:33,998 : [2/3] TRAINING : Current maximum residual: 0.80665452, relative Frobenius norm squared: 0.00220102
2023-05-07 23:49:33,999 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 23:49:36,621 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.623 seconds.
2023-05-07 23:49:40,549 : [2/3] TRAINING : Current maximum residual: 0.49260438, relative Frobenius norm squared: 0.00201571
2023-05-07 23:49:40,549 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 23:49:43,035 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.486 seconds.
2023-05-07 23:49:47,012 : [2/3] TRAINING : Current maximum residual: 0.23168503, relative Frobenius norm squared: 0.00196345
2023-05-07 23:49:47,012 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 23:49:49,546 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.534 seconds.
2023-05-07 23:49:53,494 : [2/3] TRAINING : Current maximum residual: 0.22421199, relative Frobenius norm squared: 0.00194274
2023-05-07 23:49:53,494 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 23:49:56,071 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.577 seconds.
2023-05-07 23:50:00,007 : [2/3] TRAINING : Current maximum residual: 0.22063923, relative Frobenius norm squared: 0.00193020
2023-05-07 23:50:00,007 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 23:50:02,666 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.659 seconds.
2023-05-07 23:50:06,613 : [2/3] TRAINING : Current maximum residual: 0.21868928, relative Frobenius norm squared: 0.00192349
2023-05-07 23:50:06,945 : [2/3] TRAINING : Execution of ainv_L took at 251.030 seconds.
2023-05-07 23:50:06,946 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:50:06,946 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:50:07,144 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:50:07,291 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:50:08,136 : [2/3] TRAINING : Execution of _construct_weights took at 367.657 seconds.
2023-05-07 23:50:08,138 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:50:08,138 : [2/3] TRAINING : Execution of _get_model took at 369.789 seconds.
2023-05-07 23:50:08,138 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:50:08,241 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:50:12,051 : [3/3] EVALUATION : Execution of _matmat took at 3.809 seconds.
2023-05-07 23:50:13,399 : [3/3] EVALUATION : Execution of _predict took at 5.205 seconds.
2023-05-07 23:50:14,519 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:50:14,619 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:50:18,367 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-07 23:50:19,685 : [3/3] EVALUATION : Execution of _predict took at 5.111 seconds.
2023-05-07 23:50:20,785 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:50:20,889 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:50:24,651 : [3/3] EVALUATION : Execution of _matmat took at 3.762 seconds.
2023-05-07 23:50:26,048 : [3/3] EVALUATION : Execution of _predict took at 5.207 seconds.
2023-05-07 23:50:27,155 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:50:27,257 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:50:31,048 : [3/3] EVALUATION : Execution of _matmat took at 3.791 seconds.
2023-05-07 23:50:32,426 : [3/3] EVALUATION : Execution of _predict took at 5.216 seconds.
2023-05-07 23:50:33,528 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:50:33,630 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:50:37,452 : [3/3] EVALUATION : Execution of _matmat took at 3.822 seconds.
2023-05-07 23:50:38,824 : [3/3] EVALUATION : Execution of _predict took at 5.241 seconds.
2023-05-07 23:50:39,930 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-07 23:50:40,032 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:50:43,773 : [3/3] EVALUATION : Execution of _matmat took at 3.742 seconds.
2023-05-07 23:50:45,138 : [3/3] EVALUATION : Execution of _predict took at 5.154 seconds.
2023-05-07 23:50:46,243 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-07 23:50:46,344 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:50:50,161 : [3/3] EVALUATION : Execution of _matmat took at 3.816 seconds.
2023-05-07 23:50:51,515 : [3/3] EVALUATION : Execution of _predict took at 5.218 seconds.
2023-05-07 23:50:52,622 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-07 23:50:52,722 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:50:56,484 : [3/3] EVALUATION : Execution of _matmat took at 3.762 seconds.
2023-05-07 23:50:57,821 : [3/3] EVALUATION : Execution of _predict took at 5.145 seconds.
2023-05-07 23:50:58,932 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-07 23:50:59,035 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:51:02,824 : [3/3] EVALUATION : Execution of _matmat took at 3.789 seconds.
2023-05-07 23:51:04,189 : [3/3] EVALUATION : Execution of _predict took at 5.202 seconds.
2023-05-07 23:51:05,304 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-07 23:51:05,404 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:51:09,176 : [3/3] EVALUATION : Execution of _matmat took at 3.771 seconds.
2023-05-07 23:51:10,499 : [3/3] EVALUATION : Execution of _predict took at 5.141 seconds.
2023-05-07 23:51:11,603 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-07 23:51:11,703 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:51:15,569 : [3/3] EVALUATION : Execution of _matmat took at 3.866 seconds.
2023-05-07 23:51:16,894 : [3/3] EVALUATION : Execution of _predict took at 5.237 seconds.
2023-05-07 23:51:17,998 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-07 23:51:18,101 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:51:21,883 : [3/3] EVALUATION : Execution of _matmat took at 3.782 seconds.
2023-05-07 23:51:23,295 : [3/3] EVALUATION : Execution of _predict took at 5.242 seconds.
2023-05-07 23:51:24,403 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-07 23:51:24,506 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:51:28,343 : [3/3] EVALUATION : Execution of _matmat took at 3.837 seconds.
2023-05-07 23:51:29,722 : [3/3] EVALUATION : Execution of _predict took at 5.265 seconds.
2023-05-07 23:51:30,840 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-07 23:51:30,942 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:51:34,749 : [3/3] EVALUATION : Execution of _matmat took at 3.807 seconds.
2023-05-07 23:51:36,091 : [3/3] EVALUATION : Execution of _predict took at 5.197 seconds.
2023-05-07 23:51:37,192 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-07 23:51:37,294 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:51:41,059 : [3/3] EVALUATION : Execution of _matmat took at 3.765 seconds.
2023-05-07 23:51:42,387 : [3/3] EVALUATION : Execution of _predict took at 5.140 seconds.
2023-05-07 23:51:43,494 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-07 23:51:43,595 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:51:47,324 : [3/3] EVALUATION : Execution of _matmat took at 3.729 seconds.
2023-05-07 23:51:48,690 : [3/3] EVALUATION : Execution of _predict took at 5.143 seconds.
2023-05-07 23:51:49,797 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-07 23:51:49,900 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:51:53,641 : [3/3] EVALUATION : Execution of _matmat took at 3.741 seconds.
2023-05-07 23:51:55,037 : [3/3] EVALUATION : Execution of _predict took at 5.185 seconds.
2023-05-07 23:51:56,155 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-07 23:51:56,256 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:51:59,988 : [3/3] EVALUATION : Execution of _matmat took at 3.732 seconds.
2023-05-07 23:52:01,363 : [3/3] EVALUATION : Execution of _predict took at 5.153 seconds.
2023-05-07 23:52:02,468 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-07 23:52:02,569 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:52:06,332 : [3/3] EVALUATION : Execution of _matmat took at 3.763 seconds.
2023-05-07 23:52:07,684 : [3/3] EVALUATION : Execution of _predict took at 5.161 seconds.
2023-05-07 23:52:08,789 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-07 23:52:08,889 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:52:12,743 : [3/3] EVALUATION : Execution of _matmat took at 3.853 seconds.
2023-05-07 23:52:14,067 : [3/3] EVALUATION : Execution of _predict took at 5.224 seconds.
2023-05-07 23:52:15,163 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-07 23:52:15,266 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-07 23:52:19,194 : [3/3] EVALUATION : Execution of _matmat took at 3.928 seconds.
2023-05-07 23:52:20,574 : [3/3] EVALUATION : Execution of _predict took at 5.357 seconds.
2023-05-07 23:52:21,690 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-07 23:52:21,789 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:52:25,550 : [3/3] EVALUATION : Execution of _matmat took at 3.760 seconds.
2023-05-07 23:52:26,900 : [3/3] EVALUATION : Execution of _predict took at 5.157 seconds.
2023-05-07 23:52:28,009 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-07 23:52:28,111 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:52:31,844 : [3/3] EVALUATION : Execution of _matmat took at 3.733 seconds.
2023-05-07 23:52:33,183 : [3/3] EVALUATION : Execution of _predict took at 5.120 seconds.
2023-05-07 23:52:34,291 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-07 23:52:34,391 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:52:38,124 : [3/3] EVALUATION : Execution of _matmat took at 3.733 seconds.
2023-05-07 23:52:39,458 : [3/3] EVALUATION : Execution of _predict took at 5.113 seconds.
2023-05-07 23:52:40,560 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-07 23:52:40,661 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:52:44,453 : [3/3] EVALUATION : Execution of _matmat took at 3.792 seconds.
2023-05-07 23:52:45,848 : [3/3] EVALUATION : Execution of _predict took at 5.234 seconds.
2023-05-07 23:52:47,182 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.045 seconds.
2023-05-07 23:52:47,183 : PIPELINE END : Execution of run took at 530.794 seconds.
d=0.01, ns=4, nf=10


2023-05-07 23:52:47,217 : PIPELINE START : Starting evaluation pipeline.
2023-05-07 23:52:47,217 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-07 23:52:48,391 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.173 seconds.
2023-05-07 23:52:48,715 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-07 23:52:49,168 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-07 23:52:49,181 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.963 seconds.
2023-05-07 23:52:49,181 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-07 23:52:49,181 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-07 23:52:49,181 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-07 23:52:49,181 : [2/3] TRAINING : Loading item-user matrix...
2023-05-07 23:52:51,205 : [2/3] TRAINING : Constructing weights:
2023-05-07 23:52:51,205 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-07 23:54:38,248 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-07 23:54:38,248 : [2/3] TRAINING : Dropping small values from L...
2023-05-07 23:54:47,223 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-07 23:54:47,223 : [2/3] TRAINING : Execution of ldlt took at 116.018 seconds.
2023-05-07 23:54:47,223 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-07 23:54:47,224 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-07 23:54:47,224 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-07 23:54:47,365 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-07 23:54:51,322 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-07 23:54:51,322 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-07 23:54:57,096 : [2/3] TRAINING : Execution of _umr_scan took at 5.774 seconds.
2023-05-07 23:55:01,027 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-07 23:55:01,027 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-07 23:55:47,616 : [2/3] TRAINING : Execution of _umr_scan took at 46.589 seconds.
2023-05-07 23:55:51,598 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-07 23:55:51,598 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-07 23:57:00,723 : [2/3] TRAINING : Execution of _umr_scan took at 69.125 seconds.
2023-05-07 23:57:04,713 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-07 23:57:04,713 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-07 23:58:21,480 : [2/3] TRAINING : Execution of _umr_scan took at 76.768 seconds.
2023-05-07 23:58:25,434 : [2/3] TRAINING : Current maximum residual: 0.80665452, relative Frobenius norm squared: 0.00220102
2023-05-07 23:58:25,434 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-07 23:58:28,059 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.625 seconds.
2023-05-07 23:58:31,983 : [2/3] TRAINING : Current maximum residual: 0.49260438, relative Frobenius norm squared: 0.00201571
2023-05-07 23:58:31,983 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-07 23:58:34,468 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.485 seconds.
2023-05-07 23:58:38,445 : [2/3] TRAINING : Current maximum residual: 0.23168503, relative Frobenius norm squared: 0.00196345
2023-05-07 23:58:38,445 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-07 23:58:40,983 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.538 seconds.
2023-05-07 23:58:44,943 : [2/3] TRAINING : Current maximum residual: 0.22421199, relative Frobenius norm squared: 0.00194274
2023-05-07 23:58:44,943 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-07 23:58:47,510 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.566 seconds.
2023-05-07 23:58:51,433 : [2/3] TRAINING : Current maximum residual: 0.22063923, relative Frobenius norm squared: 0.00193020
2023-05-07 23:58:51,433 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-07 23:58:54,086 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.653 seconds.
2023-05-07 23:58:58,013 : [2/3] TRAINING : Current maximum residual: 0.21868928, relative Frobenius norm squared: 0.00192349
2023-05-07 23:58:58,013 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-07 23:59:00,638 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.625 seconds.
2023-05-07 23:59:04,567 : [2/3] TRAINING : Current maximum residual: 0.21775071, relative Frobenius norm squared: 0.00191898
2023-05-07 23:59:04,567 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-07 23:59:07,082 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.514 seconds.
2023-05-07 23:59:11,030 : [2/3] TRAINING : Current maximum residual: 0.21715000, relative Frobenius norm squared: 0.00191602
2023-05-07 23:59:11,030 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-07 23:59:13,562 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.532 seconds.
2023-05-07 23:59:17,530 : [2/3] TRAINING : Current maximum residual: 0.21684158, relative Frobenius norm squared: 0.00191386
2023-05-07 23:59:17,530 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-07 23:59:20,079 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.549 seconds.
2023-05-07 23:59:24,036 : [2/3] TRAINING : Current maximum residual: 0.21665836, relative Frobenius norm squared: 0.00191226
2023-05-07 23:59:24,036 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-07 23:59:26,598 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.562 seconds.
2023-05-07 23:59:30,529 : [2/3] TRAINING : Current maximum residual: 0.21656038, relative Frobenius norm squared: 0.00191126
2023-05-07 23:59:30,859 : [2/3] TRAINING : Execution of ainv_L took at 283.636 seconds.
2023-05-07 23:59:30,860 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-07 23:59:30,860 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-07 23:59:31,059 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-07 23:59:31,207 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-07 23:59:32,064 : [2/3] TRAINING : Execution of _construct_weights took at 400.859 seconds.
2023-05-07 23:59:32,065 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-07 23:59:32,065 : [2/3] TRAINING : Execution of _get_model took at 402.885 seconds.
2023-05-07 23:59:32,065 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-07 23:59:32,170 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:59:35,965 : [3/3] EVALUATION : Execution of _matmat took at 3.795 seconds.
2023-05-07 23:59:37,312 : [3/3] EVALUATION : Execution of _predict took at 5.189 seconds.
2023-05-07 23:59:38,434 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-07 23:59:38,534 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-07 23:59:42,276 : [3/3] EVALUATION : Execution of _matmat took at 3.742 seconds.
2023-05-07 23:59:43,593 : [3/3] EVALUATION : Execution of _predict took at 5.105 seconds.
2023-05-07 23:59:44,695 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-07 23:59:44,799 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-07 23:59:48,545 : [3/3] EVALUATION : Execution of _matmat took at 3.746 seconds.
2023-05-07 23:59:49,943 : [3/3] EVALUATION : Execution of _predict took at 5.192 seconds.
2023-05-07 23:59:51,054 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-07 23:59:51,156 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-07 23:59:54,924 : [3/3] EVALUATION : Execution of _matmat took at 3.768 seconds.
2023-05-07 23:59:56,302 : [3/3] EVALUATION : Execution of _predict took at 5.193 seconds.
2023-05-07 23:59:57,407 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-07 23:59:57,509 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:00:01,330 : [3/3] EVALUATION : Execution of _matmat took at 3.821 seconds.
2023-05-08 00:00:02,703 : [3/3] EVALUATION : Execution of _predict took at 5.241 seconds.
2023-05-08 00:00:03,812 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-08 00:00:03,915 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:00:07,652 : [3/3] EVALUATION : Execution of _matmat took at 3.738 seconds.
2023-05-08 00:00:09,017 : [3/3] EVALUATION : Execution of _predict took at 5.149 seconds.
2023-05-08 00:00:10,123 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-08 00:00:10,224 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:00:14,034 : [3/3] EVALUATION : Execution of _matmat took at 3.810 seconds.
2023-05-08 00:00:15,388 : [3/3] EVALUATION : Execution of _predict took at 5.211 seconds.
2023-05-08 00:00:16,494 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-08 00:00:16,594 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-08 00:00:20,341 : [3/3] EVALUATION : Execution of _matmat took at 3.747 seconds.
2023-05-08 00:00:21,677 : [3/3] EVALUATION : Execution of _predict took at 5.128 seconds.
2023-05-08 00:00:22,787 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-08 00:00:22,890 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:00:26,653 : [3/3] EVALUATION : Execution of _matmat took at 3.763 seconds.
2023-05-08 00:00:28,018 : [3/3] EVALUATION : Execution of _predict took at 5.176 seconds.
2023-05-08 00:00:29,130 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-08 00:00:29,230 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:00:32,985 : [3/3] EVALUATION : Execution of _matmat took at 3.755 seconds.
2023-05-08 00:00:34,307 : [3/3] EVALUATION : Execution of _predict took at 5.123 seconds.
2023-05-08 00:00:35,412 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-08 00:00:35,513 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-08 00:00:39,376 : [3/3] EVALUATION : Execution of _matmat took at 3.863 seconds.
2023-05-08 00:00:40,701 : [3/3] EVALUATION : Execution of _predict took at 5.234 seconds.
2023-05-08 00:00:41,803 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-08 00:00:41,906 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:00:45,678 : [3/3] EVALUATION : Execution of _matmat took at 3.772 seconds.
2023-05-08 00:00:47,092 : [3/3] EVALUATION : Execution of _predict took at 5.234 seconds.
2023-05-08 00:00:48,198 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-08 00:00:48,301 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:00:52,128 : [3/3] EVALUATION : Execution of _matmat took at 3.827 seconds.
2023-05-08 00:00:53,507 : [3/3] EVALUATION : Execution of _predict took at 5.255 seconds.
2023-05-08 00:00:54,628 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-08 00:00:54,729 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:00:58,522 : [3/3] EVALUATION : Execution of _matmat took at 3.793 seconds.
2023-05-08 00:00:59,863 : [3/3] EVALUATION : Execution of _predict took at 5.182 seconds.
2023-05-08 00:01:00,970 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-08 00:01:01,071 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:01:04,808 : [3/3] EVALUATION : Execution of _matmat took at 3.737 seconds.
2023-05-08 00:01:06,137 : [3/3] EVALUATION : Execution of _predict took at 5.112 seconds.
2023-05-08 00:01:07,243 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-08 00:01:07,344 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:01:11,058 : [3/3] EVALUATION : Execution of _matmat took at 3.714 seconds.
2023-05-08 00:01:12,423 : [3/3] EVALUATION : Execution of _predict took at 5.127 seconds.
2023-05-08 00:01:13,534 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-08 00:01:13,636 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:01:17,376 : [3/3] EVALUATION : Execution of _matmat took at 3.740 seconds.
2023-05-08 00:01:18,771 : [3/3] EVALUATION : Execution of _predict took at 5.182 seconds.
2023-05-08 00:01:19,896 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-08 00:01:19,997 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:01:23,706 : [3/3] EVALUATION : Execution of _matmat took at 3.709 seconds.
2023-05-08 00:01:25,083 : [3/3] EVALUATION : Execution of _predict took at 5.132 seconds.
2023-05-08 00:01:26,188 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-08 00:01:26,292 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-08 00:01:30,021 : [3/3] EVALUATION : Execution of _matmat took at 3.729 seconds.
2023-05-08 00:01:31,373 : [3/3] EVALUATION : Execution of _predict took at 5.131 seconds.
2023-05-08 00:01:32,480 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-08 00:01:32,580 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:01:36,433 : [3/3] EVALUATION : Execution of _matmat took at 3.853 seconds.
2023-05-08 00:01:37,757 : [3/3] EVALUATION : Execution of _predict took at 5.224 seconds.
2023-05-08 00:01:38,851 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-08 00:01:38,955 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:01:42,887 : [3/3] EVALUATION : Execution of _matmat took at 3.933 seconds.
2023-05-08 00:01:44,267 : [3/3] EVALUATION : Execution of _predict took at 5.361 seconds.
2023-05-08 00:01:45,385 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-08 00:01:45,485 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:01:49,239 : [3/3] EVALUATION : Execution of _matmat took at 3.754 seconds.
2023-05-08 00:01:50,589 : [3/3] EVALUATION : Execution of _predict took at 5.150 seconds.
2023-05-08 00:01:51,699 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-08 00:01:51,801 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:01:55,529 : [3/3] EVALUATION : Execution of _matmat took at 3.728 seconds.
2023-05-08 00:01:56,868 : [3/3] EVALUATION : Execution of _predict took at 5.114 seconds.
2023-05-08 00:01:57,974 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-08 00:01:58,073 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-08 00:02:01,804 : [3/3] EVALUATION : Execution of _matmat took at 3.731 seconds.
2023-05-08 00:02:03,139 : [3/3] EVALUATION : Execution of _predict took at 5.112 seconds.
2023-05-08 00:02:04,237 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-08 00:02:04,338 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:02:08,121 : [3/3] EVALUATION : Execution of _matmat took at 3.783 seconds.
2023-05-08 00:02:09,517 : [3/3] EVALUATION : Execution of _predict took at 5.227 seconds.
2023-05-08 00:02:10,849 : [3/3] EVALUATION : Execution of _evaluate_model took at 158.784 seconds.
2023-05-08 00:02:10,850 : PIPELINE END : Execution of run took at 563.633 seconds.
d=0.01, ns=4, nf=20


2023-05-08 00:02:10,885 : PIPELINE START : Starting evaluation pipeline.
2023-05-08 00:02:10,885 : [1/3] DATASET : Loading processed dataset datasets/data/msd/dataset.parquet.
2023-05-08 00:02:12,058 : [1/3] DATASET : Execution of _load_dataset_from_config took at 1.173 seconds.
2023-05-08 00:02:12,380 : [1/3] DATASET : Dataset info | Dataset name: msd, Number of users: 571355, Number of items: 41140, Number of interactions: 33633450, Interaction density: 0.1431%
2023-05-08 00:02:12,832 : [1/3] DATASET : Loaded dataset splits from datasets/data/msd/n_val_users=50000_n_test_users=50000_seed=42_target_proportion=0.2_targets_newest=False.
2023-05-08 00:02:12,845 : [1/3] DATASET : Execution of _create_dataset_splits took at 1.960 seconds.
2023-05-08 00:02:12,845 : [2/3] TRAINING : Train user-item matrix info | n_users = 471355, n_items = 41140, n_ratings = 27765348, sparsity = 99.86%
2023-05-08 00:02:12,845 : [2/3] TRAINING : Item-item matrix info | shape = (41140,41140)
2023-05-08 00:02:12,845 : [2/3] TRAINING : Training SANSA with L2=200, target density=1.000000%, LDL^T method=cholmod, approx. inverse method=umr...
2023-05-08 00:02:12,845 : [2/3] TRAINING : Loading item-user matrix...
2023-05-08 00:02:14,958 : [2/3] TRAINING : Constructing weights:
2023-05-08 00:02:14,959 : [2/3] TRAINING : Computing LDL^T decomposition...
2023-05-08 00:04:01,482 : [2/3] TRAINING : L info | nnz: 846147565, size: 10153.935 MB, density: 49.993960%
2023-05-08 00:04:01,482 : [2/3] TRAINING : Dropping small values from L...
2023-05-08 00:04:10,475 : [2/3] TRAINING : sparsified L info | nnz: 16924996, size: 203.265 MB, density: 1.000000%
2023-05-08 00:04:10,476 : [2/3] TRAINING : Execution of ldlt took at 115.517 seconds.
2023-05-08 00:04:10,476 : [2/3] TRAINING : nnz of L: 16924996, size: 203.265 MB
2023-05-08 00:04:10,476 : [2/3] TRAINING : Computing approximate inverse of L:
2023-05-08 00:04:10,476 : [2/3] TRAINING : Calculating initial guess using 1 step of Schultz method...
2023-05-08 00:04:10,617 : [2/3] TRAINING : Calculating approximate inverse using Uniform Minimal Residual algorithm...
2023-05-08 00:04:14,587 : [2/3] TRAINING : Current maximum residual: 8.80231045, relative Frobenius norm squared: 0.16358312
2023-05-08 00:04:14,588 : [2/3] TRAINING : Performing UMR scan 1...
2023-05-08 00:04:20,360 : [2/3] TRAINING : Execution of _umr_scan took at 5.773 seconds.
2023-05-08 00:04:24,398 : [2/3] TRAINING : Current maximum residual: 2.02686268, relative Frobenius norm squared: 0.09649243
2023-05-08 00:04:24,398 : [2/3] TRAINING : Performing UMR scan 2...
2023-05-08 00:05:11,524 : [2/3] TRAINING : Execution of _umr_scan took at 47.126 seconds.
2023-05-08 00:05:15,625 : [2/3] TRAINING : Current maximum residual: 0.92397095, relative Frobenius norm squared: 0.00823936
2023-05-08 00:05:15,626 : [2/3] TRAINING : Performing UMR scan 3...
2023-05-08 00:06:25,613 : [2/3] TRAINING : Execution of _umr_scan took at 69.987 seconds.
2023-05-08 00:06:29,697 : [2/3] TRAINING : Current maximum residual: 0.87400602, relative Frobenius norm squared: 0.00295406
2023-05-08 00:06:29,697 : [2/3] TRAINING : Performing UMR scan 4...
2023-05-08 00:07:47,515 : [2/3] TRAINING : Execution of _umr_scan took at 77.817 seconds.
2023-05-08 00:07:51,575 : [2/3] TRAINING : Current maximum residual: 0.80665452, relative Frobenius norm squared: 0.00220102
2023-05-08 00:07:51,575 : [2/3] TRAINING : Performing UMR finetune step 1...
2023-05-08 00:07:54,261 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.686 seconds.
2023-05-08 00:07:58,302 : [2/3] TRAINING : Current maximum residual: 0.49260438, relative Frobenius norm squared: 0.00201571
2023-05-08 00:07:58,302 : [2/3] TRAINING : Performing UMR finetune step 2...
2023-05-08 00:08:00,827 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.524 seconds.
2023-05-08 00:08:04,939 : [2/3] TRAINING : Current maximum residual: 0.23168503, relative Frobenius norm squared: 0.00196345
2023-05-08 00:08:04,939 : [2/3] TRAINING : Performing UMR finetune step 3...
2023-05-08 00:08:07,550 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.611 seconds.
2023-05-08 00:08:11,691 : [2/3] TRAINING : Current maximum residual: 0.22421199, relative Frobenius norm squared: 0.00194274
2023-05-08 00:08:11,691 : [2/3] TRAINING : Performing UMR finetune step 4...
2023-05-08 00:08:14,317 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.626 seconds.
2023-05-08 00:08:18,380 : [2/3] TRAINING : Current maximum residual: 0.22063923, relative Frobenius norm squared: 0.00193020
2023-05-08 00:08:18,381 : [2/3] TRAINING : Performing UMR finetune step 5...
2023-05-08 00:08:21,103 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.723 seconds.
2023-05-08 00:08:25,152 : [2/3] TRAINING : Current maximum residual: 0.21868928, relative Frobenius norm squared: 0.00192349
2023-05-08 00:08:25,152 : [2/3] TRAINING : Performing UMR finetune step 6...
2023-05-08 00:08:27,809 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.657 seconds.
2023-05-08 00:08:31,843 : [2/3] TRAINING : Current maximum residual: 0.21775071, relative Frobenius norm squared: 0.00191898
2023-05-08 00:08:31,843 : [2/3] TRAINING : Performing UMR finetune step 7...
2023-05-08 00:08:34,412 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.569 seconds.
2023-05-08 00:08:38,479 : [2/3] TRAINING : Current maximum residual: 0.21715000, relative Frobenius norm squared: 0.00191602
2023-05-08 00:08:38,479 : [2/3] TRAINING : Performing UMR finetune step 8...
2023-05-08 00:08:41,052 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.572 seconds.
2023-05-08 00:08:45,125 : [2/3] TRAINING : Current maximum residual: 0.21684158, relative Frobenius norm squared: 0.00191386
2023-05-08 00:08:45,125 : [2/3] TRAINING : Performing UMR finetune step 9...
2023-05-08 00:08:47,718 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.593 seconds.
2023-05-08 00:08:51,787 : [2/3] TRAINING : Current maximum residual: 0.21665836, relative Frobenius norm squared: 0.00191226
2023-05-08 00:08:51,787 : [2/3] TRAINING : Performing UMR finetune step 10...
2023-05-08 00:08:54,397 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.610 seconds.
2023-05-08 00:08:58,427 : [2/3] TRAINING : Current maximum residual: 0.21656038, relative Frobenius norm squared: 0.00191126
2023-05-08 00:08:58,427 : [2/3] TRAINING : Performing UMR finetune step 11...
2023-05-08 00:09:01,108 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.681 seconds.
2023-05-08 00:09:05,175 : [2/3] TRAINING : Current maximum residual: 0.21650499, relative Frobenius norm squared: 0.00191038
2023-05-08 00:09:05,175 : [2/3] TRAINING : Performing UMR finetune step 12...
2023-05-08 00:09:07,740 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.565 seconds.
2023-05-08 00:09:11,814 : [2/3] TRAINING : Current maximum residual: 0.21648245, relative Frobenius norm squared: 0.00190989
2023-05-08 00:09:11,814 : [2/3] TRAINING : Performing UMR finetune step 13...
2023-05-08 00:09:14,464 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.650 seconds.
2023-05-08 00:09:18,555 : [2/3] TRAINING : Current maximum residual: 0.21646695, relative Frobenius norm squared: 0.00190935
2023-05-08 00:09:18,555 : [2/3] TRAINING : Performing UMR finetune step 14...
2023-05-08 00:09:21,154 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.599 seconds.
2023-05-08 00:09:25,191 : [2/3] TRAINING : Current maximum residual: 0.21645118, relative Frobenius norm squared: 0.00190872
2023-05-08 00:09:25,191 : [2/3] TRAINING : Performing UMR finetune step 15...
2023-05-08 00:09:27,702 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.512 seconds.
2023-05-08 00:09:31,775 : [2/3] TRAINING : Current maximum residual: 0.21644661, relative Frobenius norm squared: 0.00190834
2023-05-08 00:09:31,775 : [2/3] TRAINING : Performing UMR finetune step 16...
2023-05-08 00:09:34,309 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.534 seconds.
2023-05-08 00:09:38,401 : [2/3] TRAINING : Current maximum residual: 0.21644741, relative Frobenius norm squared: 0.00190788
2023-05-08 00:09:38,401 : [2/3] TRAINING : Performing UMR finetune step 17...
2023-05-08 00:09:40,991 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.590 seconds.
2023-05-08 00:09:45,050 : [2/3] TRAINING : Current maximum residual: 0.21645155, relative Frobenius norm squared: 0.00190737
2023-05-08 00:09:45,050 : [2/3] TRAINING : Performing UMR finetune step 18...
2023-05-08 00:09:47,681 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.631 seconds.
2023-05-08 00:09:51,759 : [2/3] TRAINING : Current maximum residual: 0.21644992, relative Frobenius norm squared: 0.00190728
2023-05-08 00:09:51,759 : [2/3] TRAINING : Performing UMR finetune step 19...
2023-05-08 00:09:54,420 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.662 seconds.
2023-05-08 00:09:58,511 : [2/3] TRAINING : Current maximum residual: 0.21644917, relative Frobenius norm squared: 0.00190709
2023-05-08 00:09:58,511 : [2/3] TRAINING : Performing UMR finetune step 20...
2023-05-08 00:10:01,051 : [2/3] TRAINING : Execution of _umr_finetune_step took at 2.540 seconds.
2023-05-08 00:10:05,160 : [2/3] TRAINING : Current maximum residual: 0.21644889, relative Frobenius norm squared: 0.00190691
2023-05-08 00:10:05,501 : [2/3] TRAINING : Execution of ainv_L took at 355.025 seconds.
2023-05-08 00:10:05,501 : [2/3] TRAINING : nnz of L_inv: 16924996, size: 203.265 MB
2023-05-08 00:10:05,502 : [2/3] TRAINING : Constructing W = L_inv @ P...
2023-05-08 00:10:05,704 : [2/3] TRAINING : Extracting diagonal of W.T @ D_inv @ W...
2023-05-08 00:10:05,854 : [2/3] TRAINING : Dividing columns of W by diagonal entries...
2023-05-08 00:10:06,728 : [2/3] TRAINING : Execution of _construct_weights took at 471.769 seconds.
2023-05-08 00:10:06,729 : [2/3] TRAINING : Model: SANSA, number of weights: 33849992, weights size: 387.696 MB
2023-05-08 00:10:06,729 : [2/3] TRAINING : Execution of _get_model took at 473.884 seconds.
2023-05-08 00:10:06,729 : [3/3] EVALUATION : Evaluating model at batch 0:2000
2023-05-08 00:10:06,834 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:10:10,713 : [3/3] EVALUATION : Execution of _matmat took at 3.878 seconds.
2023-05-08 00:10:12,061 : [3/3] EVALUATION : Execution of _predict took at 5.276 seconds.
2023-05-08 00:10:13,178 : [3/3] EVALUATION : Evaluating model at batch 2000:4000
2023-05-08 00:10:13,280 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:10:17,029 : [3/3] EVALUATION : Execution of _matmat took at 3.749 seconds.
2023-05-08 00:10:18,347 : [3/3] EVALUATION : Execution of _predict took at 5.115 seconds.
2023-05-08 00:10:19,451 : [3/3] EVALUATION : Evaluating model at batch 4000:6000
2023-05-08 00:10:19,557 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-08 00:10:23,318 : [3/3] EVALUATION : Execution of _matmat took at 3.761 seconds.
2023-05-08 00:10:24,716 : [3/3] EVALUATION : Execution of _predict took at 5.209 seconds.
2023-05-08 00:10:25,829 : [3/3] EVALUATION : Evaluating model at batch 6000:8000
2023-05-08 00:10:25,933 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:10:29,724 : [3/3] EVALUATION : Execution of _matmat took at 3.791 seconds.
2023-05-08 00:10:31,102 : [3/3] EVALUATION : Execution of _predict took at 5.218 seconds.
2023-05-08 00:10:32,208 : [3/3] EVALUATION : Evaluating model at batch 8000:10000
2023-05-08 00:10:32,312 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:10:36,157 : [3/3] EVALUATION : Execution of _matmat took at 3.844 seconds.
2023-05-08 00:10:37,530 : [3/3] EVALUATION : Execution of _predict took at 5.266 seconds.
2023-05-08 00:10:38,640 : [3/3] EVALUATION : Evaluating model at batch 10000:12000
2023-05-08 00:10:38,745 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:10:42,523 : [3/3] EVALUATION : Execution of _matmat took at 3.778 seconds.
2023-05-08 00:10:43,889 : [3/3] EVALUATION : Execution of _predict took at 5.194 seconds.
2023-05-08 00:10:45,000 : [3/3] EVALUATION : Evaluating model at batch 12000:14000
2023-05-08 00:10:45,103 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:10:48,934 : [3/3] EVALUATION : Execution of _matmat took at 3.831 seconds.
2023-05-08 00:10:50,289 : [3/3] EVALUATION : Execution of _predict took at 5.235 seconds.
2023-05-08 00:10:51,392 : [3/3] EVALUATION : Evaluating model at batch 14000:16000
2023-05-08 00:10:51,494 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:10:55,259 : [3/3] EVALUATION : Execution of _matmat took at 3.766 seconds.
2023-05-08 00:10:56,597 : [3/3] EVALUATION : Execution of _predict took at 5.151 seconds.
2023-05-08 00:10:57,711 : [3/3] EVALUATION : Evaluating model at batch 16000:18000
2023-05-08 00:10:57,815 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:11:01,589 : [3/3] EVALUATION : Execution of _matmat took at 3.774 seconds.
2023-05-08 00:11:02,955 : [3/3] EVALUATION : Execution of _predict took at 5.189 seconds.
2023-05-08 00:11:04,070 : [3/3] EVALUATION : Evaluating model at batch 18000:20000
2023-05-08 00:11:04,171 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:11:07,950 : [3/3] EVALUATION : Execution of _matmat took at 3.779 seconds.
2023-05-08 00:11:09,273 : [3/3] EVALUATION : Execution of _predict took at 5.150 seconds.
2023-05-08 00:11:10,379 : [3/3] EVALUATION : Evaluating model at batch 20000:22000
2023-05-08 00:11:10,482 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:11:14,353 : [3/3] EVALUATION : Execution of _matmat took at 3.871 seconds.
2023-05-08 00:11:15,678 : [3/3] EVALUATION : Execution of _predict took at 5.244 seconds.
2023-05-08 00:11:16,787 : [3/3] EVALUATION : Evaluating model at batch 22000:24000
2023-05-08 00:11:16,891 : [3/3] EVALUATION : Execution of _matmat took at 0.050 seconds.
2023-05-08 00:11:20,694 : [3/3] EVALUATION : Execution of _matmat took at 3.802 seconds.
2023-05-08 00:11:22,107 : [3/3] EVALUATION : Execution of _predict took at 5.266 seconds.
2023-05-08 00:11:23,215 : [3/3] EVALUATION : Evaluating model at batch 24000:26000
2023-05-08 00:11:23,319 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:11:27,164 : [3/3] EVALUATION : Execution of _matmat took at 3.845 seconds.
2023-05-08 00:11:28,544 : [3/3] EVALUATION : Execution of _predict took at 5.274 seconds.
2023-05-08 00:11:29,662 : [3/3] EVALUATION : Evaluating model at batch 26000:28000
2023-05-08 00:11:29,765 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:11:33,575 : [3/3] EVALUATION : Execution of _matmat took at 3.810 seconds.
2023-05-08 00:11:34,918 : [3/3] EVALUATION : Execution of _predict took at 5.202 seconds.
2023-05-08 00:11:36,026 : [3/3] EVALUATION : Evaluating model at batch 28000:30000
2023-05-08 00:11:36,130 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:11:39,876 : [3/3] EVALUATION : Execution of _matmat took at 3.746 seconds.
2023-05-08 00:11:41,203 : [3/3] EVALUATION : Execution of _predict took at 5.122 seconds.
2023-05-08 00:11:42,310 : [3/3] EVALUATION : Evaluating model at batch 30000:32000
2023-05-08 00:11:42,412 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:11:46,157 : [3/3] EVALUATION : Execution of _matmat took at 3.745 seconds.
2023-05-08 00:11:47,522 : [3/3] EVALUATION : Execution of _predict took at 5.159 seconds.
2023-05-08 00:11:48,636 : [3/3] EVALUATION : Evaluating model at batch 32000:34000
2023-05-08 00:11:48,741 : [3/3] EVALUATION : Execution of _matmat took at 0.049 seconds.
2023-05-08 00:11:52,503 : [3/3] EVALUATION : Execution of _matmat took at 3.762 seconds.
2023-05-08 00:11:53,901 : [3/3] EVALUATION : Execution of _predict took at 5.209 seconds.
2023-05-08 00:11:55,025 : [3/3] EVALUATION : Evaluating model at batch 34000:36000
2023-05-08 00:11:55,128 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:11:58,860 : [3/3] EVALUATION : Execution of _matmat took at 3.732 seconds.
2023-05-08 00:12:00,236 : [3/3] EVALUATION : Execution of _predict took at 5.157 seconds.
2023-05-08 00:12:01,340 : [3/3] EVALUATION : Evaluating model at batch 36000:38000
2023-05-08 00:12:01,442 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:12:05,204 : [3/3] EVALUATION : Execution of _matmat took at 3.761 seconds.
2023-05-08 00:12:06,558 : [3/3] EVALUATION : Execution of _predict took at 5.163 seconds.
2023-05-08 00:12:07,667 : [3/3] EVALUATION : Evaluating model at batch 38000:40000
2023-05-08 00:12:07,769 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:12:11,635 : [3/3] EVALUATION : Execution of _matmat took at 3.866 seconds.
2023-05-08 00:12:12,960 : [3/3] EVALUATION : Execution of _predict took at 5.238 seconds.
2023-05-08 00:12:14,056 : [3/3] EVALUATION : Evaluating model at batch 40000:42000
2023-05-08 00:12:14,159 : [3/3] EVALUATION : Execution of _matmat took at 0.048 seconds.
2023-05-08 00:12:18,072 : [3/3] EVALUATION : Execution of _matmat took at 3.913 seconds.
2023-05-08 00:12:19,454 : [3/3] EVALUATION : Execution of _predict took at 5.343 seconds.
2023-05-08 00:12:20,567 : [3/3] EVALUATION : Evaluating model at batch 42000:44000
2023-05-08 00:12:20,666 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-08 00:12:24,436 : [3/3] EVALUATION : Execution of _matmat took at 3.770 seconds.
2023-05-08 00:12:25,788 : [3/3] EVALUATION : Execution of _predict took at 5.168 seconds.
2023-05-08 00:12:26,898 : [3/3] EVALUATION : Evaluating model at batch 44000:46000
2023-05-08 00:12:26,999 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:12:30,731 : [3/3] EVALUATION : Execution of _matmat took at 3.732 seconds.
2023-05-08 00:12:32,071 : [3/3] EVALUATION : Execution of _predict took at 5.119 seconds.
2023-05-08 00:12:33,177 : [3/3] EVALUATION : Evaluating model at batch 46000:48000
2023-05-08 00:12:33,276 : [3/3] EVALUATION : Execution of _matmat took at 0.046 seconds.
2023-05-08 00:12:37,017 : [3/3] EVALUATION : Execution of _matmat took at 3.740 seconds.
2023-05-08 00:12:38,352 : [3/3] EVALUATION : Execution of _predict took at 5.122 seconds.
2023-05-08 00:12:39,453 : [3/3] EVALUATION : Evaluating model at batch 48000:50000
2023-05-08 00:12:39,554 : [3/3] EVALUATION : Execution of _matmat took at 0.047 seconds.
2023-05-08 00:12:43,347 : [3/3] EVALUATION : Execution of _matmat took at 3.792 seconds.
2023-05-08 00:12:44,743 : [3/3] EVALUATION : Execution of _predict took at 5.236 seconds.
2023-05-08 00:12:46,076 : [3/3] EVALUATION : Execution of _evaluate_model took at 159.347 seconds.
2023-05-08 00:12:46,077 : PIPELINE END : Execution of run took at 635.192 seconds.


Recall @ 50:
density: 0.05%
SANSA
sc=0, ft=0: 0.354
sc=1, ft=5: 0.368
sc=2, ft=10: 0.417
sc=3, ft=20: 0.422



density: 0.25%
SANSA
sc=0, ft=0: 0.344
sc=1, ft=5: 0.374
sc=2, ft=10: 0.421
sc=3, ft=20: 0.426



density: 1.00%
SANSA
sc=0, ft=0: 0.339
sc=1, ft=5: 0.398
sc=2, ft=10: 0.424
sc=3, ft=20: 0.427




